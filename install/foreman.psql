--
-- PostgreSQL database dump
--

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;

--
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


SET search_path = public, pg_catalog;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- Name: architectures; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE architectures (
    id integer NOT NULL,
    name character varying(255) DEFAULT NULL::character varying NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0
);


ALTER TABLE architectures OWNER TO foreman;

--
-- Name: architectures_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE architectures_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE architectures_id_seq OWNER TO foreman;

--
-- Name: architectures_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE architectures_id_seq OWNED BY architectures.id;


--
-- Name: architectures_operatingsystems; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE architectures_operatingsystems (
    architecture_id integer NOT NULL,
    operatingsystem_id integer NOT NULL
);


ALTER TABLE architectures_operatingsystems OWNER TO foreman;

--
-- Name: audits; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE audits (
    id integer NOT NULL,
    auditable_id integer,
    auditable_type character varying(255),
    user_id integer,
    user_type character varying(255),
    username character varying(255),
    action character varying(255),
    audited_changes text,
    version integer DEFAULT 0,
    comment character varying(255),
    associated_id integer,
    associated_type character varying(255),
    created_at timestamp without time zone,
    remote_address character varying(255),
    auditable_name text,
    associated_name character varying(255)
);


ALTER TABLE audits OWNER TO foreman;

--
-- Name: audits_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE audits_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE audits_id_seq OWNER TO foreman;

--
-- Name: audits_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE audits_id_seq OWNED BY audits.id;


--
-- Name: auth_sources; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE auth_sources (
    id integer NOT NULL,
    type character varying(255) DEFAULT ''::character varying NOT NULL,
    name character varying(255) DEFAULT ''::character varying NOT NULL,
    host character varying(255),
    port integer,
    account character varying(255),
    account_password character varying(255),
    base_dn character varying(255),
    attr_login character varying(255),
    attr_firstname character varying(255),
    attr_lastname character varying(255),
    attr_mail character varying(255),
    onthefly_register boolean DEFAULT false NOT NULL,
    tls boolean DEFAULT false NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    ldap_filter character varying(255),
    attr_photo character varying(255),
    server_type character varying(255) DEFAULT 'posix'::character varying,
    groups_base character varying(255),
    usergroup_sync boolean DEFAULT true NOT NULL
);


ALTER TABLE auth_sources OWNER TO foreman;

--
-- Name: auth_sources_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE auth_sources_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE auth_sources_id_seq OWNER TO foreman;

--
-- Name: auth_sources_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE auth_sources_id_seq OWNED BY auth_sources.id;


--
-- Name: bookmarks; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE bookmarks (
    id integer NOT NULL,
    name character varying(255),
    query text,
    controller character varying(255),
    public boolean,
    owner_id integer,
    owner_type character varying(255)
);


ALTER TABLE bookmarks OWNER TO foreman;

--
-- Name: bookmarks_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE bookmarks_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE bookmarks_id_seq OWNER TO foreman;

--
-- Name: bookmarks_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE bookmarks_id_seq OWNED BY bookmarks.id;


--
-- Name: cached_user_roles; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE cached_user_roles (
    id integer NOT NULL,
    user_id integer NOT NULL,
    role_id integer NOT NULL,
    user_role_id integer NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE cached_user_roles OWNER TO foreman;

--
-- Name: cached_user_roles_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE cached_user_roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE cached_user_roles_id_seq OWNER TO foreman;

--
-- Name: cached_user_roles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE cached_user_roles_id_seq OWNED BY cached_user_roles.id;


--
-- Name: cached_usergroup_members; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE cached_usergroup_members (
    id integer NOT NULL,
    user_id integer,
    usergroup_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE cached_usergroup_members OWNER TO foreman;

--
-- Name: cached_usergroup_members_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE cached_usergroup_members_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE cached_usergroup_members_id_seq OWNER TO foreman;

--
-- Name: cached_usergroup_members_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE cached_usergroup_members_id_seq OWNED BY cached_usergroup_members.id;


--
-- Name: compute_attributes; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE compute_attributes (
    id integer NOT NULL,
    compute_profile_id integer,
    compute_resource_id integer,
    name character varying(255),
    vm_attrs text,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE compute_attributes OWNER TO foreman;

--
-- Name: compute_attributes_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE compute_attributes_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE compute_attributes_id_seq OWNER TO foreman;

--
-- Name: compute_attributes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE compute_attributes_id_seq OWNED BY compute_attributes.id;


--
-- Name: compute_profiles; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE compute_profiles (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE compute_profiles OWNER TO foreman;

--
-- Name: compute_profiles_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE compute_profiles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE compute_profiles_id_seq OWNER TO foreman;

--
-- Name: compute_profiles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE compute_profiles_id_seq OWNED BY compute_profiles.id;


--
-- Name: compute_resources; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE compute_resources (
    id integer NOT NULL,
    name character varying(255),
    description text,
    url character varying(255),
    "user" character varying(255),
    password text,
    uuid character varying(255),
    type character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    attrs text
);


ALTER TABLE compute_resources OWNER TO foreman;

--
-- Name: compute_resources_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE compute_resources_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE compute_resources_id_seq OWNER TO foreman;

--
-- Name: compute_resources_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE compute_resources_id_seq OWNED BY compute_resources.id;


--
-- Name: config_group_classes; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE config_group_classes (
    id integer NOT NULL,
    puppetclass_id integer,
    config_group_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE config_group_classes OWNER TO foreman;

--
-- Name: config_group_classes_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE config_group_classes_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE config_group_classes_id_seq OWNER TO foreman;

--
-- Name: config_group_classes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE config_group_classes_id_seq OWNED BY config_group_classes.id;


--
-- Name: config_groups; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE config_groups (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0,
    config_group_classes_count integer DEFAULT 0
);


ALTER TABLE config_groups OWNER TO foreman;

--
-- Name: config_groups_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE config_groups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE config_groups_id_seq OWNER TO foreman;

--
-- Name: config_groups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE config_groups_id_seq OWNED BY config_groups.id;


--
-- Name: config_templates; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE config_templates (
    id integer NOT NULL,
    name character varying(255),
    template text,
    snippet boolean,
    template_kind_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    locked boolean DEFAULT false,
    "default" boolean DEFAULT false,
    vendor character varying(255)
);


ALTER TABLE config_templates OWNER TO foreman;

--
-- Name: config_templates_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE config_templates_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE config_templates_id_seq OWNER TO foreman;

--
-- Name: config_templates_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE config_templates_id_seq OWNED BY config_templates.id;


--
-- Name: config_templates_operatingsystems; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE config_templates_operatingsystems (
    config_template_id integer NOT NULL,
    operatingsystem_id integer NOT NULL
);


ALTER TABLE config_templates_operatingsystems OWNER TO foreman;

--
-- Name: domains; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE domains (
    id integer NOT NULL,
    name character varying(255) DEFAULT ''::character varying NOT NULL,
    fullname character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    dns_id integer,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0
);


ALTER TABLE domains OWNER TO foreman;

--
-- Name: domains_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE domains_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE domains_id_seq OWNER TO foreman;

--
-- Name: domains_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE domains_id_seq OWNED BY domains.id;


--
-- Name: environment_classes; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE environment_classes (
    puppetclass_id integer NOT NULL,
    environment_id integer NOT NULL,
    id integer NOT NULL,
    lookup_key_id integer
);


ALTER TABLE environment_classes OWNER TO foreman;

--
-- Name: environment_classes_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE environment_classes_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE environment_classes_id_seq OWNER TO foreman;

--
-- Name: environment_classes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE environment_classes_id_seq OWNED BY environment_classes.id;


--
-- Name: environments; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE environments (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0
);


ALTER TABLE environments OWNER TO foreman;

--
-- Name: environments_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE environments_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE environments_id_seq OWNER TO foreman;

--
-- Name: environments_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE environments_id_seq OWNED BY environments.id;


--
-- Name: external_usergroups; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE external_usergroups (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    auth_source_id integer NOT NULL,
    usergroup_id integer NOT NULL
);


ALTER TABLE external_usergroups OWNER TO foreman;

--
-- Name: external_usergroups_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE external_usergroups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE external_usergroups_id_seq OWNER TO foreman;

--
-- Name: external_usergroups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE external_usergroups_id_seq OWNED BY external_usergroups.id;


--
-- Name: fact_names; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE fact_names (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    updated_at timestamp without time zone,
    created_at timestamp without time zone,
    compose boolean DEFAULT false NOT NULL,
    short_name character varying(255),
    type character varying(255) DEFAULT 'FactName'::character varying,
    ancestry character varying(255)
);


ALTER TABLE fact_names OWNER TO foreman;

--
-- Name: fact_names_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE fact_names_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE fact_names_id_seq OWNER TO foreman;

--
-- Name: fact_names_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE fact_names_id_seq OWNED BY fact_names.id;


--
-- Name: fact_values; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE fact_values (
    id integer NOT NULL,
    value text,
    fact_name_id integer NOT NULL,
    host_id integer NOT NULL,
    updated_at timestamp without time zone,
    created_at timestamp without time zone
);


ALTER TABLE fact_values OWNER TO foreman;

--
-- Name: fact_values_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE fact_values_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE fact_values_id_seq OWNER TO foreman;

--
-- Name: fact_values_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE fact_values_id_seq OWNED BY fact_values.id;


--
-- Name: features; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE features (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE features OWNER TO foreman;

--
-- Name: features_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE features_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE features_id_seq OWNER TO foreman;

--
-- Name: features_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE features_id_seq OWNED BY features.id;


--
-- Name: features_smart_proxies; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE features_smart_proxies (
    smart_proxy_id integer,
    feature_id integer
);


ALTER TABLE features_smart_proxies OWNER TO foreman;

--
-- Name: filterings; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE filterings (
    id integer NOT NULL,
    filter_id integer,
    permission_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE filterings OWNER TO foreman;

--
-- Name: filterings_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE filterings_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE filterings_id_seq OWNER TO foreman;

--
-- Name: filterings_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE filterings_id_seq OWNED BY filterings.id;


--
-- Name: filters; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE filters (
    id integer NOT NULL,
    search text,
    role_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    taxonomy_search text
);


ALTER TABLE filters OWNER TO foreman;

--
-- Name: filters_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE filters_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE filters_id_seq OWNER TO foreman;

--
-- Name: filters_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE filters_id_seq OWNED BY filters.id;


--
-- Name: host_classes; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE host_classes (
    puppetclass_id integer NOT NULL,
    host_id integer NOT NULL,
    id integer NOT NULL
);


ALTER TABLE host_classes OWNER TO foreman;

--
-- Name: host_classes_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE host_classes_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE host_classes_id_seq OWNER TO foreman;

--
-- Name: host_classes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE host_classes_id_seq OWNED BY host_classes.id;


--
-- Name: host_config_groups; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE host_config_groups (
    id integer NOT NULL,
    config_group_id integer,
    host_id integer,
    host_type character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE host_config_groups OWNER TO foreman;

--
-- Name: host_config_groups_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE host_config_groups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE host_config_groups_id_seq OWNER TO foreman;

--
-- Name: host_config_groups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE host_config_groups_id_seq OWNED BY host_config_groups.id;


--
-- Name: hostgroup_classes; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE hostgroup_classes (
    hostgroup_id integer NOT NULL,
    puppetclass_id integer NOT NULL,
    id integer NOT NULL
);


ALTER TABLE hostgroup_classes OWNER TO foreman;

--
-- Name: hostgroup_classes_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE hostgroup_classes_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE hostgroup_classes_id_seq OWNER TO foreman;

--
-- Name: hostgroup_classes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE hostgroup_classes_id_seq OWNED BY hostgroup_classes.id;


--
-- Name: hostgroups; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE hostgroups (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    environment_id integer,
    operatingsystem_id integer,
    architecture_id integer,
    medium_id integer,
    ptable_id integer,
    root_pass character varying(255),
    puppet_ca_proxy_id integer,
    use_image boolean,
    image_file character varying(128),
    ancestry character varying(255),
    vm_defaults text,
    subnet_id integer,
    domain_id integer,
    puppet_proxy_id integer,
    title character varying(255),
    realm_id integer,
    compute_profile_id integer,
    grub_pass character varying(255) DEFAULT ''::character varying
);


ALTER TABLE hostgroups OWNER TO foreman;

--
-- Name: hostgroups_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE hostgroups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE hostgroups_id_seq OWNER TO foreman;

--
-- Name: hostgroups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE hostgroups_id_seq OWNED BY hostgroups.id;


--
-- Name: hosts; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE hosts (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    last_compile timestamp without time zone,
    last_freshcheck timestamp without time zone,
    last_report timestamp without time zone,
    updated_at timestamp without time zone,
    source_file_id integer,
    created_at timestamp without time zone,
    root_pass character varying(255),
    serial character varying(255),
    puppet_status bigint DEFAULT 0 NOT NULL,
    architecture_id integer,
    operatingsystem_id integer,
    environment_id integer,
    ptable_id integer,
    medium_id integer,
    build boolean DEFAULT false,
    comment text,
    disk text,
    installed_at timestamp without time zone,
    model_id integer,
    hostgroup_id integer,
    owner_id integer,
    owner_type character varying(255),
    enabled boolean DEFAULT true,
    puppet_ca_proxy_id integer,
    managed boolean DEFAULT false NOT NULL,
    use_image boolean,
    image_file character varying(128),
    uuid character varying(255),
    compute_resource_id integer,
    puppet_proxy_id integer,
    certname character varying(255),
    image_id integer,
    organization_id integer,
    location_id integer,
    type character varying(255),
    otp character varying(255),
    realm_id integer,
    compute_profile_id integer,
    provision_method character varying(255),
    grub_pass character varying(255) DEFAULT ''::character varying
);


ALTER TABLE hosts OWNER TO foreman;

--
-- Name: hosts_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE hosts_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE hosts_id_seq OWNER TO foreman;

--
-- Name: hosts_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE hosts_id_seq OWNED BY hosts.id;


--
-- Name: images; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE images (
    id integer NOT NULL,
    operatingsystem_id integer,
    compute_resource_id integer,
    architecture_id integer,
    uuid character varying(255),
    username character varying(255),
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    iam_role character varying(255),
    user_data boolean DEFAULT false,
    password character varying(255)
);


ALTER TABLE images OWNER TO foreman;

--
-- Name: images_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE images_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE images_id_seq OWNER TO foreman;

--
-- Name: images_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE images_id_seq OWNED BY images.id;


--
-- Name: key_pairs; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE key_pairs (
    id integer NOT NULL,
    secret text,
    compute_resource_id integer,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    public text
);


ALTER TABLE key_pairs OWNER TO foreman;

--
-- Name: key_pairs_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE key_pairs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE key_pairs_id_seq OWNER TO foreman;

--
-- Name: key_pairs_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE key_pairs_id_seq OWNED BY key_pairs.id;


--
-- Name: locations_organizations; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE locations_organizations (
    location_id integer,
    organization_id integer
);


ALTER TABLE locations_organizations OWNER TO foreman;

--
-- Name: logs; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE logs (
    id integer NOT NULL,
    source_id integer,
    message_id integer,
    report_id integer,
    level_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE logs OWNER TO foreman;

--
-- Name: logs_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE logs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE logs_id_seq OWNER TO foreman;

--
-- Name: logs_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE logs_id_seq OWNED BY logs.id;


--
-- Name: lookup_keys; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE lookup_keys (
    id integer NOT NULL,
    key character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    puppetclass_id integer,
    default_value text,
    path character varying(255),
    description text,
    validator_type character varying(255),
    validator_rule character varying(255),
    is_param boolean DEFAULT false,
    key_type character varying(255) DEFAULT NULL::character varying,
    override boolean DEFAULT false,
    required boolean DEFAULT false,
    lookup_values_count integer DEFAULT 0,
    merge_overrides boolean,
    avoid_duplicates boolean,
    use_puppet_default boolean
);


ALTER TABLE lookup_keys OWNER TO foreman;

--
-- Name: lookup_keys_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE lookup_keys_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE lookup_keys_id_seq OWNER TO foreman;

--
-- Name: lookup_keys_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE lookup_keys_id_seq OWNED BY lookup_keys.id;


--
-- Name: lookup_values; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE lookup_values (
    id integer NOT NULL,
    match character varying(255),
    value text,
    lookup_key_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    use_puppet_default boolean DEFAULT false
);


ALTER TABLE lookup_values OWNER TO foreman;

--
-- Name: lookup_values_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE lookup_values_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE lookup_values_id_seq OWNER TO foreman;

--
-- Name: lookup_values_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE lookup_values_id_seq OWNED BY lookup_values.id;


--
-- Name: mail_notifications; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE mail_notifications (
    id integer NOT NULL,
    name character varying(255),
    description text,
    mailer character varying(255),
    method character varying(255),
    subscriptable boolean DEFAULT true,
    default_interval character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    subscription_type character varying(255)
);


ALTER TABLE mail_notifications OWNER TO foreman;

--
-- Name: mail_notifications_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE mail_notifications_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE mail_notifications_id_seq OWNER TO foreman;

--
-- Name: mail_notifications_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE mail_notifications_id_seq OWNED BY mail_notifications.id;


--
-- Name: media; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE media (
    id integer NOT NULL,
    name character varying(255) DEFAULT ''::character varying NOT NULL,
    path character varying(255) DEFAULT ''::character varying NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    media_path character varying(255),
    config_path character varying(255),
    image_path character varying(255),
    os_family character varying(255)
);


ALTER TABLE media OWNER TO foreman;

--
-- Name: media_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE media_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE media_id_seq OWNER TO foreman;

--
-- Name: media_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE media_id_seq OWNED BY media.id;


--
-- Name: media_operatingsystems; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE media_operatingsystems (
    medium_id integer NOT NULL,
    operatingsystem_id integer NOT NULL
);


ALTER TABLE media_operatingsystems OWNER TO foreman;

--
-- Name: messages; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE messages (
    id integer NOT NULL,
    value text,
    digest character varying(255)
);


ALTER TABLE messages OWNER TO foreman;

--
-- Name: messages_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE messages_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE messages_id_seq OWNER TO foreman;

--
-- Name: messages_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE messages_id_seq OWNED BY messages.id;


--
-- Name: models; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE models (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    info text,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    vendor_class character varying(255),
    hardware_model character varying(255),
    hosts_count integer DEFAULT 0
);


ALTER TABLE models OWNER TO foreman;

--
-- Name: models_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE models_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE models_id_seq OWNER TO foreman;

--
-- Name: models_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE models_id_seq OWNED BY models.id;


--
-- Name: nics; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE nics (
    id integer NOT NULL,
    mac character varying(255),
    ip character varying(255),
    type character varying(255),
    name character varying(255),
    host_id integer,
    subnet_id integer,
    domain_id integer,
    attrs text,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    provider character varying(255),
    username character varying(255),
    password character varying(255),
    virtual boolean DEFAULT false NOT NULL,
    link boolean DEFAULT true NOT NULL,
    identifier character varying(255),
    tag character varying(255) DEFAULT ''::character varying NOT NULL,
    attached_to character varying(255) DEFAULT ''::character varying NOT NULL,
    managed boolean DEFAULT true,
    mode character varying(255) DEFAULT 'balance-rr'::character varying NOT NULL,
    attached_devices character varying(255) DEFAULT ''::character varying NOT NULL,
    bond_options character varying(255) DEFAULT ''::character varying NOT NULL,
    "primary" boolean DEFAULT false,
    provision boolean DEFAULT false,
    compute_attributes text
);


ALTER TABLE nics OWNER TO foreman;

--
-- Name: nics_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE nics_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE nics_id_seq OWNER TO foreman;

--
-- Name: nics_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE nics_id_seq OWNED BY nics.id;


--
-- Name: operatingsystems; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE operatingsystems (
    id integer NOT NULL,
    major character varying(5) DEFAULT ''::character varying NOT NULL,
    name character varying(255),
    minor character varying(16) DEFAULT ''::character varying NOT NULL,
    nameindicator character varying(3),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    release_name character varying(255),
    type character varying(255),
    description text,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0,
    password_hash character varying(255) DEFAULT 'MD5'::character varying,
    title character varying(255)
);


ALTER TABLE operatingsystems OWNER TO foreman;

--
-- Name: operatingsystems_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE operatingsystems_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE operatingsystems_id_seq OWNER TO foreman;

--
-- Name: operatingsystems_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE operatingsystems_id_seq OWNED BY operatingsystems.id;


--
-- Name: operatingsystems_ptables; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE operatingsystems_ptables (
    ptable_id integer NOT NULL,
    operatingsystem_id integer NOT NULL
);


ALTER TABLE operatingsystems_ptables OWNER TO foreman;

--
-- Name: operatingsystems_puppetclasses; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE operatingsystems_puppetclasses (
    puppetclass_id integer NOT NULL,
    operatingsystem_id integer NOT NULL
);


ALTER TABLE operatingsystems_puppetclasses OWNER TO foreman;

--
-- Name: os_default_templates; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE os_default_templates (
    id integer NOT NULL,
    config_template_id integer,
    template_kind_id integer,
    operatingsystem_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE os_default_templates OWNER TO foreman;

--
-- Name: os_default_templates_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE os_default_templates_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE os_default_templates_id_seq OWNER TO foreman;

--
-- Name: os_default_templates_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE os_default_templates_id_seq OWNED BY os_default_templates.id;


--
-- Name: parameters; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE parameters (
    id integer NOT NULL,
    name character varying(255),
    value text,
    reference_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    type character varying(255),
    priority integer,
    hidden_value boolean DEFAULT false
);


ALTER TABLE parameters OWNER TO foreman;

--
-- Name: parameters_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE parameters_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE parameters_id_seq OWNER TO foreman;

--
-- Name: parameters_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE parameters_id_seq OWNED BY parameters.id;


--
-- Name: permissions; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE permissions (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    resource_type character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE permissions OWNER TO foreman;

--
-- Name: permissions_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE permissions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE permissions_id_seq OWNER TO foreman;

--
-- Name: permissions_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE permissions_id_seq OWNED BY permissions.id;


--
-- Name: ptables; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE ptables (
    id integer NOT NULL,
    name character varying(255) NOT NULL,
    layout text NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    os_family character varying(255)
);


ALTER TABLE ptables OWNER TO foreman;

--
-- Name: ptables_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE ptables_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE ptables_id_seq OWNER TO foreman;

--
-- Name: ptables_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE ptables_id_seq OWNED BY ptables.id;


--
-- Name: puppetclasses; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE puppetclasses (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    total_hosts integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0,
    global_class_params_count integer DEFAULT 0,
    lookup_keys_count integer DEFAULT 0
);


ALTER TABLE puppetclasses OWNER TO foreman;

--
-- Name: puppetclasses_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE puppetclasses_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE puppetclasses_id_seq OWNER TO foreman;

--
-- Name: puppetclasses_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE puppetclasses_id_seq OWNED BY puppetclasses.id;


--
-- Name: realms; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE realms (
    id integer NOT NULL,
    name character varying(255) DEFAULT ''::character varying NOT NULL,
    realm_type character varying(255),
    realm_proxy_id integer,
    hosts_count integer DEFAULT 0,
    hostgroups_count integer DEFAULT 0,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE realms OWNER TO foreman;

--
-- Name: realms_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE realms_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE realms_id_seq OWNER TO foreman;

--
-- Name: realms_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE realms_id_seq OWNED BY realms.id;


--
-- Name: reports; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE reports (
    id integer NOT NULL,
    host_id integer NOT NULL,
    reported_at timestamp without time zone,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    status bigint,
    metrics text
);


ALTER TABLE reports OWNER TO foreman;

--
-- Name: reports_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE reports_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE reports_id_seq OWNER TO foreman;

--
-- Name: reports_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE reports_id_seq OWNED BY reports.id;


--
-- Name: roles; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE roles (
    id integer NOT NULL,
    name character varying(255),
    builtin integer,
    permissions text
);


ALTER TABLE roles OWNER TO foreman;

--
-- Name: roles_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE roles_id_seq OWNER TO foreman;

--
-- Name: roles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE roles_id_seq OWNED BY roles.id;


--
-- Name: schema_migrations; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE schema_migrations (
    version character varying(255) NOT NULL
);


ALTER TABLE schema_migrations OWNER TO foreman;

--
-- Name: sessions; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE sessions (
    id integer NOT NULL,
    session_id character varying(255) NOT NULL,
    data text,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE sessions OWNER TO foreman;

--
-- Name: sessions_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE sessions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE sessions_id_seq OWNER TO foreman;

--
-- Name: sessions_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE sessions_id_seq OWNED BY sessions.id;


--
-- Name: settings; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE settings (
    id integer NOT NULL,
    name character varying(255),
    value text,
    description text,
    category character varying(255),
    settings_type character varying(255),
    "default" text NOT NULL,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE settings OWNER TO foreman;

--
-- Name: settings_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE settings_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE settings_id_seq OWNER TO foreman;

--
-- Name: settings_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE settings_id_seq OWNED BY settings.id;


--
-- Name: smart_proxies; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE smart_proxies (
    id integer NOT NULL,
    name character varying(255),
    url character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE smart_proxies OWNER TO foreman;

--
-- Name: smart_proxies_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE smart_proxies_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE smart_proxies_id_seq OWNER TO foreman;

--
-- Name: smart_proxies_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE smart_proxies_id_seq OWNED BY smart_proxies.id;


--
-- Name: sources; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE sources (
    id integer NOT NULL,
    value text,
    digest character varying(255)
);


ALTER TABLE sources OWNER TO foreman;

--
-- Name: sources_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE sources_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE sources_id_seq OWNER TO foreman;

--
-- Name: sources_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE sources_id_seq OWNED BY sources.id;


--
-- Name: subnet_domains; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE subnet_domains (
    id integer NOT NULL,
    domain_id integer,
    subnet_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE subnet_domains OWNER TO foreman;

--
-- Name: subnet_domains_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE subnet_domains_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE subnet_domains_id_seq OWNER TO foreman;

--
-- Name: subnet_domains_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE subnet_domains_id_seq OWNED BY subnet_domains.id;


--
-- Name: subnets; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE subnets (
    id integer NOT NULL,
    network character varying(15),
    mask character varying(15),
    priority integer,
    name text,
    vlanid character varying(10),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    dhcp_id integer,
    tftp_id integer,
    gateway character varying(255),
    dns_primary character varying(255),
    dns_secondary character varying(255),
    "from" character varying(255),
    "to" character varying(255),
    dns_id integer,
    boot_mode character varying(255) DEFAULT 'DHCP'::character varying NOT NULL,
    ipam character varying(255) DEFAULT 'DHCP'::character varying NOT NULL
);


ALTER TABLE subnets OWNER TO foreman;

--
-- Name: subnets_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE subnets_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE subnets_id_seq OWNER TO foreman;

--
-- Name: subnets_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE subnets_id_seq OWNED BY subnets.id;


--
-- Name: taxable_taxonomies; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE taxable_taxonomies (
    id integer NOT NULL,
    taxonomy_id integer,
    taxable_id integer,
    taxable_type character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE taxable_taxonomies OWNER TO foreman;

--
-- Name: taxable_taxonomies_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE taxable_taxonomies_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE taxable_taxonomies_id_seq OWNER TO foreman;

--
-- Name: taxable_taxonomies_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE taxable_taxonomies_id_seq OWNED BY taxable_taxonomies.id;


--
-- Name: taxonomies; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE taxonomies (
    id integer NOT NULL,
    name character varying(255),
    type character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    ignore_types text,
    ancestry character varying(255),
    title character varying(255),
    description text
);


ALTER TABLE taxonomies OWNER TO foreman;

--
-- Name: taxonomies_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE taxonomies_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE taxonomies_id_seq OWNER TO foreman;

--
-- Name: taxonomies_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE taxonomies_id_seq OWNED BY taxonomies.id;


--
-- Name: template_combinations; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE template_combinations (
    id integer NOT NULL,
    config_template_id integer,
    hostgroup_id integer,
    environment_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE template_combinations OWNER TO foreman;

--
-- Name: template_combinations_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE template_combinations_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE template_combinations_id_seq OWNER TO foreman;

--
-- Name: template_combinations_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE template_combinations_id_seq OWNED BY template_combinations.id;


--
-- Name: template_kinds; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE template_kinds (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE template_kinds OWNER TO foreman;

--
-- Name: template_kinds_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE template_kinds_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE template_kinds_id_seq OWNER TO foreman;

--
-- Name: template_kinds_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE template_kinds_id_seq OWNED BY template_kinds.id;


--
-- Name: tokens; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE tokens (
    id integer NOT NULL,
    value character varying(255),
    expires timestamp without time zone,
    host_id integer
);


ALTER TABLE tokens OWNER TO foreman;

--
-- Name: tokens_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE tokens_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE tokens_id_seq OWNER TO foreman;

--
-- Name: tokens_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE tokens_id_seq OWNED BY tokens.id;


--
-- Name: trend_counters; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE trend_counters (
    id integer NOT NULL,
    trend_id integer,
    count integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE trend_counters OWNER TO foreman;

--
-- Name: trend_counters_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE trend_counters_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE trend_counters_id_seq OWNER TO foreman;

--
-- Name: trend_counters_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE trend_counters_id_seq OWNED BY trend_counters.id;


--
-- Name: trends; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE trends (
    id integer NOT NULL,
    trendable_type character varying(255),
    trendable_id integer,
    name character varying(255),
    type character varying(255),
    fact_value character varying(255),
    fact_name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE trends OWNER TO foreman;

--
-- Name: trends_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE trends_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE trends_id_seq OWNER TO foreman;

--
-- Name: trends_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE trends_id_seq OWNED BY trends.id;


--
-- Name: user_mail_notifications; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE user_mail_notifications (
    id integer NOT NULL,
    user_id integer,
    mail_notification_id integer,
    last_sent timestamp without time zone,
    "interval" character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL
);


ALTER TABLE user_mail_notifications OWNER TO foreman;

--
-- Name: user_mail_notifications_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE user_mail_notifications_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE user_mail_notifications_id_seq OWNER TO foreman;

--
-- Name: user_mail_notifications_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE user_mail_notifications_id_seq OWNED BY user_mail_notifications.id;


--
-- Name: user_roles; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE user_roles (
    id integer NOT NULL,
    owner_id integer NOT NULL,
    role_id integer,
    owner_type character varying(255) DEFAULT 'User'::character varying NOT NULL
);


ALTER TABLE user_roles OWNER TO foreman;

--
-- Name: user_roles_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE user_roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE user_roles_id_seq OWNER TO foreman;

--
-- Name: user_roles_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE user_roles_id_seq OWNED BY user_roles.id;


--
-- Name: usergroup_members; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE usergroup_members (
    id integer NOT NULL,
    member_id integer,
    member_type character varying(255),
    usergroup_id integer
);


ALTER TABLE usergroup_members OWNER TO foreman;

--
-- Name: usergroup_members_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE usergroup_members_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE usergroup_members_id_seq OWNER TO foreman;

--
-- Name: usergroup_members_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE usergroup_members_id_seq OWNED BY usergroup_members.id;


--
-- Name: usergroups; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE usergroups (
    id integer NOT NULL,
    name character varying(255),
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    admin boolean DEFAULT false NOT NULL
);


ALTER TABLE usergroups OWNER TO foreman;

--
-- Name: usergroups_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE usergroups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE usergroups_id_seq OWNER TO foreman;

--
-- Name: usergroups_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE usergroups_id_seq OWNED BY usergroups.id;


--
-- Name: users; Type: TABLE; Schema: public; Owner: foreman; Tablespace: 
--

CREATE TABLE users (
    id integer NOT NULL,
    login character varying(255),
    firstname character varying(255),
    lastname character varying(255),
    mail character varying(255),
    admin boolean DEFAULT false NOT NULL,
    last_login_on timestamp without time zone,
    auth_source_id integer,
    created_at timestamp without time zone NOT NULL,
    updated_at timestamp without time zone NOT NULL,
    password_hash character varying(128),
    password_salt character varying(128),
    locale character varying(5),
    avatar_hash character varying(128),
    default_organization_id integer,
    default_location_id integer,
    lower_login character varying(255),
    mail_enabled boolean DEFAULT true,
    timezone character varying(255)
);


ALTER TABLE users OWNER TO foreman;

--
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: foreman
--

CREATE SEQUENCE users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE users_id_seq OWNER TO foreman;

--
-- Name: users_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: foreman
--

ALTER SEQUENCE users_id_seq OWNED BY users.id;


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY architectures ALTER COLUMN id SET DEFAULT nextval('architectures_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY audits ALTER COLUMN id SET DEFAULT nextval('audits_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY auth_sources ALTER COLUMN id SET DEFAULT nextval('auth_sources_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY bookmarks ALTER COLUMN id SET DEFAULT nextval('bookmarks_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY cached_user_roles ALTER COLUMN id SET DEFAULT nextval('cached_user_roles_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY cached_usergroup_members ALTER COLUMN id SET DEFAULT nextval('cached_usergroup_members_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY compute_attributes ALTER COLUMN id SET DEFAULT nextval('compute_attributes_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY compute_profiles ALTER COLUMN id SET DEFAULT nextval('compute_profiles_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY compute_resources ALTER COLUMN id SET DEFAULT nextval('compute_resources_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_group_classes ALTER COLUMN id SET DEFAULT nextval('config_group_classes_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_groups ALTER COLUMN id SET DEFAULT nextval('config_groups_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_templates ALTER COLUMN id SET DEFAULT nextval('config_templates_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY domains ALTER COLUMN id SET DEFAULT nextval('domains_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY environment_classes ALTER COLUMN id SET DEFAULT nextval('environment_classes_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY environments ALTER COLUMN id SET DEFAULT nextval('environments_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY external_usergroups ALTER COLUMN id SET DEFAULT nextval('external_usergroups_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY fact_names ALTER COLUMN id SET DEFAULT nextval('fact_names_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY fact_values ALTER COLUMN id SET DEFAULT nextval('fact_values_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY features ALTER COLUMN id SET DEFAULT nextval('features_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY filterings ALTER COLUMN id SET DEFAULT nextval('filterings_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY filters ALTER COLUMN id SET DEFAULT nextval('filters_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY host_classes ALTER COLUMN id SET DEFAULT nextval('host_classes_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY host_config_groups ALTER COLUMN id SET DEFAULT nextval('host_config_groups_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroup_classes ALTER COLUMN id SET DEFAULT nextval('hostgroup_classes_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups ALTER COLUMN id SET DEFAULT nextval('hostgroups_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts ALTER COLUMN id SET DEFAULT nextval('hosts_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY images ALTER COLUMN id SET DEFAULT nextval('images_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY key_pairs ALTER COLUMN id SET DEFAULT nextval('key_pairs_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY logs ALTER COLUMN id SET DEFAULT nextval('logs_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY lookup_keys ALTER COLUMN id SET DEFAULT nextval('lookup_keys_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY lookup_values ALTER COLUMN id SET DEFAULT nextval('lookup_values_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY mail_notifications ALTER COLUMN id SET DEFAULT nextval('mail_notifications_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY media ALTER COLUMN id SET DEFAULT nextval('media_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY messages ALTER COLUMN id SET DEFAULT nextval('messages_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY models ALTER COLUMN id SET DEFAULT nextval('models_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY nics ALTER COLUMN id SET DEFAULT nextval('nics_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY operatingsystems ALTER COLUMN id SET DEFAULT nextval('operatingsystems_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY os_default_templates ALTER COLUMN id SET DEFAULT nextval('os_default_templates_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY parameters ALTER COLUMN id SET DEFAULT nextval('parameters_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY permissions ALTER COLUMN id SET DEFAULT nextval('permissions_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY ptables ALTER COLUMN id SET DEFAULT nextval('ptables_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY puppetclasses ALTER COLUMN id SET DEFAULT nextval('puppetclasses_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY realms ALTER COLUMN id SET DEFAULT nextval('realms_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY reports ALTER COLUMN id SET DEFAULT nextval('reports_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY roles ALTER COLUMN id SET DEFAULT nextval('roles_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY sessions ALTER COLUMN id SET DEFAULT nextval('sessions_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY settings ALTER COLUMN id SET DEFAULT nextval('settings_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY smart_proxies ALTER COLUMN id SET DEFAULT nextval('smart_proxies_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY sources ALTER COLUMN id SET DEFAULT nextval('sources_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnet_domains ALTER COLUMN id SET DEFAULT nextval('subnet_domains_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnets ALTER COLUMN id SET DEFAULT nextval('subnets_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY taxable_taxonomies ALTER COLUMN id SET DEFAULT nextval('taxable_taxonomies_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY taxonomies ALTER COLUMN id SET DEFAULT nextval('taxonomies_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY template_combinations ALTER COLUMN id SET DEFAULT nextval('template_combinations_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY template_kinds ALTER COLUMN id SET DEFAULT nextval('template_kinds_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY tokens ALTER COLUMN id SET DEFAULT nextval('tokens_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY trend_counters ALTER COLUMN id SET DEFAULT nextval('trend_counters_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY trends ALTER COLUMN id SET DEFAULT nextval('trends_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY user_mail_notifications ALTER COLUMN id SET DEFAULT nextval('user_mail_notifications_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY user_roles ALTER COLUMN id SET DEFAULT nextval('user_roles_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY usergroup_members ALTER COLUMN id SET DEFAULT nextval('usergroup_members_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY usergroups ALTER COLUMN id SET DEFAULT nextval('usergroups_id_seq'::regclass);


--
-- Name: id; Type: DEFAULT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY users ALTER COLUMN id SET DEFAULT nextval('users_id_seq'::regclass);


--
-- Data for Name: architectures; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY architectures (id, name, created_at, updated_at, hosts_count, hostgroups_count) FROM stdin;
2	i386	2016-04-14 10:08:54.367821	2016-04-14 10:08:54.367821	0	0
1	x86_64	2016-04-14 10:08:54.364193	2016-04-14 10:08:54.364193	0	10
\.


--
-- Name: architectures_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('architectures_id_seq', 2, true);


--
-- Data for Name: architectures_operatingsystems; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY architectures_operatingsystems (architecture_id, operatingsystem_id) FROM stdin;
1	1
1	2
\.


--
-- Data for Name: audits; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY audits (id, auditable_id, auditable_type, user_id, user_type, username, action, audited_changes, version, comment, associated_id, associated_type, created_at, remote_address, auditable_name, associated_name) FROM stdin;
1	13	Setting	2	\N	API Admin	update	---\nvalue:\n- \n- ! '--- false\n\n  ...\n\n'\n	1	\N	\N	\N	2016-04-14 10:08:55.198722	\N	db_pending_migration	\N
2	14	Setting	2	\N	API Admin	update	---\nvalue:\n- \n- ! '--- false\n\n  ...\n\n'\n	1	\N	\N	\N	2016-04-14 10:08:55.207207	\N	db_pending_seed	\N
3	1	Setting	\N	\N	\N	update	---\nvalue:\n- f\n- \n	1	\N	\N	\N	2016-04-14 10:09:10.907881	\N	fix_db_cache	\N
4	19	Setting	\N	\N	\N	update	---\nvalue:\n- \n- ! '--- false\n\n  ...\n\n'\n	1	\N	\N	\N	2016-04-14 10:09:11.129801	\N	oauth_map_users	\N
5	1	Hostgroup	3	\N	Admin User	create	---\nname: LB\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:15:47.159666	10.255.0.9	LB	\N
6	1	Operatingsystem	3	\N	Admin User	create	---\nmajor: '7'\nname: CentOS7.1\nminor: '1'\nnameindicator: \nrelease_name: ''\ndescription: CentOS 7.1\nhosts_count: 0\nhostgroups_count: 0\npassword_hash: MD5\ntitle: CentOS 7.1\n	1	\N	\N	\N	2016-04-14 10:36:00.972407	10.34.130.246	CentOS 7.1	\N
7	46	ConfigTemplate	3	\N	Admin User	create	---\nname: CentOS_7.1 PXELinux\ntemplate: ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\nsnippet: false\ntemplate_kind_id: 1\nlocked: false\ndefault: false\nvendor: \n	1		\N	\N	2016-04-14 10:38:12.590165	10.34.130.246	CentOS_7.1 PXELinux	\N
8	47	ConfigTemplate	3	\N	Admin User	create	---\nname: CentOS_7.1 Provision\ntemplate: ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard\n  us\\nskipx\\nnetwork --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0\n  --nameserver=10.255.0.80 --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname\n  %> --device=bootif --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall\n  --disabled\\ntimezone  UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr\n  --append=\\"nofb quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader\n  --location=mbr --append=\\"nofb quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include\n  /tmp/bootloader.txt\\nauthconfig  --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^0' | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA'\n  |   grep dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls\n  /sys/bus/scsi/devices/ | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif\n  [[ ! -d $devicePath/$deviceID/block ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep\n  '^0:0' | head -n1`\\nfi\\nls $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor\n  disk in $VDISKS\\ndo \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\nsnippet: false\ntemplate_kind_id: 4\nlocked: false\ndefault: false\nvendor: \n	1		\N	\N	2016-04-14 10:38:57.45855	10.34.130.246	CentOS_7.1 Provision	\N
9	46	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n	2		\N	\N	2016-04-14 10:40:54.272306	10.34.130.246	CentOS_7.1 PXELinux	\N
10	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^0' | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA'\n  |   grep dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls\n  /sys/bus/scsi/devices/ | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif\n  [[ ! -d $devicePath/$deviceID/block ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep\n  '^0:0' | head -n1`\\nfi\\nls $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor\n  disk in $VDISKS\\ndo \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^0' | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA'\n  |   grep dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls\n  /sys/bus/scsi/devices/ | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif\n  [[ ! -d $devicePath/$deviceID/block ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep\n  '^0:0' | head -n1`\\nfi\\nls $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor\n  disk in $VDISKS\\ndo \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	2		\N	\N	2016-04-14 10:41:05.816805	10.34.130.246	CentOS_7.1 Provision	\N
11	2	Hostgroup	3	\N	Admin User	create	---\nname: Hypervisor\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:42:35.973978	10.34.130.246	Hypervisor	\N
12	3	Hostgroup	3	\N	Admin User	create	---\nname: Network\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:42:45.247812	10.34.130.246	Network	\N
13	4	Hostgroup	3	\N	Admin User	create	---\nname: Compute\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:42:52.689704	10.34.130.246	Compute	\N
14	5	Hostgroup	3	\N	Admin User	create	---\nname: Web\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:43:02.086931	10.34.130.246	Web	\N
15	6	Hostgroup	3	\N	Admin User	create	---\nname: MQ\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:43:10.654859	10.34.130.246	MQ	\N
16	7	Hostgroup	3	\N	Admin User	create	---\nname: Memcached\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:43:23.185068	10.34.130.246	Memcached	\N
17	8	Hostgroup	3	\N	Admin User	create	---\nname: Mysql\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:43:31.607674	10.34.130.246	Mysql	\N
18	9	Hostgroup	3	\N	Admin User	create	---\nname: CephMon\nenvironment_id: \noperatingsystem_id: \narchitecture_id: \nmedium_id: \nptable_id: \nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-04-14 10:43:41.44809	10.34.130.246	CephMon	\N
19	1	Parameter	3	\N	Admin User	create	---\nname: foreman_server\nvalue: 10.128.137.30\nreference_id: \nhidden_value: false\n	1	\N	\N	\N	2016-04-14 10:44:25.371625	10.34.130.246	foreman_server	\N
20	2	Parameter	3	\N	Admin User	create	---\nname: ntp_server\nvalue: 10.128.137.30\nreference_id: \nhidden_value: false\n	1	\N	\N	\N	2016-04-14 10:44:37.096009	10.34.130.246	ntp_server	\N
21	3	Parameter	3	\N	Admin User	create	---\nname: yum_server\nvalue: 10.128.137.30\nreference_id: \nhidden_value: false\n	1	\N	\N	\N	2016-04-14 10:44:50.751754	10.34.130.246	yum_server	\N
22	4	Parameter	3	\N	Admin User	create	---\nname: puppet_server\nvalue: 10.128.137.130\nreference_id: \nhidden_value: false\n	1	\N	\N	\N	2016-04-14 10:45:06.338734	10.34.130.246	puppet_server	\N
23	4	Parameter	3	\N	Admin User	update	---\nvalue:\n- 10.128.137.130\n- 10.128.137.30\n	2	\N	\N	\N	2016-04-14 10:45:14.65348	10.34.130.246	puppet_server	\N
24	4	User	3	\N	Admin User	create	---\nlogin: api_post_user\nfirstname: ''\nlastname: ''\nmail: ''\nadmin: true\nauth_source_id: 1\nlocale: \navatar_hash: \ndefault_organization_id: \ndefault_location_id: \nlower_login: api_post_user\nmail_enabled: true\ntimezone: ''\n	1	\N	\N	\N	2016-04-14 10:47:50.436836	10.34.130.246	api_post_user	\N
25	1	SmartProxy	4	\N	api_post_user	create	---\nname: saic-137\nurl: http://10.128.137.30:8443\n	1	\N	\N	\N	2016-04-14 10:47:58.966271	10.128.137.30	saic-137	\N
26	1	Domain	4	\N	api_post_user	create	---\nname: 137.saic.ustack.in\nfullname: saic\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-04-14 10:47:59.783432	10.128.137.30	137.saic.ustack.in	\N
27	1	Subnet	4	\N	api_post_user	create	---\nnetwork: 10.128.137.0\nmask: 255.255.255.0\npriority: \nname: saic-137\nvlanid: \ndhcp_id: 1\ntftp_id: 1\ngateway: 10.128.137.1\ndns_primary: 114.114.114.114\ndns_secondary: \nfrom: \nto: \ndns_id: \nboot_mode: DHCP\nipam: DHCP\n	1	\N	\N	\N	2016-04-14 10:48:00.694252	10.128.137.30	saic-137 (10.128.137.0/24)	\N
28	2	Operatingsystem	3	\N	Admin User	create	---\nmajor: '6'\nname: CentOS6.5\nminor: '5'\nnameindicator: \nrelease_name: ''\ndescription: ''\nhosts_count: 0\nhostgroups_count: 0\npassword_hash: MD5\ntitle: CentOS6.5 6.5\n	1	\N	\N	\N	2016-04-14 10:49:23.65236	10.34.133.169	CentOS6.5 6.5	\N
29	8	Medium	4	\N	api_post_user	create	---\nname: saic-137\npath: http://10.128.137.30:8080/media/$major.$minor\nmedia_path: \nconfig_path: \nimage_path: \nos_family: Redhat\n	1	\N	\N	\N	2016-04-14 10:49:29.880053	10.128.137.30	saic-137	\N
30	2	Operatingsystem	3	\N	Admin User	update	---\nname:\n- CentOS6.5\n- CentOS\ntitle:\n- CentOS6.5 6.5\n- CentOS 6.5\n	2	\N	\N	\N	2016-04-14 10:49:50.09197	10.34.130.246	CentOS6.5 6.5	\N
31	1	Host	3	\N	Admin User	create	---\nname: aaa.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: !binary |-\n  JDEkSldkSldxd3AkblhIbWFndXBqWHdSOGI2NWZUUUE3MQ==\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: ''\ndisk: ''\ninstalled_at: \nmodel_id: \nhostgroup_id: 9\nowner_id: 3\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: build\ngrub_pass: !binary |-\n  JDEkRlhVRnh1SXMkM1JoLnRsdkxjUVVSbTdsb2NXZkJJMA==\n	1	\N	\N	\N	2016-04-14 10:51:52.895895	10.34.133.169	aaa.137.saic.ustack.in	\N
32	9	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\nroot_pass:\n- ''\n- !binary |-\n  JDEkWk1QVkczUVIkcXJhdlFvdE1kMHd1RFN2dHRDQ2V3MQ==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkcjJNSFdOV2EkaFU2Z3cxRTN4ZnBKbGwza3BxWFBnMQ==\n	2	\N	\N	\N	2016-04-14 10:53:45.242641	10.34.133.169	CephMon	\N
33	4	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\nroot_pass:\n- ''\n- !binary |-\n  JDEkYndya29CQW8kZnpFQWRZZm5DaGRyNkVja09PV2RuLw==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkOE5tZGs5Y20kSDI2RUlHd1RVQXR2ZHIya29nVmZyLg==\n	2	\N	\N	\N	2016-04-14 10:53:59.615559	10.34.133.169	Compute	\N
34	2	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\nroot_pass:\n- ''\n- !binary |-\n  JDEkOWZtQW5FM3IkUmN1aXZKYkMyMGd4bEtxRU04bHguLg==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkQjF2YUZ5N2QkbDFaNlFqNmpEbjhpZ0wybW9mNWFGMA==\n	2	\N	\N	\N	2016-04-14 10:55:17.560579	10.34.133.169	Hypervisor	\N
35	5	Hostgroup	3	\N	Admin User	update	---\nroot_pass:\n- ''\n- !binary |-\n  JDEkNTFQNUNVOWckWXhQbTMuZWRPY0oxR3VSOWhWeEpGMQ==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkUXlHYnA2QTMkUm9MMFdENVpmOG1ibldtd1hiV1FKMQ==\n	2	\N	\N	\N	2016-04-14 10:55:22.886182	10.34.130.246	Web	\N
36	1	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\nroot_pass:\n- ''\n- !binary |-\n  JDEkZVBzRjlEWSskL3VPb25hU2d0SWVSQy9rN1pKbFlmLg==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkZFpBREFadDAkcnRCMExqZ0pxeUZOZDd3eVhIdlMwMA==\n	2	\N	\N	\N	2016-04-14 10:55:28.793995	10.34.133.169	LB	\N
37	3	Hostgroup	3	\N	Admin User	update	---\nroot_pass:\n- ''\n- !binary |-\n  JDEka0N3VytTQ2skbi8zMUlwM2RkcU1wbWo3d1R2cnhHLw==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkVGlOemVYeEgkMWRBQlIwOUplN3ZlVnRJcUNDeGNLLw==\n	2	\N	\N	\N	2016-04-14 10:55:35.892066	10.34.130.246	Network	\N
38	7	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\nroot_pass:\n- ''\n- !binary |-\n  JDEkbGpMRDRaQjkkNWlENnFwQk1JaUFuT0hwcXVqa09YMQ==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkdWkvc1gxWGYkMWc1Vm9oNURtczROcnlyTDJnU1VNLg==\n	2	\N	\N	\N	2016-04-14 10:55:40.451274	10.34.133.169	Memcached	\N
39	8	Hostgroup	3	\N	Admin User	update	---\nroot_pass:\n- ''\n- !binary |-\n  JDEkQWc2YWJuWU0kWkxCNi9SRUVxMXROcTNtZmVuMXM5MA==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkZk5ULy80Rm0kcE5jdDZjRlZRTTN1OFJnOFRmZEkxLw==\n	2	\N	\N	\N	2016-04-14 10:55:46.85419	10.34.130.246	Mysql	\N
40	6	Hostgroup	3	\N	Admin User	update	---\nroot_pass:\n- ''\n- !binary |-\n  JDEkNTFGb1o5MUQkNHZtbWpZekR3Ny8vNzZCT254dFlsMQ==\ngrub_pass:\n- ''\n- !binary |-\n  JDEkUjBzVnlzL3kkekZnbFJvWTdaNTFMcWl2T3EucHhFMA==\n	2	\N	\N	\N	2016-04-14 10:55:49.590598	10.34.133.169	MQ	\N
41	6	Hostgroup	3	\N	Admin User	update	---\nroot_pass:\n- $1$51FoZ91D$4vmmjYzDw7//76BOnxtYl1\n- !binary |-\n  JDEkZ0g1ZFljMC8kdlZycldYZ3pHa25vY2l2aXpTTWpVLw==\ngrub_pass:\n- $1$R0sVys/y$zFglRoY7Z51LqivOq.pxE0\n- !binary |-\n  JDEkTnZpNFc5WHkkZ3doT2xTaDQ2dGhEcmJ6ajNGOVh2Lw==\n	3	\N	\N	\N	2016-04-14 10:55:56.612695	10.34.130.246	MQ	\N
42	3	Host	4	\N	api_post_user	create	---\nname: server-31.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	1	\N	\N	\N	2016-04-14 10:56:24.386345	10.128.137.30	server-31.137.saic.ustack.in	\N
43	4	Host	4	\N	api_post_user	create	---\nname: server-32.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	1	\N	\N	\N	2016-04-14 10:56:25.90345	10.128.137.30	server-32.137.saic.ustack.in	\N
44	5	Host	4	\N	api_post_user	create	---\nname: server-33.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	1	\N	\N	\N	2016-04-14 10:56:27.263529	10.128.137.30	server-33.137.saic.ustack.in	\N
45	3	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\ngrub_pass:\n- $1$TiNzeXxH$1dABR09Je7veVtIqCCxcK/\n- $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	3	\N	\N	\N	2016-04-14 10:56:57.826745	10.34.133.169	Network	\N
46	6	Host	4	\N	api_post_user	create	---\nname: server-64.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	1	\N	\N	\N	2016-04-14 10:57:06.930834	10.128.137.30	server-64.137.saic.ustack.in	\N
137	17	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:27.320904156 Z\n	2	\N	\N	\N	2016-04-15 03:09:27.456294	10.128.137.43	server-43.137.saic.ustack.in	\N
247	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/puppet.0.saic.ustack.in:80/<%= @host.params['foreman_server']\n  %>:3000/g')\\ncurl $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n    nic_mac=$2\\n\n  \\   nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	9		\N	\N	2016-05-05 04:23:53.980891	172.16.1.133	CentOS_7.1 Provision	\N
47	7	Host	4	\N	api_post_user	create	---\nname: server-65.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	1	\N	\N	\N	2016-04-14 10:57:08.634703	10.128.137.30	server-65.137.saic.ustack.in	\N
48	8	Host	4	\N	api_post_user	create	---\nname: server-66.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	1	\N	\N	\N	2016-04-14 10:57:10.105792	10.128.137.30	server-66.137.saic.ustack.in	\N
49	9	Host	4	\N	api_post_user	create	---\nname: server-68.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	1	\N	\N	\N	2016-04-14 10:57:11.422027	10.128.137.30	server-68.137.saic.ustack.in	\N
50	10	Host	4	\N	api_post_user	create	---\nname: server-69.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	1	\N	\N	\N	2016-04-14 10:57:12.669177	10.128.137.30	server-69.137.saic.ustack.in	\N
51	11	Host	4	\N	api_post_user	create	---\nname: server-70.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	1	\N	\N	\N	2016-04-14 10:57:13.906486	10.128.137.30	server-70.137.saic.ustack.in	\N
52	1	Host	3	\N	Admin User	destroy	---\nname: aaa.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$JWdJWqwp$nXHmagupjXwR8b65fTQA71\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: ''\ndisk: ''\ninstalled_at: \nmodel_id: \nhostgroup_id: 9\nowner_id: 3\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: build\ngrub_pass: $1$FXUFxuIs$3Rh.tlvLcQURm7locWfBI0\n	2	\N	\N	\N	2016-04-14 10:57:15.068089	10.34.130.246	aaa.137.saic.ustack.in	\N
53	46	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=https://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n	3		\N	\N	2016-04-14 11:13:06.069732	10.34.133.169	CentOS_7.1 PXELinux	\N
54	3	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:13:49.905067	10.34.133.169	server-31.137.saic.ustack.in	\N
55	4	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:13:53.175361	10.34.133.169	server-32.137.saic.ustack.in	\N
56	5	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:13:54.202149	10.34.133.169	server-33.137.saic.ustack.in	\N
57	3	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:13:58.92542	10.34.133.169	server-31.137.saic.ustack.in	\N
58	4	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:02.845076	10.34.133.169	server-32.137.saic.ustack.in	\N
59	5	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:06.386976	10.34.133.169	server-33.137.saic.ustack.in	\N
60	6	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:08.623552	10.34.133.169	server-64.137.saic.ustack.in	\N
61	6	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:11.47979	10.34.133.169	server-64.137.saic.ustack.in	\N
62	7	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:14.0775	10.34.133.169	server-65.137.saic.ustack.in	\N
63	7	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:16.316892	10.34.133.169	server-65.137.saic.ustack.in	\N
64	8	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:21.539894	10.34.133.169	server-66.137.saic.ustack.in	\N
65	8	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:23.78089	10.34.133.169	server-66.137.saic.ustack.in	\N
66	9	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:26.341408	10.34.133.169	server-68.137.saic.ustack.in	\N
67	9	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:28.519638	10.34.133.169	server-68.137.saic.ustack.in	\N
68	10	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:30.379342	10.34.133.169	server-69.137.saic.ustack.in	\N
69	10	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:32.882172	10.34.133.169	server-69.137.saic.ustack.in	\N
70	11	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	2	\N	\N	\N	2016-04-14 11:14:34.422548	10.34.133.169	server-70.137.saic.ustack.in	\N
71	11	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	3	\N	\N	\N	2016-04-14 11:14:36.543322	10.34.133.169	server-70.137.saic.ustack.in	\N
72	46	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=https://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n- ! 'default linux\n\n  label linux\n\n  kernel boot/CentOS7.1-7.1-x86_64-vmlinuz\n\n  IPAPPEND 2\n\n  append initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params[''foreman_server'']\n  %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n\n'\n	4		\N	\N	2016-04-14 11:54:32.935002	10.34.133.169	CentOS_7.1 PXELinux	\N
73	3	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:54:36.527144	10.34.133.169	server-31.137.saic.ustack.in	\N
74	3	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:54:39.483644	10.34.133.169	server-31.137.saic.ustack.in	\N
75	4	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:55:42.767103	10.34.133.169	server-32.137.saic.ustack.in	\N
76	4	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:55:45.693321	10.34.133.169	server-32.137.saic.ustack.in	\N
77	6	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:55:51.870994	10.34.133.169	server-64.137.saic.ustack.in	\N
78	6	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:55:54.742995	10.34.133.169	server-64.137.saic.ustack.in	\N
79	7	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:55:56.919721	10.34.133.169	server-65.137.saic.ustack.in	\N
80	7	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:55:59.290748	10.34.133.169	server-65.137.saic.ustack.in	\N
81	8	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:56:02.539331	10.34.133.169	server-66.137.saic.ustack.in	\N
82	8	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:56:04.682794	10.34.133.169	server-66.137.saic.ustack.in	\N
83	9	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:56:07.095307	10.34.133.169	server-68.137.saic.ustack.in	\N
84	9	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:56:09.642645	10.34.133.169	server-68.137.saic.ustack.in	\N
85	10	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:56:12.294182	10.34.133.169	server-69.137.saic.ustack.in	\N
86	10	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:56:14.620576	10.34.133.169	server-69.137.saic.ustack.in	\N
87	11	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:56:29.686329	10.34.133.169	server-70.137.saic.ustack.in	\N
88	11	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:56:31.722573	10.34.133.169	server-70.137.saic.ustack.in	\N
89	5	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-14 11:56:43.925353	10.34.133.169	server-33.137.saic.ustack.in	\N
90	5	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-14 11:56:47.165834	10.34.133.169	server-33.137.saic.ustack.in	\N
91	8	Medium	3	\N	Admin User	update	---\npath:\n- http://10.128.137.30:8080/media/$major.$minor\n- http://10.128.137.30:8000/media/$major.$minor\nmedia_path:\n- \n- ''\nconfig_path:\n- \n- ''\nimage_path:\n- \n- ''\n	2	\N	\N	\N	2016-04-14 12:16:48.000362	10.34.133.169	saic-137	\N
92	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^0' | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA'\n  |   grep dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls\n  /sys/bus/scsi/devices/ | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif\n  [[ ! -d $devicePath/$deviceID/block ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep\n  '^0:0' | head -n1`\\nfi\\nls $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor\n  disk in $VDISKS\\ndo \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	3		\N	\N	2016-04-14 12:25:17.357212	10.34.133.169	CentOS_7.1 Provision	\N
93	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  biosdevname=0 intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho\n  \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho\n  \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	4		\N	\N	2016-04-14 12:41:56.261513	10.34.133.169	CentOS_7.1 Provision	\N
94	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\n/bin/bash\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	5		\N	\N	2016-04-14 13:04:54.930384	10.34.133.169	CentOS_7.1 Provision	\N
95	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^6:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	6		\N	\N	2016-04-14 13:59:55.40951	10.34.133.169	CentOS_7.1 Provision	\N
96	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^6:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	7		\N	\N	2016-04-15 01:22:21.232502	10.34.133.169	CentOS_7.1 Provision	\N
97	5	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:22:24.462538	10.34.133.169	server-33.137.saic.ustack.in	\N
98	5	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	7	\N	\N	\N	2016-04-15 01:22:27.367475	10.34.133.169	server-33.137.saic.ustack.in	\N
99	3	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:00.748001	10.34.133.169	server-31.137.saic.ustack.in	\N
100	4	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:02.981908	10.34.133.169	server-32.137.saic.ustack.in	\N
101	6	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:05.157538	10.34.133.169	server-64.137.saic.ustack.in	\N
102	7	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:07.128532	10.34.133.169	server-65.137.saic.ustack.in	\N
103	8	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:10.706705	10.34.133.169	server-66.137.saic.ustack.in	\N
104	9	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:13.141252	10.34.133.169	server-68.137.saic.ustack.in	\N
105	10	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:15.292562	10.34.133.169	server-69.137.saic.ustack.in	\N
106	11	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	6	\N	\N	\N	2016-04-15 01:23:17.147162	10.34.133.169	server-70.137.saic.ustack.in	\N
107	3	User	3	\N	Admin User	update	---\nlocale:\n- \n- en\ntimezone:\n- \n- ''\n	1	\N	\N	\N	2016-04-15 01:59:29.812315	10.34.133.169	Admin User	\N
108	1	ComputeResource	3	\N	Admin User	create	---\nname: 0_saic_hypervisor_31\ndescription: ''\nurl: qemu+ssh://root@10.128.137.31/system\nuser: \nuuid: 30393137-3436-4336-5535-343158393930\n	1	\N	\N	\N	2016-04-15 02:07:44.912385	10.34.133.169	0_saic_hypervisor_31 (Libvirt)	\N
109	2	ComputeResource	3	\N	Admin User	create	---\nname: 0_saic_hypervisor_32\ndescription: ''\nurl: qemu+ssh://root@10.128.137.32/system\nuser: \nuuid: 30393137-3436-4336-5535-343158393950\n	1	\N	\N	\N	2016-04-15 02:08:55.607031	10.34.133.169	0_saic_hypervisor_32 (Libvirt)	\N
110	3	ComputeResource	4	\N	api_post_user	create	---\nname: 0_saic_hypervisor_33\ndescription: \nurl: qemu+ssh://root@10.128.137.33/system\nuser: \nuuid: \n	1	\N	\N	\N	2016-04-15 02:49:59.769985	10.128.137.30	0_saic_hypervisor_33 (Libvirt)	\N
138	18	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:28.106018183 Z\n	2	\N	\N	\N	2016-04-15 03:09:28.213547	10.128.137.61	server-61.137.saic.ustack.in	\N
139	16	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:41.153346868 Z\n	2	\N	\N	\N	2016-04-15 03:09:41.332215	10.128.137.42	server-42.137.saic.ustack.in	\N
140	22	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:42.024423358 Z\n	2	\N	\N	\N	2016-04-15 03:09:42.152181	10.128.137.45	server-45.137.saic.ustack.in	\N
111	12	Host	4	\N	api_post_user	create	---\nname: server-34.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  NGIwODg4NGUtODhlNS00ZDFlLWFlM2MtNzY2ZmY4OGY4OGQ4\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	1	\N	\N	\N	2016-04-15 02:53:52.076075	10.128.137.30	server-34.137.saic.ustack.in	\N
112	13	Host	4	\N	api_post_user	create	---\nname: server-35.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  MDYwYjU2MzItYzYxMi00MjY3LWExOWEtMDk4NmMyN2MxMzUz\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	1	\N	\N	\N	2016-04-15 02:53:54.719191	10.128.137.30	server-35.137.saic.ustack.in	\N
113	14	Host	4	\N	api_post_user	create	---\nname: server-36.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  NDQ1OTk0YWEtM2NkOS00NzRlLTkzZGMtODI5YTQ4N2ZmOWNj\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	1	\N	\N	\N	2016-04-15 02:56:41.499902	10.128.137.30	server-36.137.saic.ustack.in	\N
114	5	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\ngrub_pass:\n- $1$QyGbp6A3$RoL0WD5Zf8mbnWmwXbWQJ1\n- $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	3	\N	\N	\N	2016-04-15 02:57:44.203955	10.34.133.169	Web	\N
115	8	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\ngrub_pass:\n- $1$fNT//4Fm$pNct6cFVQM3u8Rg8TfdI1/\n- $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	3	\N	\N	\N	2016-04-15 02:57:52.928379	10.34.133.169	Mysql	\N
116	6	Hostgroup	3	\N	Admin User	update	---\narchitecture_id:\n- \n- 1\ngrub_pass:\n- $1$Nvi4W9Xy$gwhOlSh46thDrbzj3F9Xv/\n- $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	4	\N	\N	\N	2016-04-15 02:58:02.04739	10.34.133.169	MQ	\N
117	15	Host	4	\N	api_post_user	create	---\nname: server-41.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  YWZmZWFkNTgtM2M4ZS00Y2ExLTk4NzAtMDk1YjZkMzA5YTMx\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	1	\N	\N	\N	2016-04-15 02:59:28.551966	10.128.137.30	server-41.137.saic.ustack.in	\N
118	16	Host	4	\N	api_post_user	create	---\nname: server-42.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  M2M3YTE0MGQtMDczMi00NTdlLTgzY2MtNjllYTQzOWZmM2Ux\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	1	\N	\N	\N	2016-04-15 02:59:40.509349	10.128.137.30	server-42.137.saic.ustack.in	\N
119	17	Host	4	\N	api_post_user	create	---\nname: server-43.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  ZDJjNWE0ZDUtNTE3Yy00ZDI0LTgzNzMtNDdiYmRmMmVkMGE2\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	1	\N	\N	\N	2016-04-15 02:59:42.536703	10.128.137.30	server-43.137.saic.ustack.in	\N
120	18	Host	4	\N	api_post_user	create	---\nname: server-61.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  YmJjNGZjYjEtM2FmZi00OGY3LThhMDEtNDAzZmFkY2IwY2Vj\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	1	\N	\N	\N	2016-04-15 02:59:44.666919	10.128.137.30	server-61.137.saic.ustack.in	\N
121	19	Host	4	\N	api_post_user	create	---\nname: server-62.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  YzNkMWMyYzUtZDBmYi00NzM1LThmMjctMDZhYWM1YmE4MjUw\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	1	\N	\N	\N	2016-04-15 02:59:46.774102	10.128.137.30	server-62.137.saic.ustack.in	\N
122	20	Host	4	\N	api_post_user	create	---\nname: server-63.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  YmRjYzhmOWItMjI5OS00M2QyLWIyNDUtOWZhZGI1ODhiYTI3\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	1	\N	\N	\N	2016-04-15 02:59:49.136561	10.128.137.30	server-63.137.saic.ustack.in	\N
132	5	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	8	\N	\N	\N	2016-04-15 03:00:42.023307	10.34.131.243	server-33.137.saic.ustack.in	\N
123	21	Host	4	\N	api_post_user	create	---\nname: server-44.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  M2M3Mzk2ZjgtZGM3Yy00NTc2LWExZTAtNTRlNGE2YTc1M2Zh\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	1	\N	\N	\N	2016-04-15 02:59:51.375105	10.128.137.30	server-44.137.saic.ustack.in	\N
124	22	Host	4	\N	api_post_user	create	---\nname: server-45.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  NGM1NjU5OGEtODJmNi00NjdjLWI0YmMtNjhkMmUzZmY4ZWIw\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	1	\N	\N	\N	2016-04-15 02:59:53.703116	10.128.137.30	server-45.137.saic.ustack.in	\N
125	23	Host	4	\N	api_post_user	create	---\nname: server-46.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  MmUzYjY4OWQtNWRjMC00MTYyLTlmZmItZGNiYmE5ZTAzZjJj\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	1	\N	\N	\N	2016-04-15 02:59:55.968248	10.128.137.30	server-46.137.saic.ustack.in	\N
126	24	Host	4	\N	api_post_user	create	---\nname: server-47.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  MGY0NTEyMmYtZWVjNC00NmNjLTgxNjQtM2Y0ODE1NmRjZmUz\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	1	\N	\N	\N	2016-04-15 02:59:58.057735	10.128.137.30	server-47.137.saic.ustack.in	\N
127	25	Host	4	\N	api_post_user	create	---\nname: server-48.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  MzkyZmJkN2UtMDU2ZC00MjljLWJkMzEtYWVmNTk2MTQ1NDdk\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	1	\N	\N	\N	2016-04-15 03:00:00.545162	10.128.137.30	server-48.137.saic.ustack.in	\N
128	26	Host	4	\N	api_post_user	create	---\nname: server-49.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  NmY4YmNhZGMtYWIxMy00YjkyLWFmMTMtYmYyYzNhOGZlNzQ4\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	1	\N	\N	\N	2016-04-15 03:00:02.824836	10.128.137.30	server-49.137.saic.ustack.in	\N
129	27	Host	4	\N	api_post_user	create	---\nname: server-50.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  ODk5YmQwODgtZmZkMS00MzFmLTk4ODMtMjc5NzIwNzVhN2U3\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	1	\N	\N	\N	2016-04-15 03:00:04.811123	10.128.137.30	server-50.137.saic.ustack.in	\N
130	28	Host	4	\N	api_post_user	create	---\nname: server-51.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  NjEzY2Q5YWMtNDcyZC00Y2Y0LTk0Y2UtYmZhNzdmMWQ0MWZl\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	1	\N	\N	\N	2016-04-15 03:00:06.942729	10.128.137.30	server-51.137.saic.ustack.in	\N
131	29	Host	4	\N	api_post_user	create	---\nname: server-52.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: !binary |-\n  ZDBlOTc2MGItYWQ2My00NGJkLThiMjUtYmM0ZDE4ZjE5MDU4\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	1	\N	\N	\N	2016-04-15 03:00:09.277801	10.128.137.30	server-52.137.saic.ustack.in	\N
133	3	Setting	3	\N	Admin User	update	---\nvalue:\n- \n- ! '--- http://10.128.137.30:3000\n\n  ...\n\n'\n	1	\N	\N	\N	2016-04-15 03:01:57.478361	10.34.133.169	foreman_url	\N
134	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/10.255.0.201/<%= @host.params['foreman_server'] %>/g')\\ncurl\n  $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n\n  \\   nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\nnew_url=$(echo\n  <%= foreman_url %> |sed 's/puppet.0.saic.ustack.in:80/<%= @host.params['foreman_server']\n  %>:3000/g')\\ncurl $new_url\\n\\ndeclare -A linked\\ndeclare -A no_link\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n	8		\N	\N	2016-04-15 03:02:23.105537	10.34.133.169	CentOS_7.1 Provision	\N
135	3	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://10.128.137.30:3000\n\n  ...\n\n'\n- \n	2	\N	\N	\N	2016-04-15 03:04:06.538891	10.34.133.169	foreman_url	\N
136	15	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:08:58.981365257 Z\n	2	\N	\N	\N	2016-04-15 03:08:59.364383	10.128.137.41	server-41.137.saic.ustack.in	\N
248	28	Setting	3	\N	Admin User	update	---\nvalue:\n- \n- ! '--- http://foreman.example.com\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-05 04:24:27.68911	172.16.1.133	unattended_url	\N
141	19	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:46.802511811 Z\n	2	\N	\N	\N	2016-04-15 03:09:46.912187	10.128.137.62	server-62.137.saic.ustack.in	\N
142	20	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:47.051469147 Z\n	2	\N	\N	\N	2016-04-15 03:09:47.19773	10.128.137.63	server-63.137.saic.ustack.in	\N
143	21	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:48.681623497 Z\n	2	\N	\N	\N	2016-04-15 03:09:48.813671	10.128.137.44	server-44.137.saic.ustack.in	\N
144	23	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:09:52.998054373 Z\n	2	\N	\N	\N	2016-04-15 03:09:53.292764	10.128.137.46	server-46.137.saic.ustack.in	\N
145	27	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:14.242030016 Z\n	2	\N	\N	\N	2016-04-15 03:10:14.365757	10.128.137.50	server-50.137.saic.ustack.in	\N
146	28	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:23.704228381 Z\n	2	\N	\N	\N	2016-04-15 03:10:23.819493	10.128.137.51	server-51.137.saic.ustack.in	\N
147	13	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:26.274425713 Z\n	2	\N	\N	\N	2016-04-15 03:10:26.50147	10.128.137.35	server-35.137.saic.ustack.in	\N
148	12	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:26.617461708 Z\n	2	\N	\N	\N	2016-04-15 03:10:26.710128	10.128.137.34	server-34.137.saic.ustack.in	\N
149	25	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:26.870899697 Z\n	2	\N	\N	\N	2016-04-15 03:10:26.983371	10.128.137.48	server-48.137.saic.ustack.in	\N
150	24	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:27.778243238 Z\n	2	\N	\N	\N	2016-04-15 03:10:28.032009	10.128.137.47	server-47.137.saic.ustack.in	\N
151	26	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:28.862721854 Z\n	2	\N	\N	\N	2016-04-15 03:10:28.962183	10.128.137.49	server-49.137.saic.ustack.in	\N
154	30	Host	3	\N	Admin User	create	---\nname: server-21.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: true\ncomment: ''\ndisk: ''\ninstalled_at: \nmodel_id: \nhostgroup_id: 5\nowner_id: 3\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: 1\nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: build\ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	1	\N	\N	\N	2016-04-15 06:48:50.207355	10.34.133.174	server-21.137.saic.ustack.in	\N
152	14	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:28.954729429 Z\n	2	\N	\N	\N	2016-04-15 03:10:29.068084	10.128.137.36	server-36.137.saic.ustack.in	\N
153	29	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 03:10:33.731552113 Z\n	2	\N	\N	\N	2016-04-15 03:10:33.843023	10.128.137.52	server-52.137.saic.ustack.in	\N
155	30	Host	3	\N	Admin User	update	---\npuppet_ca_proxy_id:\n- 1\n- \n	2	\N	\N	\N	2016-04-15 07:02:39.404859	10.34.133.169	server-21.137.saic.ustack.in	\N
156	30	Host	3	\N	Admin User	update	---\nhostgroup_id:\n- 5\n- 3\n	3	\N	\N	\N	2016-04-15 07:04:50.314218	10.34.133.169	server-21.137.saic.ustack.in	\N
157	30	Host	3	\N	Admin User	update	---\nbuild:\n- true\n- false\n	4	\N	\N	\N	2016-04-15 07:04:53.312392	10.34.133.169	server-21.137.saic.ustack.in	\N
158	30	Host	3	\N	Admin User	update	---\nbuild:\n- false\n- true\n	5	\N	\N	\N	2016-04-15 07:04:58.396104	10.34.133.169	server-21.137.saic.ustack.in	\N
159	30	Host	2	\N	API Admin	update	---\nbuild:\n- true\n- false\ninstalled_at:\n- \n- 2016-04-15 07:30:29.842256981 Z\n	6	\N	\N	\N	2016-04-15 07:30:30.012177	10.128.137.21	server-21.137.saic.ustack.in	\N
160	17	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- zhSmyDzv45v3UXkCU6YXmTBwE2mZ52DL\n\n  ...\n\n'\n- ! '--- Tdvz2jwZT9hoFyGbgTxLVnCEPskjuUof\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-03 03:19:23.366863	\N	oauth_consumer_key	\N
161	18	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- N6pfsLfcxRBLBUkcNRerRRV4SWXXorRt\n\n  ...\n\n'\n- ! '--- LzNDphvHwFSteiRzpYXjbFzYfhuauMSp\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-03 03:19:23.37752	\N	oauth_consumer_secret	\N
162	42	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/private_keys/puppet.0.saic.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/private_keys/server-98.100.ct.ustack.in.pem\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-03 03:19:23.545789	\N	websockets_ssl_key	\N
163	43	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/certs/puppet.0.saic.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/certs/server-98.100.ct.ustack.in.pem\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-03 03:19:23.56092	\N	websockets_ssl_cert	\N
249	1	Parameter	3	\N	Admin User	update	---\nvalue:\n- 10.128.137.30\n- 10.0.100.31\n	2	\N	\N	\N	2016-05-05 07:31:41.683111	172.16.1.133	foreman_server	\N
250	2	Parameter	3	\N	Admin User	update	---\nvalue:\n- 10.128.137.30\n- 10.0.100.31\n	2	\N	\N	\N	2016-05-05 07:31:45.134212	172.16.1.133	ntp_server	\N
170	1	SmartProxy	3	\N	Admin User	update	---\nurl:\n- http://10.128.137.30:8443\n- http://10.0.100.98:8443\n	2	\N	\N	\N	2016-05-03 03:24:08.174676	172.16.1.133	saic-137	\N
171	5	Host	3	\N	Admin User	destroy	---\nname: server-33.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	9	\N	\N	\N	2016-05-04 03:18:12.15345	172.16.1.133	server-33.137.saic.ustack.in	\N
178	3	Host	3	\N	Admin User	destroy	---\nname: server-31.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	7	\N	\N	\N	2016-05-04 03:18:49.352531	172.16.1.133	server-31.137.saic.ustack.in	\N
179	4	Host	3	\N	Admin User	destroy	---\nname: server-32.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 2\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..\n	7	\N	\N	\N	2016-05-04 03:18:49.466217	172.16.1.133	server-32.137.saic.ustack.in	\N
251	4	Parameter	3	\N	Admin User	update	---\nvalue:\n- 10.128.137.30\n- 10.0.100.31\n	3	\N	\N	\N	2016-05-05 07:31:48.38222	172.16.1.133	puppet_server	\N
191	30	Host	3	\N	Admin User	destroy	---\nname: server-21.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: ''\ndisk: ''\ninstalled_at: 2016-04-15 07:30:29.842256000 Z\nmodel_id: \nhostgroup_id: 3\nowner_id: 3\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: build\ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	7	\N	\N	\N	2016-05-04 03:18:53.023056	172.16.1.133	server-21.137.saic.ustack.in	\N
198	6	Host	3	\N	Admin User	destroy	---\nname: server-64.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	7	\N	\N	\N	2016-05-04 03:19:30.094682	172.16.1.133	server-64.137.saic.ustack.in	\N
199	7	Host	3	\N	Admin User	destroy	---\nname: server-65.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	7	\N	\N	\N	2016-05-04 03:19:30.325799	172.16.1.133	server-65.137.saic.ustack.in	\N
252	3	Parameter	3	\N	Admin User	update	---\nvalue:\n- 10.128.137.30\n- 10.0.100.31\n	2	\N	\N	\N	2016-05-05 07:32:09.925862	172.16.1.133	yum_server	\N
212	8	Host	3	\N	Admin User	destroy	---\nname: server-66.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 3\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/\n	7	\N	\N	\N	2016-05-04 03:19:49.74835	172.16.1.133	server-66.137.saic.ustack.in	\N
213	9	Host	3	\N	Admin User	destroy	---\nname: server-68.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	7	\N	\N	\N	2016-05-04 03:19:49.870605	172.16.1.133	server-68.137.saic.ustack.in	\N
214	11	Host	3	\N	Admin User	destroy	---\nname: server-70.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	7	\N	\N	\N	2016-05-04 03:19:58.866319	172.16.1.133	server-70.137.saic.ustack.in	\N
215	10	Host	3	\N	Admin User	destroy	---\nname: server-69.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: \nmodel_id: \nhostgroup_id: 4\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: \ncompute_resource_id: \npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/\n	7	\N	\N	\N	2016-05-04 03:20:03.992433	172.16.1.133	server-69.137.saic.ustack.in	\N
216	15	Host	3	\N	Admin User	destroy	---\nname: server-41.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:08:58.981365000 Z\nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: affead58-3c8e-4ca1-9870-095b6d309a31\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	3	\N	\N	\N	2016-05-04 03:22:00.130314	172.16.1.133	server-41.137.saic.ustack.in	\N
217	17	Host	3	\N	Admin User	destroy	---\nname: server-43.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:27.320904000 Z\nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: d2c5a4d5-517c-4d24-8373-47bbdf2ed0a6\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	3	\N	\N	\N	2016-05-04 03:22:00.375499	172.16.1.133	server-43.137.saic.ustack.in	\N
253	3	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://foreman.example.com\n\n  ...\n\n'\n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n	5	\N	\N	\N	2016-05-05 07:32:34.178905	172.16.1.133	foreman_url	\N
254	2	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- root@foreman.example.com\n\n  ...\n\n'\n- ! '--- root@foreman.ustack.com\n\n  ...\n\n'\n	2	\N	\N	\N	2016-05-05 07:32:41.030103	172.16.1.133	administrator	\N
255	28	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://foreman.example.com\n\n  ...\n\n'\n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n	2	\N	\N	\N	2016-05-05 07:32:55.017705	172.16.1.133	unattended_url	\N
256	17	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- Tdvz2jwZT9hoFyGbgTxLVnCEPskjuUof\n\n  ...\n\n'\n- ! '--- c2hVZkkyoz2ShxiRFHQ92TkktG2W2uRN\n\n  ...\n\n'\n	2	\N	\N	\N	2016-05-10 11:22:23.49635	\N	oauth_consumer_key	\N
218	18	Host	3	\N	Admin User	destroy	---\nname: server-61.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:28.106018000 Z\nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: bbc4fcb1-3aff-48f7-8a01-403fadcb0cec\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	3	\N	\N	\N	2016-05-04 03:22:00.487972	172.16.1.133	server-61.137.saic.ustack.in	\N
219	16	Host	3	\N	Admin User	destroy	---\nname: server-42.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:41.153346000 Z\nmodel_id: \nhostgroup_id: 5\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 3c7a140d-0732-457e-83cc-69ea439ff3e1\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1\n	3	\N	\N	\N	2016-05-04 03:22:00.619402	172.16.1.133	server-42.137.saic.ustack.in	\N
220	22	Host	3	\N	Admin User	destroy	---\nname: server-45.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:42.024423000 Z\nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 4c56598a-82f6-467c-b4bc-68d2e3ff8eb0\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	3	\N	\N	\N	2016-05-04 03:22:00.753842	172.16.1.133	server-45.137.saic.ustack.in	\N
221	19	Host	3	\N	Admin User	destroy	---\nname: server-62.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:46.802511000 Z\nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: c3d1c2c5-d0fb-4735-8f27-06aac5ba8250\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	3	\N	\N	\N	2016-05-04 03:22:01.046492	172.16.1.133	server-62.137.saic.ustack.in	\N
222	20	Host	3	\N	Admin User	destroy	---\nname: server-63.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:47.051469000 Z\nmodel_id: \nhostgroup_id: 9\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: bdcc8f9b-2299-43d2-b245-9fadb588ba27\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ZMPVG3QR$qravQotMd0wuDSvttCCew1\n	3	\N	\N	\N	2016-05-04 03:22:01.182608	172.16.1.133	server-63.137.saic.ustack.in	\N
223	21	Host	3	\N	Admin User	destroy	---\nname: server-44.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:48.681623000 Z\nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 3c7396f8-dc7c-4576-a1e0-54e4a6a753fa\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	3	\N	\N	\N	2016-05-04 03:22:01.31709	172.16.1.133	server-44.137.saic.ustack.in	\N
224	23	Host	3	\N	Admin User	destroy	---\nname: server-46.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:09:52.998054000 Z\nmodel_id: \nhostgroup_id: 6\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 2e3b689d-5dc0-4162-9ffb-dcbba9e03f2c\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$gH5dYc0/$vVrrWXgzGknocivizSMjU/\n	3	\N	\N	\N	2016-05-04 03:22:01.558344	172.16.1.133	server-46.137.saic.ustack.in	\N
225	27	Host	3	\N	Admin User	destroy	---\nname: server-50.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:14.242030000 Z\nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 899bd088-ffd1-431f-9883-27972075a7e7\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	3	\N	\N	\N	2016-05-04 03:22:01.68774	172.16.1.133	server-50.137.saic.ustack.in	\N
226	28	Host	3	\N	Admin User	destroy	---\nname: server-51.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:23.704228000 Z\nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 613cd9ac-472d-4cf4-94ce-bfa77f1d41fe\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	3	\N	\N	\N	2016-05-04 03:22:01.826788	172.16.1.133	server-51.137.saic.ustack.in	\N
227	13	Host	3	\N	Admin User	destroy	---\nname: server-35.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:26.274425000 Z\nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 060b5632-c612-4267-a19a-0986c27c1353\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	3	\N	\N	\N	2016-05-04 03:22:02.099837	172.16.1.133	server-35.137.saic.ustack.in	\N
228	12	Host	3	\N	Admin User	destroy	---\nname: server-34.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:26.617461000 Z\nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 4b08884e-88e5-4d1e-ae3c-766ff88f88d8\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	3	\N	\N	\N	2016-05-04 03:22:02.240748	172.16.1.133	server-34.137.saic.ustack.in	\N
229	25	Host	3	\N	Admin User	destroy	---\nname: server-48.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:26.870899000 Z\nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 392fbd7e-056d-429c-bd31-aef59614547d\ncompute_resource_id: 2\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	3	\N	\N	\N	2016-05-04 03:22:02.374201	172.16.1.133	server-48.137.saic.ustack.in	\N
230	24	Host	3	\N	Admin User	destroy	---\nname: server-47.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:27.778243000 Z\nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 0f45122f-eec4-46cc-8164-3f48156dcfe3\ncompute_resource_id: 1\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	3	\N	\N	\N	2016-05-04 03:22:02.610578	172.16.1.133	server-47.137.saic.ustack.in	\N
231	26	Host	3	\N	Admin User	destroy	---\nname: server-49.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:28.862721000 Z\nmodel_id: \nhostgroup_id: 7\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 6f8bcadc-ab13-4b92-af13-bf2c3a8fe748\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1\n	3	\N	\N	\N	2016-05-04 03:22:02.766028	172.16.1.133	server-49.137.saic.ustack.in	\N
232	14	Host	3	\N	Admin User	destroy	---\nname: server-36.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:28.954729000 Z\nmodel_id: \nhostgroup_id: 1\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: 445994aa-3cd9-474e-93dc-829a487ff9cc\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.\n	3	\N	\N	\N	2016-05-04 03:22:02.904892	172.16.1.133	server-36.137.saic.ustack.in	\N
233	29	Host	3	\N	Admin User	destroy	---\nname: server-52.137.saic.ustack.in\nlast_freshcheck: \nsource_file_id: \nroot_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\nserial: \narchitecture_id: 1\noperatingsystem_id: 1\nenvironment_id: 1\nptable_id: 8\nmedium_id: 8\nbuild: false\ncomment: \ndisk: \ninstalled_at: 2016-04-15 03:10:33.731552000 Z\nmodel_id: \nhostgroup_id: 8\nowner_id: 4\nowner_type: User\nenabled: true\npuppet_ca_proxy_id: \nmanaged: true\nuse_image: \nimage_file: \nuuid: d0e9760b-ad63-44bd-8b25-bc4d18f19058\ncompute_resource_id: 3\npuppet_proxy_id: \ncertname: \nimage_id: \norganization_id: \nlocation_id: \notp: \nrealm_id: \ncompute_profile_id: \nprovision_method: \ngrub_pass: $1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90\n	3	\N	\N	\N	2016-05-04 03:22:03.145231	172.16.1.133	server-52.137.saic.ustack.in	\N
234	1	ComputeResource	3	\N	Admin User	destroy	---\nname: 0_saic_hypervisor_31\ndescription: ''\nurl: qemu+ssh://root@10.0.100.31/system\nuser: \nuuid: 30393137-3436-4336-5535-343158393930\n	2	\N	\N	\N	2016-05-04 03:25:28.978803	172.16.1.133	0_saic_hypervisor_31 (Libvirt)	\N
235	2	ComputeResource	3	\N	Admin User	destroy	---\nname: 0_saic_hypervisor_32\ndescription: ''\nurl: qemu+ssh://root@10.0.100.31/system\nuser: \nuuid: 30393137-3436-4336-5535-343158393950\n	2	\N	\N	\N	2016-05-04 03:25:32.163053	172.16.1.133	0_saic_hypervisor_32 (Libvirt)	\N
236	3	ComputeResource	3	\N	Admin User	destroy	---\nname: 0_saic_hypervisor_33\ndescription: \nurl: qemu+ssh://root@10.0.100.31/system\nuser: \nuuid: \n	2	\N	\N	\N	2016-05-04 03:25:35.369878	172.16.1.133	0_saic_hypervisor_33 (Libvirt)	\N
237	1	Subnet	3	\N	Admin User	update	---\ndns_secondary:\n- \n- ''\nfrom:\n- \n- ''\nto:\n- \n- ''\nvlanid:\n- \n- ''\n	2	\N	\N	\N	2016-05-04 03:25:45.231492	172.16.1.133	saic-137 (10.128.137.0/24)	\N
238	1	Subnet	3	\N	Admin User	destroy	---\nnetwork: 10.128.137.0\nmask: 255.255.255.0\npriority: \nname: saic-137\nvlanid: ''\ndhcp_id: 1\ntftp_id: 1\ngateway: 10.128.137.1\ndns_primary: 114.114.114.114\ndns_secondary: ''\nfrom: ''\nto: ''\ndns_id: \nboot_mode: DHCP\nipam: DHCP\n	3	\N	\N	\N	2016-05-04 03:25:48.255505	172.16.1.133	saic-137 (10.128.137.0/24)	\N
239	1	Domain	3	\N	Admin User	destroy	---\nname: 137.saic.ustack.in\nfullname: saic\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-04 03:25:55.542101	172.16.1.133	137.saic.ustack.in	\N
240	1	SmartProxy	3	\N	Admin User	destroy	---\nname: saic-137\nurl: http://10.0.100.98:8443\n	3	\N	\N	\N	2016-05-04 03:26:02.38451	172.16.1.133	saic-137	\N
241	8	Medium	3	\N	Admin User	destroy	---\nname: saic-137\npath: http://10.128.137.30:8000/media/$major.$minor\nmedia_path: ''\nconfig_path: ''\nimage_path: ''\nos_family: Redhat\n	3	\N	\N	\N	2016-05-04 03:26:15.6056	172.16.1.133	saic-137	\N
242	3	Setting	3	\N	Admin User	update	---\nvalue:\n- \n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n	3	\N	\N	\N	2016-05-04 03:48:33.932494	172.16.1.133	foreman_url	\N
243	3	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n- ! '--- http://foreman.example.com\n\n  ...\n\n'\n	4	\N	\N	\N	2016-05-04 03:54:59.590968	172.16.1.133	foreman_url	\N
244	4	Setting	3	\N	Admin User	update	---\nvalue:\n- \n- ! '--- Foreman-noreply@foreman.example.com\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-04 03:55:12.136798	172.16.1.133	email_reply_address	\N
245	2	Setting	3	\N	Admin User	update	---\nvalue:\n- \n- ! '--- root@foreman.example.com\n\n  ...\n\n'\n	1	\N	\N	\N	2016-05-04 03:55:22.399722	172.16.1.133	administrator	\N
246	10	Hostgroup	3	\N	Admin User	create	---\nname: Storage\nenvironment_id: 1\noperatingsystem_id: 1\narchitecture_id: 1\nmedium_id: \nptable_id: 8\nroot_pass: ''\npuppet_ca_proxy_id: \nuse_image: \nimage_file: \nancestry: \nvm_defaults: \nsubnet_id: \ndomain_id: \npuppet_proxy_id: \nrealm_id: \ncompute_profile_id: \ngrub_pass: ''\n	1	\N	\N	\N	2016-05-04 03:58:43.267433	172.16.1.133	Storage	\N
257	18	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- LzNDphvHwFSteiRzpYXjbFzYfhuauMSp\n\n  ...\n\n'\n- ! '--- FZQ45BfSjidPK5eDGXWHpsSvogfQzLau\n\n  ...\n\n'\n	2	\N	\N	\N	2016-05-10 11:22:23.548685	\N	oauth_consumer_secret	\N
258	2	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:15:21.019896	10.0.100.98	100.ct.ustack.in	\N
259	2	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-10 12:16:56.517719	172.16.1.133	100.ct.ustack.in	\N
260	3	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:17:00.836213	10.0.100.98	100.ct.ustack.in	\N
261	3	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-10 12:19:21.117065	172.16.1.133	100.ct.ustack.in	\N
262	4	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:19:23.913866	10.0.100.98	100.ct.ustack.in	\N
263	4	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-10 12:19:44.789798	172.16.1.133	100.ct.ustack.in	\N
264	5	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:21:21.095429	10.0.100.98	100.ct.ustack.in	\N
265	5	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-10 12:21:49.662193	172.16.1.133	100.ct.ustack.in	\N
266	6	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:21:53.437853	10.0.100.98	100.ct.ustack.in	\N
267	6	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-10 12:26:26.092119	172.16.1.133	100.ct.ustack.in	\N
268	7	Domain	4	\N	api_post_user	create	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	1	\N	\N	\N	2016-05-10 12:26:28.560732	10.0.100.98	100.ct.ustack.in	\N
269	2	SmartProxy	4	\N	api_post_user	create	---\nname: ct-100\nurl: http://10.0.100.98:8443\n	1	\N	\N	\N	2016-05-10 12:30:49.280346	10.0.100.98	ct-100	\N
270	2	Subnet	4	\N	api_post_user	create	---\nnetwork: 10.0.100.0\nmask: 255.255.255.0\npriority: \nname: ct-100\nvlanid: \ndhcp_id: 2\ntftp_id: 2\ngateway: 10.0.100.1\ndns_primary: 114.114.114.114\ndns_secondary: \nfrom: \nto: \ndns_id: \nboot_mode: DHCP\nipam: DHCP\n	1	\N	\N	\N	2016-05-10 12:30:50.093359	10.0.100.98	ct-100 (10.0.100.0/24)	\N
271	9	Medium	4	\N	api_post_user	create	---\nname: ct-100\npath: http://10.0.100.98:8080/media/$major.$minor\nmedia_path: \nconfig_path: \nimage_path: \nos_family: Redhat\n	1	\N	\N	\N	2016-05-10 12:30:50.879248	10.0.100.98	ct-100	\N
272	28	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n- ! '--- http://foreman.ustack.com:3000\n\n  ...\n\n'\n	3	\N	\N	\N	2016-05-13 11:56:45.196866	172.16.1.133	unattended_url	\N
273	3	Setting	3	\N	Admin User	update	---\nvalue:\n- ! '--- http://foreman.ustack.com\n\n  ...\n\n'\n- ! '--- http://foreman.ustack.com:3000\n\n  ...\n\n'\n	6	\N	\N	\N	2016-05-13 11:57:14.225447	172.16.1.133	foreman_url	\N
274	43	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! '<%#\n\n  kind: snippet\n\n  name: puppet.conf\n\n  %>\n\n  [main]\n\n  <% if @host.operatingsystem.name == ''FreeBSD'' -%>\n\n  vardir = /var/puppet\n\n  logdir = \\$vardir/log\n\n  <% else -%>\n\n  vardir = /var/lib/puppet\n\n  logdir = /var/log/puppet\n\n  <% end -%>\n\n  rundir = /var/run/puppet\n\n  ssldir = \\$vardir/ssl\n\n\n  [agent]\n\n  pluginsync      = true\n\n  report          = true\n\n  ignoreschedules = true\n\n  daemon          = false\n\n  <%- if @host.puppet_ca_server.strip -%>\n\n  ca_server       = <%= @host.puppet_ca_server %>\n\n  <%- end -%>\n\n  certname        = <%= @host.certname %>\n\n  environment     = <%= @host.environment %>\n\n  server          = <%= @host.puppetmaster %>\n\n'\n- ! "<%#\\nkind: snippet\\nname: puppet.conf\\n%>\\n[main]\\n<% if @host.operatingsystem.name\n  == 'FreeBSD' -%>\\n    vardir = /var/puppet\\n    logdir = \\\\$vardir/log\\n<% else\n  -%>\\n    vardir = /var/lib/puppet\\n    logdir = /var/log/puppet\\n<% end -%>\\n    rundir\n  = /var/run/puppet\\n    ssldir = \\\\$vardir/ssl\\n    privatekeydir = \\\\$ssldir/private_keys\n  { group = service }\\n    hostprivkey = \\\\$privatekeydir/\\\\$certname.pem { mode =\n  640 }\\n    autosign       = \\\\$confdir/autosign.conf { mode = 664 }\\n    stringify_facts\n  = false\\n\\n[agent]\\n    classfile = \\\\$vardir/classes.txt\\n\\n    localconfig   =\n  \\\\$vardir/localconfig\\n    report        = true\\n    pluginsync    = true\\n    masterport\n  \\   = 8140\\n    environment   = <%= @host.environment %>\\n    server        = <%=\n  @host.params['puppet_master_domain'] %>\\n    listen        = false\\n    splay         =\n  true\\n    runinterval   = 9600\\n    noop          = false\\n    configtimeout = 1200"\n	1		\N	\N	2016-05-13 15:34:49.116426	172.16.1.133	puppet.conf	\N
275	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\ndeviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off'\\" >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv\n  --size=10000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader --location=mbr\n  --append='nofb quiet splash=quiet biosdevname=0 intel_iommu=off console=ttyS0' >\\"\n  >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home --vgname=ustack_pv --size=5000 --name=homevol\\"\n  >> /tmp-include\\necho \\"logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol\\"\n  >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger \\"Starting\n  anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n# /sbin/service\n  iptables save\\n\\n# puppet config\\npuppetmaster=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\\n#\n  and add the puppet package\\nyum -y install ntp ntpdate\\nyum -t -y -e 0 install puppet\\necho\n  \\"Configuring puppet\\"\\ncat > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\"\n  %>\\nEOF\\n\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most\n  things. Puppet will activate these if required.\\necho \\"Disabling various system\n  services\\"\\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf\n  xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd\n  hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail\n  cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nbash /var/reload_mod.sh\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho\n  'UseDNS no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\n\\nset_nic_init_script() {\\n    nic_new_name=$1\\n    nic_mac=$2\\n\n  \\   nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\neth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\n\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' |\n  awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ 'Compute' -eq 'Network' ];then\\n\n  \\       set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n        for\n  mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\"\n  | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n            set_nic_init_script\n  \\ ${new_name} $mac\\n            if [ $nic_seq_number -eq '2' ];then\\n                let\n  nic_seq_number=nic_seq_number+2\\n            else\\n                let nic_seq_number=nic_seq_number+1\\n\n  \\           fi\\n        done\\n    elif [ 'Compute' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\nset_nic_init_script\n  eth0 ${eth0_mac}\\nset_nic_init_script eth1 ${eth1_mac}\\nset_default_network eth0\\n\\nexit\n  0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n\\n# chkconfig\n  puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things. Puppet will activate\n  these if required.\\necho \\"Disabling various system services\\"\\n# <% %w{autofs gpm\n  sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig --level\n  345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail cups\n  iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS no' >> /etc/ssh/sshd_config\\nsed\n  -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho \\"Informing Foreman that\n  we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null --no-check-certificate\n  <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A linked\\ndeclare -A no_link\\ngen_nic_udev_rule()\n  {\\n    nic_mac_address=$1\\n    nic_device_name=$2\\n    echo 'SUBSYSTEM==\\"net\\",\n  ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\", ATTR{type}==\\"1\\",\n  KERNEL==\\"enp*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\nset_nic_init_script eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif\n  [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'\n  \\ '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule\n  eth1 ${eth1_mac}\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n	10		\N	\N	2016-05-13 15:38:14.446501	172.16.1.133	CentOS_7.1 Provision	\N
276	5	Parameter	3	\N	Admin User	create	---\nname: puppet_master_domain\nvalue: puppet.0.uc.ustack.in\nreference_id: \nhidden_value: false\n	1	\N	\N	\N	2016-05-13 15:38:44.636823	172.16.1.133	puppet_master_domain	\N
277	9	Medium	3	\N	Admin User	destroy	---\nname: ct-100\npath: http://10.0.100.98:8080/media/$major.$minor\nmedia_path: \nconfig_path: \nimage_path: \nos_family: Redhat\n	2	\N	\N	\N	2016-05-13 15:39:04.989106	172.16.1.133	ct-100	\N
278	2	Subnet	3	\N	Admin User	update	---\ndns_secondary:\n- \n- ''\nfrom:\n- \n- ''\nto:\n- \n- ''\nvlanid:\n- \n- ''\n	2	\N	\N	\N	2016-05-13 15:39:13.550204	172.16.1.133	ct-100 (10.0.100.0/24)	\N
279	2	Subnet	3	\N	Admin User	destroy	---\nnetwork: 10.0.100.0\nmask: 255.255.255.0\npriority: \nname: ct-100\nvlanid: ''\ndhcp_id: 2\ntftp_id: 2\ngateway: 10.0.100.1\ndns_primary: 114.114.114.114\ndns_secondary: ''\nfrom: ''\nto: ''\ndns_id: \nboot_mode: DHCP\nipam: DHCP\n	3	\N	\N	\N	2016-05-13 15:39:17.003247	172.16.1.133	ct-100 (10.0.100.0/24)	\N
280	7	Domain	3	\N	Admin User	destroy	---\nname: 100.ct.ustack.in\nfullname: ct\ndns_id: \nhosts_count: 0\nhostgroups_count: 0\n	2	\N	\N	\N	2016-05-13 15:39:22.166455	172.16.1.133	100.ct.ustack.in	\N
281	2	SmartProxy	3	\N	Admin User	destroy	---\nname: ct-100\nurl: http://10.0.100.98:8443\n	2	\N	\N	\N	2016-05-13 15:39:30.809385	172.16.1.133	ct-100	\N
282	17	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- c2hVZkkyoz2ShxiRFHQ92TkktG2W2uRN\n\n  ...\n\n'\n- ! '--- r3ziR7b6KCMdGiXqf9ufwNhuoShLqmBb\n\n  ...\n\n'\n	3	\N	\N	\N	2016-06-06 09:48:23.175482	\N	oauth_consumer_key	\N
283	18	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- FZQ45BfSjidPK5eDGXWHpsSvogfQzLau\n\n  ...\n\n'\n- ! '--- saiy7R4bWJPKwnhYX86aNTcXWiPcU7TJ\n\n  ...\n\n'\n	3	\N	\N	\N	2016-06-06 09:48:23.192553	\N	oauth_consumer_secret	\N
284	42	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/private_keys/server-98.100.ct.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/private_keys/server-101.100.ct.ustack.in.pem\n\n  ...\n\n'\n	2	\N	\N	\N	2016-06-06 09:48:23.362343	\N	websockets_ssl_key	\N
285	43	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/certs/server-98.100.ct.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/certs/server-101.100.ct.ustack.in.pem\n\n  ...\n\n'\n	2	\N	\N	\N	2016-06-06 09:48:23.378247	\N	websockets_ssl_cert	\N
286	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ UTC\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n\\n# chkconfig\n  puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things. Puppet will activate\n  these if required.\\necho \\"Disabling various system services\\"\\n# <% %w{autofs gpm\n  sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig --level\n  345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail cups\n  iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS no' >> /etc/ssh/sshd_config\\nsed\n  -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho \\"Informing Foreman that\n  we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null --no-check-certificate\n  <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A linked\\ndeclare -A no_link\\ngen_nic_udev_rule()\n  {\\n    nic_mac_address=$1\\n    nic_device_name=$2\\n    echo 'SUBSYSTEM==\\"net\\",\n  ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\", ATTR{type}==\\"1\\",\n  KERNEL==\\"enp*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\nset_nic_init_script eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif\n  [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'\n  \\ '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule\n  eth1 ${eth1_mac}\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ CST\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n\\n# chkconfig\n  puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things. Puppet will activate\n  these if required.\\necho \\"Disabling various system services\\"\\n# <% %w{autofs gpm\n  sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig --level\n  345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail cups\n  iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS no' >> /etc/ssh/sshd_config\\nsed\n  -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho \\"Informing Foreman that\n  we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null --no-check-certificate\n  <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A linked\\ndeclare -A no_link\\ngen_nic_udev_rule()\n  {\\n    nic_mac_address=$1\\n    nic_device_name=$2\\n    echo 'SUBSYSTEM==\\"net\\",\n  ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\", ATTR{type}==\\"1\\",\n  KERNEL==\\"enp*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\nset_nic_init_script eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif\n  [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'\n  \\ '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule\n  eth1 ${eth1_mac}\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n	11		\N	\N	2016-06-06 09:49:28.028061	172.16.1.86	CentOS_7.1 Provision	\N
287	17	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- r3ziR7b6KCMdGiXqf9ufwNhuoShLqmBb\n\n  ...\n\n'\n- ! '--- 2ybwSgTTvJ46WA9gyphhULFe8vQbJbsX\n\n  ...\n\n'\n	4	\N	\N	\N	2016-06-12 02:05:52.027056	\N	oauth_consumer_key	\N
288	18	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- saiy7R4bWJPKwnhYX86aNTcXWiPcU7TJ\n\n  ...\n\n'\n- ! '--- uVXXk5umQjubKfg8xngWZAZV3rnDQprn\n\n  ...\n\n'\n	4	\N	\N	\N	2016-06-12 02:05:52.045563	\N	oauth_consumer_secret	\N
289	42	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/private_keys/server-101.100.ct.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/private_keys/server-101.example.com.pem\n\n  ...\n\n'\n	3	\N	\N	\N	2016-06-12 02:05:52.217335	\N	websockets_ssl_key	\N
290	43	Setting	\N	\N	\N	update	---\nvalue:\n- ! '--- /var/lib/puppet/ssl/certs/server-101.100.ct.ustack.in.pem\n\n  ...\n\n'\n- ! '--- /var/lib/puppet/ssl/certs/server-101.example.com.pem\n\n  ...\n\n'\n	3	\N	\N	\N	2016-06-12 02:05:52.232908	\N	websockets_ssl_cert	\N
291	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ CST\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n\\n# chkconfig\n  puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things. Puppet will activate\n  these if required.\\necho \\"Disabling various system services\\"\\n# <% %w{autofs gpm\n  sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig --level\n  345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs gpm sendmail cups\n  iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth\n  openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd\n  yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable <%= service %>\n  2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate $proxy\\nntpdate\n  $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS no' >> /etc/ssh/sshd_config\\nsed\n  -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho \\"Informing Foreman that\n  we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null --no-check-certificate\n  <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A linked\\ndeclare -A no_link\\ngen_nic_udev_rule()\n  {\\n    nic_mac_address=$1\\n    nic_device_name=$2\\n    echo 'SUBSYSTEM==\\"net\\",\n  ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\", ATTR{type}==\\"1\\",\n  KERNEL==\\"enp*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' |sort| sed 's/ /\\\\n/g' | grep  -A 1 $eth0_mac | grep\n  -v $eth0_mac`\\nset_nic_init_script eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif\n  [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'\n  \\ '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule\n  eth1 ${eth1_mac}\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nnic_device_list=$(cat /proc/net/dev | grep\n  -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\" | awk\n  -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo $nic\\n\n  \\   ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a add 0\n  dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n\n  \\ eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\\n\n  \\ set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n	12		\N	\N	2016-06-13 07:13:43.843666	172.16.1.86	CentOS_7.1 Provision	\N
292	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw ^ustack$\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n\n  \\ eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\\n\n  \\ set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw  ObcRozf6\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n\n  \\ eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\\n\n  \\ set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n	13		\N	\N	2016-06-13 07:18:01.90431	172.16.1.86	CentOS_7.1 Provision	\N
293	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw  ObcRozf6\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\\n\n  \\   cat > ${nic_script_file} << EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\ngen_nic_udev_rule eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n\n  \\ eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\\n\n  \\ set_nic_init_script eth1 ${eth1_mac}\\n  gen_nic_udev_rule eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        gen_nic_udev_rule ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n\n  \\   done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network eth0\\n\\nexit 0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw  ObcRozf6\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\n  \\   gen_nic_udev_rule ${nic_new_name} ${nic_mac}\\n    cat > ${nic_script_file} <<\n  EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac}\n  | awk -F'[: ]+'  '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network\n  eth0\\n\\nexit 0\\n\\n\\n%end"\n	14		\N	\N	2016-06-13 09:26:31.912612	172.16.1.86	CentOS_7.1 Provision	\N
294	47	ConfigTemplate	3	\N	Admin User	update	---\ntemplate:\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw  ObcRozf6\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> puppet.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\n  \\   gen_nic_udev_rule ${nic_new_name} ${nic_mac}\\n    cat > ${nic_script_file} <<\n  EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac}\n  | awk -F'[: ]+'  '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network\n  eth0\\n\\nexit 0\\n\\n\\n%end"\n- ! "install\\n<%= @mediapath %>\\nlang en_US.UTF-8\\nselinux --disable\\nkeyboard us\\nskipx\\nnetwork\n  --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80\n  --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif\n  --onboot=on \\n%include /tmp/part-include\\nrootpw  ObcRozf6\\nfirewall --disabled\\ntimezone\n  \\ Asia/Shanghai\\n#bootloader --location=mbr --append=\\"nofb quiet splash=quiet biosdevname=0\n  intel_iommu=off\\" --md5pass=<%= root_pass %>\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet biosdevname=1 intel_iommu=off\\"\\n#bootloader --location=mbr --append=\\"nofb\n  quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off\\"\\n%include /tmp/bootloader.txt\\nauthconfig\n  \\ --useshadow  --passalgo=sha512\\nlogging --level=debug\\ntext\\nreboot\\n\\n%pre\\n#!/bin/bash\\nVIRTUAL=0\\nDISKS=`ls\n  /sys/block/ | grep sd`\\nVDISKS=`ls /sys/block/ | grep vd`\\nIS_SSD=0\\n\\ndmidecode\n  | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\\ndmesg\n  |grep \\"Booting paravirtualized kernel on KVM\\" && VIRTUAL=1\\ndmidecode | grep -i\n  'manufacturer' |grep VMware && VIRTUAL=1\\n\\nfor disk in $DISKS\\ndo\\n  IS_SSD=`cat\n  /sys/block/$disk/queue/rotational`\\n  SIZE=`cat /sys/block/$disk/size`\\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\\n\n  \\ if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\\n  then\\n      echo\n  \\"Compute\\" \\n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \\n  then\\n      echo\n  \\"RAID 10\\"\\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\\n  then\\n      echo \\"Ceph\\"\\n\n  \\ else\\n      echo $disk > /tmp/systemdisk\\n  fi\\ndone\\n\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^7:0:0:0'  | head -n1`\\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0'\n  | grep -v '^0:0' | head -n1`\\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep\n  dev | grep '0:0]'|sed 's/\\\\[\\\\(.*\\\\)\\\\].*/\\\\1/g' |head -n1`\\n#deviceID=`ls /sys/bus/scsi/devices/\n  | grep '^1' | head -n1`\\ndevicePath=\\"/sys/bus/scsi/devices\\"\\nif [[ ! -d $devicePath/$deviceID/block\n  ]]; then\\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\\nfi\\nls\n  $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\\n\\nfor disk in $VDISKS\\ndo\n  \\n   echo $disk > /tmp/systemdisk\\ndone\\n\\nfinaldisk=`cat /tmp/systemdisk`\\n#finaldisk='sda'\\necho\n  \\"zerombr\\" >> /tmp/part-include\\necho \\"clearpart --all --drives=$finaldisk\\" >>\n  /tmp/part-include\\necho \\"part /boot --size=1000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho\n  \\"part swap --size=4000 --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"part\n  pv.01 --size=20000 --grow --ondisk=$finaldisk\\" >> /tmp/part-include\\necho \\"volgroup\n  ustack_pv pv.01\\" >> /tmp/part-include\\nif [[ $VIRTUAL == 0 ]]\\nthen\\necho \\"logvol\n  / --vgname=ustack_pv --size=20000 --name=rootvol\\" >> /tmp/part-include\\necho \\"bootloader\n  --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'\\"\n  >> /tmp/bootloader.txt\\nelse\\necho \\"logvol / --vgname=ustack_pv --size=10000 --name=rootvol\\"\n  >> /tmp/part-include\\necho \\"bootloader --location=mbr --append='nofb quiet splash=quiet\n  intel_iommu=off console=ttyS0' >\\" >> /tmp/bootloader.txt\\nfi\\necho \\"logvol /home\n  --vgname=ustack_pv --size=5000 --name=homevol\\" >> /tmp-include\\necho \\"logvol /var\n  --vgname=ustack_pv --grow --size=5000 --name=varvol\\" >> /tmp/part-include\\n\\n%end\\n\\n%packages\\n@core\\n%end\\n\\n%post\\nlogger\n  \\"Starting anaconda <%= @host %> postinstall\\"\\n#/usr/bin/chvt 3\\n# iptables -F\\n#\n  /sbin/service iptables save\\n\\n# puppet config\\n#puppetmaster=`echo <%= @host.subnet.gateway\n  %> | cut -d \\".\\" -f1-3`\\".253\\"\\n\\nidc_region=`echo <%= @host.name %> | awk -F'.'\n  '{print $(NF-2)}'`\\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d \\".\\"\n  -f1-3`\\".249\\"\\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d \\".\\" -f1-3`\\".250\\"\\n\\necho\n  \\"<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>\\" >> /etc/hosts\\n#echo\n  \\"10.255.0.205 server-205.0.uc.ustack.in\\" >> /etc/hosts\\necho \\"<%= @host.params['yum_server']\n  %> mirrors.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['puppet_server']\n  %> <%= @host.params['puppet_master_domain'] %>\\" >> /etc/hosts\\necho \\"<%= @host.params['foreman_server']\n  %> foreman.ustack.com\\" >> /etc/hosts\\necho \\"<%= @host.params['ntp_server'] %>\n  ntp.0.uc.ustack.in\\" >> /etc/hosts\\n\\n#echo \\"<%= @host.ip %> <%= @host.name %>\n  <%= @host.shortname %>\\" >> /etc/hosts\\n# echo \\"10.255.0.205 server-205.0.uc.ustack.in\\"\n  >> /etc/hosts\\n#echo \\"10.255.0.61 mirrors.ustack.com\\" >> /etc/hosts\\n#echo \\"10.255.0.43\n  puppet.0.uc.ustack.in\\" >> /etc/hosts\\n\\ncat > /etc/resolv.conf << EOF\\nnameserver\n  10.255.0.80\\nEOF\\n\\nrm -rf /etc/yum.repos.d/*\\ncat > /etc/yum.repos.d/ustack.repo\n  << EOF \\n[openstack_liberity]\\n# openstack liberity\\nname=Packages for uStack base\n  - x86_64\\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\\nenabled=1\\ngpgcheck=0\\n\\n[uos-release]\\nname=uos\n  relaese\\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\\nenabled=1\\ngpgcheck=0\\nEOF\\n\\nyum\n  clean all\\nyum -y install uos-release\\nyum -y install kernel kernel-devel net-tools\n  ntp ntpdate vim puppet\\n# and add the puppet package\\necho \\"Configuring puppet\\"\\ncat\n  > /etc/puppet/puppet.conf << EOF\\n<%= snippets \\"puppet.conf\\" %>\\nEOF\\n<%= @host.puppetmaster\n  %>\\n# chkconfig puppet off\\nsystemctl disable puppet\\n\\n\\n# Disable most things.\n  Puppet will activate these if required.\\necho \\"Disabling various system services\\"\\n#\n  <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia\n  isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd\n  restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n#   /sbin/chkconfig\n  --level 345 <%= service %> off 2>/dev/null\\n# <% end -%>\\n<% %w{autofs NetworkManager\n  gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices\n  hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond\n  mcstrans rhnsd yum-updatesd}.each do |service| -%>\\n  /usr/bin/systemctl disable\n  <%= service %> 2>/dev/null\\n<% end -%>\\n\\nproxy=`echo <%= @host.subnet.gateway %>\n  | cut -d \\".\\" -f1-3`\\".251\\"\\n\\ncat > /etc/rc.local << EOF\\n#!/bin/bash\\nntpdate\n  $proxy\\nntpdate $proxy\\nexit 0\\nEOF\\nchmod +x /etc/rc.d/rc.local\\n\\necho 'UseDNS\n  no' >> /etc/ssh/sshd_config\\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\\n\\necho\n  \\"Informing Foreman that we are built\\"\\n#yum -y install wget\\n#wget -q -O /dev/null\n  --no-check-certificate <%= foreman_url %>\\ncurl <%= foreman_url %>\\n\\ndeclare -A\n  linked\\ndeclare -A no_link\\ngen_nic_udev_rule() {\\n    nic_device_name=$1\\n    nic_mac_address=$2\\n\n  \\   echo 'SUBSYSTEM==\\"net\\", ACTION==\\"add\\", DRIVERS==\\"?*\\", ATTR{address}==\\"'${nic_mac_address}'\\",\n  ATTR{type}==\\"1\\", KERNEL==\\"*\\", NAME=\\"'${nic_device_name}'\\"' >> /etc/udev/rules.d/70-persistent-net.rules\\n}\\n\\nset_nic_init_script()\n  {\\n    nic_new_name=$1\\n    nic_mac=$2\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}\\"\\n\n  \\   gen_nic_udev_rule ${nic_new_name} ${nic_mac}\\n    cat > ${nic_script_file} <<\n  EOF\\nDEVICE=${nic_new_name}\\nHWADDR=${nic_mac}\\nTYPE=Ethernet\\nONBOOT=yes\\nNM_CONTROLLED=no\\nBOOTPROTO=static\\nEOF\\n}\\nset_default_network()\n  {\\n    nic=$(echo $1 | tr -d ' ')\\n    nic_script_file=\\"/etc/sysconfig/network-scripts/ifcfg-${nic}\\"\\n\\n\n  \\   ip_netmask=<%= @host.subnet.mask %>\\n    ip_address=<%= @host.ip %>\\n    gateway_address=<%=\n  @host.subnet.gateway %>\\n    cat >> ${nic_script_file} << EOF\\nIPADDR=${ip_address}\\nNETMASK=${ip_netmask}\\nGATEWAY=${gateway_address}\\nEOF\\n}\\nrm\n  \\ -f /etc/sysconfig/network-scripts/ifcfg-*\\n\\n#eth0_mac=24:6e:96:06:85:24\\neth0_mac='<%=\n  @host.mac %>'\\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print\n  $2}'`\\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\\neth1_mac=`ifconfig -a | grep\n  $mac_pre | awk '{print $2}' | sort | sed -n \\"/$eth0_mac/,+1{//n;p}\\"`\\nset_nic_init_script\n  eth0 ${eth0_mac}\\n\\nif [ $eth1_mac ];then\\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac}\n  | awk -F'[: ]+'  '/mtu/{print $2}'`\\n  set_nic_init_script eth1 ${eth1_mac}\\n  nic_device_list=$(cat\n  /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}|${eth1_interface}\\"\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nelse\\n  nic_device_list=$(cat /proc/net/dev\n  | grep -v  -E 'face|Inter|lo' | grep -v -E \\"${eth0_interface}\\" | awk -F ':' '{print\n  $1}' | tr -d ' ')\\nfi\\n\\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo'\n  | awk -F ':' '{print $1}' | tr -d ' ')\\nfor nic in ${nic_device_list}\\ndo\\n    echo\n  $nic\\n    ifup ${nic}  > /dev/null 2>&1\\n    if [ $? -eq 1 ];then\\n        ip a\n  add 0 dev ${nic} > /dev/null 2>&1\\n    fi\\n    mac=$(ip a s ${nic} |  awk '/ether/{print\n  $2}')\\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\\n    if\n  [ $is_linked -eq 1 ];then\\n        linked[${mac}]=$nic\\n    else\\n        no_link[${mac}]=$nic\\n\n  \\   fi\\ndone\\nif [ ${#linked[@]} -eq 0 ];then\\n    nic_seq_number=2\\n    for mac\n  in $(echo ${!no_link[@]})\\n    do\\n        new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script\n  \\ ${new_name} $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n# has\n  problem\\nelif [ ${#linked[@]} -eq 1 ];then\\n    if [ '<%= @host.hostgroup %>' -eq\n  'Network' ];then\\n        set_nic_init_script eth3 ${!linked[@]}\\n        nic_seq_number=2\\n\n  \\       for mac in $(printf \\"%s\\\\n\\" \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            if [ $nic_seq_number\n  -eq '2' ];then\\n                let nic_seq_number=nic_seq_number+2\\n            else\\n\n  \\               let nic_seq_number=nic_seq_number+1\\n            fi\\n        done\\n\n  \\   elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\\n        set_nic_init_script\n  eth2 ${!linked[@]}\\n        nic_seq_number=3\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n            let nic_seq_number=nic_seq_number+1\\n\n  \\       done\\n    else\\n        nic_seq_number=2\\n        for mac in $(printf \\"%s\\\\n\\"\n  \\"${!no_link[@]}\\" | sort)\\n        do\\n            new_name=\\"eth${nic_seq_number}\\"\\n\n  \\           set_nic_init_script  ${new_name} $mac\\n        done\\n    fi\\nelif [\n  ${#linked[@]} -ge 2 ];then\\n    nic_seq_number=2\\n    for mac in $(printf \\"%s\\\\n\\"\n  \\"${!linked[@]}\\" | sort)  $(printf \\"%s\\\\n\\" \\"${!no_link[@]}\\" | sort)\\n    do\\n\n  \\       new_name=\\"eth${nic_seq_number}\\"\\n        set_nic_init_script  ${new_name}\n  $mac\\n        let nic_seq_number=nic_seq_number+1\\n    done\\n    echo ${!linked[@]}\\nfi\\n\\n\\nset_default_network\n  eth0\\n\\nexit 0\\n\\n\\n%end"\n	15		\N	\N	2016-06-14 12:53:11.965186	172.16.1.86	CentOS_7.1 Provision	\N
\.


--
-- Name: audits_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('audits_id_seq', 294, true);


--
-- Data for Name: auth_sources; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY auth_sources (id, type, name, host, port, account, account_password, base_dn, attr_login, attr_firstname, attr_lastname, attr_mail, onthefly_register, tls, created_at, updated_at, ldap_filter, attr_photo, server_type, groups_base, usergroup_sync) FROM stdin;
1	AuthSourceInternal	Internal	\N	\N	\N	\N	\N	\N	\N	\N	\N	f	f	2016-04-14 10:08:51.557289	2016-04-14 10:08:51.557289	\N	\N	posix	\N	t
2	AuthSourceHidden	Hidden	\N	\N	\N	\N	\N	\N	\N	\N	\N	f	f	2016-04-14 10:08:51.582733	2016-04-14 10:08:51.582733	\N	\N	posix	\N	t
\.


--
-- Name: auth_sources_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('auth_sources_id_seq', 2, true);


--
-- Data for Name: bookmarks; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY bookmarks (id, name, query, controller, public, owner_id, owner_type) FROM stdin;
1	eventful	eventful = true	reports	t	2	User
2	active	last_report > "35 minutes ago" and (status.applied > 0 or status.restarted > 0)	hosts	t	2	User
3	out of sync	last_report < "30 minutes ago" and status.enabled = true	hosts	t	2	User
4	error	last_report > "35 minutes ago" and (status.failed > 0 or status.failed_restarts > 0 or status.skipped > 0)	hosts	t	2	User
5	disabled	status.enabled = false	hosts	t	2	User
6	ok hosts	last_report > "35 minutes ago" and status.enabled = true and status.applied = 0 and status.failed = 0 and status.pending = 0	hosts	t	2	User
\.


--
-- Name: bookmarks_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('bookmarks_id_seq', 6, true);


--
-- Data for Name: cached_user_roles; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY cached_user_roles (id, user_id, role_id, user_role_id, created_at, updated_at) FROM stdin;
4	1	8	1	2016-04-14 10:09:08.063676	2016-04-14 10:09:08.063676
5	2	8	2	2016-04-14 10:09:08.114478	2016-04-14 10:09:08.114478
6	3	8	3	2016-04-14 10:09:08.119035	2016-04-14 10:09:08.119035
7	4	8	4	2016-04-14 10:47:50.471635	2016-04-14 10:47:50.471635
\.


--
-- Name: cached_user_roles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('cached_user_roles_id_seq', 7, true);


--
-- Data for Name: cached_usergroup_members; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY cached_usergroup_members (id, user_id, usergroup_id, created_at, updated_at) FROM stdin;
\.


--
-- Name: cached_usergroup_members_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('cached_usergroup_members_id_seq', 1, false);


--
-- Data for Name: compute_attributes; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY compute_attributes (id, compute_profile_id, compute_resource_id, name, vm_attrs, created_at, updated_at) FROM stdin;
\.


--
-- Name: compute_attributes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('compute_attributes_id_seq', 1, false);


--
-- Data for Name: compute_profiles; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY compute_profiles (id, name, created_at, updated_at) FROM stdin;
1	1-Small	2016-04-14 10:08:55.049447	2016-04-14 10:08:55.049447
2	2-Medium	2016-04-14 10:08:55.052564	2016-04-14 10:08:55.052564
3	3-Large	2016-04-14 10:08:55.054967	2016-04-14 10:08:55.054967
\.


--
-- Name: compute_profiles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('compute_profiles_id_seq', 3, true);


--
-- Data for Name: compute_resources; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY compute_resources (id, name, description, url, "user", password, uuid, type, created_at, updated_at, attrs) FROM stdin;
\.


--
-- Name: compute_resources_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('compute_resources_id_seq', 3, true);


--
-- Data for Name: config_group_classes; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY config_group_classes (id, puppetclass_id, config_group_id, created_at, updated_at) FROM stdin;
\.


--
-- Name: config_group_classes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('config_group_classes_id_seq', 1, false);


--
-- Data for Name: config_groups; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY config_groups (id, name, created_at, updated_at, hosts_count, hostgroups_count, config_group_classes_count) FROM stdin;
\.


--
-- Name: config_groups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('config_groups_id_seq', 1, false);


--
-- Data for Name: config_templates; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY config_templates (id, name, template, snippet, template_kind_id, created_at, updated_at, locked, "default", vendor) FROM stdin;
1	PXELinux global default	<%#\nkind: PXELinux\nname: PXELinux global default\n%>\n\n<%# This template has special name (do not change it) and it is used for booting unknown hosts. %>\n\nDEFAULT menu\nPROMPT 0\nMENU TITLE PXE Menu\nTIMEOUT 200\nTOTALTIMEOUT 6000\nONTIMEOUT local\n\nLABEL local\n     MENU LABEL (local)\n     MENU DEFAULT\n     LOCALBOOT 0\n\nLABEL discovery\n     MENU LABEL (discovery)\n     KERNEL boot/fdi-image/vmlinuz0\n     APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=https://FOREMAN_INSTANCE proxy.type=foreman\n     IPAPPEND 2\n\n<% for profile in @profiles -%>\nLABEL <%= "#{profile[:template]} - #{profile[:hostgroup]}" %>\n     KERNEL <%= profile[:hostgroup].operatingsystem.kernel(profile[:hostgroup].architecture) %>\n<% case profile[:hostgroup].operatingsystem.pxe_type -%>\n<% when 'kickstart' -%>\n     APPEND initrd=<%= profile[:hostgroup].operatingsystem.initrd(profile[:hostgroup].architecture) %> ks=<%= default_template_url(profile[:template], profile[:hostgroup]) %> ksdevice=bootif network kssendmac\n<% when 'preseed' -%>\n     APPEND initrd=<%= profile[:hostgroup].operatingsystem.initrd(profile[:hostgroup].architecture) %> interface=auto url=<%= default_template_url(profile[:template], profile[:hostgroup]) %> ramdisk_size=10800 root=/dev/rd/0 rw auto hostname=unassigned-hostname locale=<%= profile[:hostgroup].params['lang'] || 'en_US' %> console-setup/ask_detect=false console-setup/layout=USA console-setup/variant=USA\n<% end -%>\n\n<% end -%>\n	f	1	2016-04-14 10:08:54.49533	2016-04-14 10:08:54.49533	f	t	\N
2	PXELinux default local boot	<%#\nkind: PXELinux\nname: PXELinux default local boot\n%>\n\n<%# This template has special name (do not change it) and it is used for booting already provisioned hosts. %>\n\nDEFAULT menu\nPROMPT 0\nMENU TITLE PXE Menu\nTIMEOUT 200\nTOTALTIMEOUT 6000\nONTIMEOUT local\n\nLABEL local\n     MENU LABEL (local)\n     MENU DEFAULT\n     LOCALBOOT 0\n	f	1	2016-04-14 10:08:54.501982	2016-04-14 10:08:54.501982	f	t	\N
3	PXELinux default memdisk	<%#\nkind: PXELinux\nname: PXELinux default memdisk\noses:\n- FreeBSD (memdisk image)\n%>\nDEFAULT memdisk\n\nLABEL memdisk\n    KERNEL memdisk\n    APPEND initrd=<%= @initrd %> harddisk raw\n	f	1	2016-04-14 10:08:54.507263	2016-04-14 10:08:54.507263	f	t	\N
4	PXEGrub default local boot	<%#\nkind: PXEGrub\nname: PXEGrub default local boot\n%>\n\n<%# This template has special name (do not change it) and it is used for booting already provisioned hosts. %>\n\ndefault=0\ntimeout=1\ntitle Chainload into bootloader on first disk\nroot (hd0,0)\nchainloader +1\n	f	2	2016-04-14 10:08:54.512716	2016-04-14 10:08:54.512716	f	t	\N
5	Alterator default	<%#\nkind: provision\nname: Alterator default\noses:\n- ALTLinux p6\n- ALTLinux p7\n-%>\n<% if @metadata.to_s == '/vm-profile.scm' -%>\n<%= @host.diskLayout %>\n<% elsif @metadata.to_s == '/pkg-groups.tar' -%>\n<%= snippet 'alterator_pkglist' %>\n<% else -%>\n("/sysconfig-base/language" action "write" lang ("<%= @host.params['lang'] || 'en_US' %>"))\n("/sysconfig-base/kbd" action "write" layout "ctrl_shift_toggle")\n("/datetime-installer" action "write" commit #t name "RU" zone "Europe/Moscow" utc #t)\n("/evms/control" action "write" control open installer #t)\n("/evms/control" action "write" control update)\n("/evms/profiles/server" action apply commit #f clearall #t exclude ())\n("/evms/control" action "write" control commit)\n("/evms/control" action "write" control close)\n("/pkg-init" action "write")\n("/pkg-install" action "write" lists "<%= @host.params['pkg_list'] || '' %>" auto #t)\n("/preinstall" action "write")\n("/grub" action "write" language ("<%= @host.params['lang'] || 'en_US' %>") device "<%= @host.params['device'] || '/dev/sda' %>")\n("/net-eth" action "write" reset #t)\n("/net-eth" action "write" name "eth0" configuration "static" default "<%= @host.subnet.gateway %>" search "<%= @host.domain %>" dns "<%= @host.subnet.dns_primary %> <%= @host.subnet.dns_secondary %>" computer_name "<%= @host.name %>")\n("/net-eth" action "add_iface_address" name "eth0" addip "<%= @host.ip %>" addmask "<%= @host.subnet.mask %>")\n("/net-eth" action "write" commit #t)\n("/root/change_password" language (<%= @host.params['lang'] || 'en_US' %>") passwd_2 "123" passwd_1 "123")\n("/postinstall/firsttime" action "write" method "url" url "<%= foreman_url('finish') %>")\n<% end %>\n	f	4	2016-04-14 10:08:54.518296	2016-04-14 10:08:54.518296	f	t	\N
6	Alterator default finish	<%#\nkind: finish\nname: Alterator default finish\noses:\n- ALTLinux p6\n- ALTLinux p7\n-%>\n#!/bin/sh\n\n<%= snippet 'fix_hosts' %>\n\napt-get update >/dev/null 2>/dev/null\napt-get -y install puppet >/dev/null 2>/dev/null\n\n\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' -%>\nEOF\n\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag --server <%= @host.puppetmaster %> --no-daemonize\n/usr/bin/wget -q -O /dev/null --no-check-certificate <%= foreman_url %>\n/sbin/chkconfig puppetd on\n\nexit 0\n	f	5	2016-04-14 10:08:54.523669	2016-04-14 10:08:54.523669	f	t	\N
7	Alterator default PXELinux	<%#\nkind: PXELinux\nname: Alterator default PXELinux\noses:\n- ALTLinux p6\n- ALTLinux p7\n-%>\n<%#\n  This template will not function with Safemode set to true.\n    Please disable it in Settings > Provisioning\n%>\n<%\n    metadata    = @host.token.nil? ? '?metadata=' : '&metadata='\n    os          = @host.operatingsystem\n    mediumpath  = os.mediumpath @host\n-%>\nDEFAULT linux\n\nLABEL linux\n    KERNEL <%= @kernel %>\n    APPEND initrd=<%= @initrd %> stagename=altunat showopts ramdisk_size=150000 automatic=<%= mediumpath %>,directory:/altlinux/p<%= @host.operatingsystem.major %>/<%= @host.architecture %> ai curl=<%= foreman_url('provision')%><%= metadata %>\n\n	f	1	2016-04-14 10:08:54.528679	2016-04-14 10:08:54.528679	f	t	\N
8	AutoYaST default	<?xml version="1.0" encoding="UTF-8"?>\n<%#\nkind: provision\nname: AutoYaST default\n%>\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n%>\n<!DOCTYPE profile>\n<profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns">\n  <general>\n    <mode>\n      <confirm config:type="boolean">false</confirm>\n      <final_reboot config:type="boolean">true</final_reboot>\n    </mode>\n  </general>\n  <networking>\n    <dns>\n      <hostname><%= @host.name %></hostname>\n      <resolv_conf_policy>auto</resolv_conf_policy>\n<% if @host.domain -%>\n      <searchlist config:type="list">\n        <search><%= @host.domain %></search>\n      </searchlist>\n<% end -%>\n    </dns>\n    <interfaces config:type="list">\n      <interface>\n        <bootproto>dhcp</bootproto>\n        <device>eth0</device>\n        <startmode>auto</startmode>\n        <usercontrol>no</usercontrol>\n      </interface>\n    </interfaces>\n  </networking>\n  <ntp-client>\n    <configure_dhcp config:type="boolean">false</configure_dhcp>\n    <peers config:type="list">\n      <peer>\n        <address><%= @host.params['ntp-server'] || '0.opensuse.pool.ntp.org' %></address>\n        <initial_sync config:type="boolean">true</initial_sync>\n        <options></options>\n        <type>server</type>\n      </peer>\n    </peers>\n    <start_at_boot config:type="boolean">true</start_at_boot>\n    <start_in_chroot config:type="boolean">true</start_in_chroot>\n  </ntp-client>\n  <%= @host.diskLayout %>\n  <runlevel>\n    <default>3</default>\n    <services config:type="list">\n      <service>\n        <service_name>sshd</service_name>\n        <service_status>enable</service_status>\n      </service>\n    </services>\n  </runlevel>\n  <software>\n    <base>default</base>\n    <patterns config:type="list">\n      <pattern>base</pattern>\n      <pattern>enhanced_base</pattern>\n      <pattern>sw_management</pattern>\n      <pattern>yast2_basis</pattern>\n    </patterns>\n    <packages config:type="list">\n      <package>lsb-release</package>\n      <package>yast2-runlevel</package>\n<% if puppet_enabled -%>\n      <package>puppet</package>\n<% end -%>\n<% if salt_enabled %>\n      <package>salt-minion</package>\n<% end -%>\n    </packages>\n  </software>\n  <users config:type="list">\n    <user>\n      <username>root</username>\n      <encrypted config:type="boolean">true</encrypted>\n      <fullname>root</fullname>\n      <gid>0</gid>\n      <home>/root</home>\n      <shell>/bin/bash</shell>\n      <uid>0</uid>\n      <user_password><%= root_pass %></user_password>\n    </user>\n  </users>\n  <scripts>\n    <chroot-scripts config:type="list">\n      <script>\n        <filename>cp-resolv.sh</filename>\n        <chrooted config:type="boolean">false</chrooted>\n        <interpreter>shell</interpreter>\n        <notification>Copying resolv.conf into chroot ...</notification>\n        <source><![CDATA[\ncp /etc/resolv.conf /mnt/etc\n]]>\n        </source>\n      </script>\n      <script>\n        <filename>foreman.sh</filename>\n        <chrooted config:type="boolean">true</chrooted>\n        <interpreter>shell</interpreter>\n        <notification>Setting up Puppet / Foreman ...</notification>\n        <source><![CDATA[\n<% if puppet_enabled -%>\n          cat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' -%>\nEOF\nif [ -f "/etc/sysconfig/puppet" ]\nthen\n/usr/bin/sed -ie s/^PUPPET_SERVER=.*/PUPPET_SERVER=<%= @host.puppetmaster.blank? ? '' : @host.puppetmaster %>/ /etc/sysconfig/puppet\nfi\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n/sbin/chkconfig puppet on -f\n<% end -%>\n\n<% if salt_enabled %>\ncat > /etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\n# Setup salt-minion to run on system reboot\nchkconfig salt-minion on\n# Running salt-call to trigger key signing\nsalt-call --no-color --grains >/dev/null\n<% end -%>\n\n/usr/bin/curl -o /dev/null -k '<%= foreman_url %>'\n\nrm /etc/resolv.conf\n]]>\n        </source>\n      </script>\n    </chroot-scripts>\n  </scripts>\n  <keyboard>\n    <keymap>english-us</keymap>\n  </keyboard>\n  <timezone>\n    <hwclock>UTC</hwclock>\n    <timezone><%= @host.params['time-zone'] || 'Etc/UTC' %></timezone>\n  </timezone>\n</profile>\n	f	4	2016-04-14 10:08:54.535877	2016-04-14 10:08:54.535877	f	t	\N
9	AutoYaST SLES default	<?xml version="1.0" encoding="UTF-8"?>\n<%#\nkind: provision\nname: AutoYaST SLES default\noses:\n- SLES 11\n- SLES 12\n%>\n<%\n  # safemode renderer does not support unary negation\n  os_major = @host.operatingsystem.major.to_i\n  os_minor = @host.operatingsystem.minor.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n  sles_minor_string = (os_minor == 0) ? '' : "_SP#{os_minor}"\n  spacewalk_enabled = @host.params['spacewalk_host'] ? true : false\n%>\n<!DOCTYPE profile>\n<profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns">\n  <general>\n    <mode>\n      <confirm config:type="boolean">false</confirm>\n      <final_reboot config:type="boolean">true</final_reboot>\n    </mode>\n  </general>\n  <networking>\n    <dns>\n      <hostname><%= @host.name %></hostname>\n      <resolv_conf_policy>auto</resolv_conf_policy>\n<% if @host.domain -%>\n      <searchlist config:type="list">\n        <search><%= @host.domain %></search>\n      </searchlist>\n<% end -%>\n    </dns>\n    <interfaces config:type="list">\n      <interface>\n        <bootproto>dhcp</bootproto>\n        <device>eth0</device>\n        <startmode>auto</startmode>\n        <usercontrol>no</usercontrol>\n      </interface>\n    </interfaces>\n  </networking>\n  <ntp-client>\n    <configure_dhcp config:type="boolean">false</configure_dhcp>\n    <peers config:type="list">\n      <peer>\n        <address><%= @host.params['ntp-server'] || '0.opensuse.pool.ntp.org' %></address>\n        <initial_sync config:type="boolean">true</initial_sync>\n        <options></options>\n        <type>server</type>\n      </peer>\n    </peers>\n    <start_at_boot config:type="boolean">true</start_at_boot>\n    <start_in_chroot config:type="boolean">true</start_in_chroot>\n  </ntp-client>\n  <%= @host.diskLayout %>\n  <runlevel>\n    <default>3</default>\n    <services config:type="list">\n      <service>\n        <service_name>sshd</service_name>\n        <service_status>enable</service_status>\n      </service>\n    </services>\n  </runlevel>\n  <software>\n    <patterns config:type="list">\n      <pattern>Minimal</pattern>\n    </patterns>\n    <packages config:type="list">\n      <package>less</package>\n      <package>lsb-release</package>\n      <package>openssh</package>\n      <package>vim</package>\n<% if puppet_enabled -%>\n      <package>rubygem-puppet</package>\n<% end -%>\n<% if salt_enabled -%>\n      <package>salt-minion</package>\n<% end -%>\n<% if spacewalk_enabled -%>\n      <package>rhn-setup</package>\n<% end -%>\n    </packages>\n  </software>\n  <users config:type="list">\n    <user>\n      <username>root</username>\n      <encrypted config:type="boolean">true</encrypted>\n      <fullname>root</fullname>\n      <gid>0</gid>\n      <home>/root</home>\n      <shell>/bin/bash</shell>\n      <uid>0</uid>\n      <user_password><%= root_pass %></user_password>\n    </user>\n  </users>\n  <scripts>\n    <chroot-scripts config:type="list">\n      <script>\n        <filename>cp-resolv.sh</filename>\n        <chrooted config:type="boolean">false</chrooted>\n        <interpreter>shell</interpreter>\n        <notification>Copying resolv.conf into chroot ...</notification>\n        <source><![CDATA[\ncp /etc/resolv.conf /mnt/etc\n]]>\n        </source>\n      </script>\n      <script>\n        <filename>foreman.sh</filename>\n        <chrooted config:type="boolean">true</chrooted>\n        <interpreter>shell</interpreter>\n        <notification>Setting up Puppet / Foreman ...</notification>\n        <source><![CDATA[\n/bin/hostname <%= @host.name %>\n<% if puppet_enabled -%>\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' -%>\nEOF\nif [ -f "/etc/sysconfig/puppet" ]\nthen\n/usr/bin/sed -ie s/^PUPPET_SERVER=.*/PUPPET_SERVER=<%= @host.puppetmaster.blank? ? '' : @host.puppetmaster %>/ /etc/sysconfig/puppet\nfi\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n/sbin/chkconfig puppet on -f\n<% end -%>\n\n<% if salt_enabled %>\ncat > /etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\n# Setup salt-minion to run on system reboot\nchkconfig salt-minion on\n# Running salt-call to trigger key signing\nsalt-call --no-color --grains >/dev/null\n<% end -%>\n<% if spacewalk_enabled %>\n<%= snippet 'redhat_register' %>\n<% end -%>\n\n/usr/bin/curl -o /dev/null -k '<%= foreman_url %>'\n\nrm /etc/resolv.conf\n]]>\n        </source>\n      </script>\n    </chroot-scripts>\n  </scripts>\n  <keyboard>\n    <keymap>english-us</keymap>\n  </keyboard>\n  <timezone>\n    <hwclock>UTC</hwclock>\n    <timezone><%= @host.params['time-zone'] || 'Etc/UTC' %></timezone>\n  </timezone>\n  <add-on>\n    <add_on_products config:type="list">\n<% if puppet_enabled -%>\n      <listentry>\n        <media_url><![CDATA[http://download.opensuse.org/repositories/systemsmanagement:/puppet/SLE_<%= os_major %><%= sles_minor_string %>/]]></media_url>\n        <name>systemsmanagement_puppet</name>\n        <product>systemsmanagement_puppet</product>\n        <product_dir>/</product_dir>\n        <signature-handling>\n          <accept_non_trusted_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>2ABFA143A0E46E11</keyid>\n            </keys>\n          </accept_non_trusted_gpg_key>\n          <import_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>2ABFA143A0E46E11</keyid>\n            </keys>\n          </import_gpg_key>\n        </signature-handling>\n      </listentry>\n<% if os_major < 12 -%>\n      <listentry>\n        <media_url><![CDATA[http://download.opensuse.org/repositories/devel:languages:ruby:backports/SLE_<%= os_major %><%= sles_minor_string %>/]]></media_url>\n        <name>devel_languages_ruby_backports</name>\n        <product>devel_languages_ruby_backports</product>\n        <product_dir>/</product_dir>\n        <signature-handling>\n          <accept_non_trusted_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>9AF0C9A20E9AF123</keyid>\n            </keys>\n          </accept_non_trusted_gpg_key>\n          <import_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>9AF0C9A20E9AF123</keyid>\n            </keys>\n          </import_gpg_key>\n        </signature-handling>\n      </listentry>\n      <listentry>\n<!-- you have to update the next line with the actual URL of your SDK -->\n        <media_url>http://<your_server_here>/iso/suse/SDK/<%= os_major %>.<%= os_minor %>/<%= @host.architecture %>/</media_url>\n        <product>SuSE-Linux-SDK</product>\n        <product_dir>/</product_dir>\n        <name>SuSE-Linux-SDK</name>\n      </listentry>\n<% end -%>\n<% end -%>\n<% if salt_enabled %>\n      <listentry>\n        <media_url><![CDATA[http://download.opensuse.org/repositories/devel:languages:python/SLE_<%= os_major %><%= sles_minor_string %>/]]></media_url>\n        <name>devel_languages_python</name>\n        <product>devel_languages_python</product>\n        <product_dir>/</product_dir>\n        <signature-handling>\n          <accept_non_trusted_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>27163A4EEDF0D733</keyid>\n            </keys>\n          </accept_non_trusted_gpg_key>\n          <import_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>27163A4EEDF0D733</keyid>\n            </keys>\n          </import_gpg_key>\n        </signature-handling>\n      </listentry>\n<% end -%>\n<% if spacewalk_enabled %>\n      <listentry>\n        <media_url><![CDATA[http://download.opensuse.org/repositories/systemsmanagement:/spacewalk/SLE_<%= os_major %><%= sles_minor_string %>/]]></media_url>\n        <name>systemsmanagement_spacewalk</name>\n        <product>systemsmanagement_spacewalk</product>\n        <product_dir>/</product_dir>\n        <signature-handling>\n          <accept_non_trusted_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>2ABFA143A0E46E11</keyid>\n            </keys>\n          </accept_non_trusted_gpg_key>\n          <import_gpg_key>\n            <all config:type="boolean">false</all>\n            <keys config:type="list">\n              <keyid>2ABFA143A0E46E11</keyid>\n            </keys>\n          </import_gpg_key>\n        </signature-handling>\n      </listentry>\n<% end -%>\n    </add_on_products>\n  </add-on>\n</profile>\n	f	4	2016-04-14 10:08:54.542064	2016-04-14 10:08:54.542064	f	t	\N
10	AutoYaST default PXELinux	<%#\nkind: PXELinux\nname: AutoYaST default PXELinux\n%>\nDEFAULT linux\n\nLABEL linux\n    KERNEL <%= @kernel %>\n    APPEND initrd=<%= @initrd %> ramdisk_size=65536 install=<%= media_path %> autoyast=<%= foreman_url('provision') %> textmode=1\n	f	1	2016-04-14 10:08:54.54799	2016-04-14 10:08:54.54799	f	t	\N
11	CoreOS provision	#cloud-config\n<%#\nkind: provision\nname: CoreOS provision\noses:\n- CoreOS\n%>\ncoreos:\n  units:\n    - name: coreos-bootstrap.service\n      runtime: no\n      command: start\n      content: |\n        [Unit]\n        Description=Install coreos to disk\n        [Service]\n        ExecStart=/bin/bash -c "/usr/bin/coreos-install -C  <%= @host.operatingsystem.release_name %> -d <%= @host.params['install-disk'] || '/dev/sda' %> -c /home/core/cloud-config.yml <% if @host.operatingsystem.major >= "557" -%>-b <%= @mediapath %><% end -%>  && wget -q -O /dev/null --no-check-certificate <%= foreman_url %> && reboot"\n        [X-Fleet]\n        X-Conflicts=coreos-bootstrap.service\n<% if @host.params['ssh_authorized_keys'] -%>\nssh_authorized_keys:\n<% @host.params['ssh_authorized_keys'].split(',').map(&:strip).each do |ssh_key| -%>\n  - "<%= ssh_key %>"\n<% end -%>\n<% else -%>\nusers:\n  - name: core\n    passwd: <%= root_pass %>\n<% end -%>\nwrite_files:\n  - content: |\n      <%= snippet 'coreos_cloudconfig' %>\n    path: /home/core/cloud-config.yml\n    permissions: '0600'\n    owner: core:core\n	f	4	2016-04-14 10:08:54.553124	2016-04-14 10:08:54.553124	f	t	\N
12	CoreOS PXELinux	<%#\nkind: PXELinux\nname: CoreOS PXELinux\noses:\n- CoreOS\n%>\nDEFAULT coreos\n\nLABEL coreos\n    KERNEL <%= @kernel %>\n    APPEND initrd=<%= @initrd %> cloud-config-url=<%= foreman_url('provision')%>\n	f	1	2016-04-14 10:08:54.558043	2016-04-14 10:08:54.558043	f	t	\N
13	FreeBSD (mfsBSD) finish	<%#\nkind: finish\nname: FreeBSD (mfsBSD) finish\noses:\n- FreeBSD 10.0\n%>\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n  proxy_string = @host.params['http-proxy'] ? "http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}" : ''\n%>\nexport http_proxy='<%= proxy_string %>'\n/bin/echo '<%= root_pass %>' | pw usermod root -H 0\ncat >> /etc/rc.conf <<EOF\nhostname="<%= @host %>"\nsshd_enable="YES"\nntpd_enable="YES"\nEOF\n\necho ifconfig_`ifconfig -l | cut -d ' ' -f 1`=DHCP >>/etc/rc.conf\n\necho 'PermitRootLogin yes' >> /etc/ssh/sshd_config\n\ncp /usr/share/zoneinfo/<%= @host.params['time-zone'] || 'UTC' %> /etc/localtime\ntouch /etc/wall_cmos_clock\nadjkerntz -a\nntpdate <%= @host.params['ntp-server'] || '0.freebsd.pool.ntp.org' %>\nenv ASSUME_ALWAYS_YES=YES pkg bootstrap\n\n<% if puppet_enabled %>\npkg install -y puppet\necho 'puppet_enable="YES"' >>/etc/rc.conf\ncat > /usr/local/etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\n\n/usr/local/bin/puppet agent --config /usr/local/etc/puppet/puppet.conf --onetime --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n<% if salt_enabled %>\npkg install -y py27-salt\ncat > /usr/local/etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\necho 'salt_minion_enable="YES"' >>/etc/rc.conf\necho 'salt_minion_paths="/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin"' >>/etc/rc.conf\n# Running salt-call to trigger key signing\n/usr/local/bin/salt-call --no-color --grains >/dev/null\n<% end -%>\nexit 0\n	f	5	2016-04-14 10:08:54.563316	2016-04-14 10:08:54.563316	f	t	\N
14	FreeBSD (mfsBSD) provision	<%#\nkind: provision\nname: FreeBSD (mfsBSD) provision\noses:\n- FreeBSD 10.0\n%>\n<%\nproxy_string = @host.params['http-proxy'] ? "http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}" : ''\n%>\nexport http_proxy='<%= proxy_string %>'\n# Get the disk layout, and the first disk connected to the system\ndisk_layout=`/sbin/sysctl -n kern.disks | /usr/bin/sed 's/cd[0-9]//g'`\nfirst_disk="`echo ${disk_layout##*[1-9]} | /usr/bin/cut -d' ' -f1`"\ntest -z "$first_disk" || echo "First disk: $first_disk"\n\n/root/bin/destroygeom -d <%= @host.params['install-disk'] || '$first_disk' %> || exit 1\n/root/bin/zfsinstall -d <%= @host.params['install-disk'] || '$first_disk' %> -s 2G -u <%= @mediapath %> || exit 1\n\ncp /etc/resolv.conf /mnt/etc/resolv.conf\nmount -t devfs devfs /mnt/dev\nfetch -q --no-verify-hostname --no-verify-peer -o /mnt/tmp/finish.sh -d <%= foreman_url('finish') %>\nchroot /mnt /bin/sh /tmp/finish.sh\nrm /mnt/tmp/finish.sh\n\nfetch -q --no-verify-hostname --no-verify-peer -o /dev/null -d <%= foreman_url %>\nsleep 5\nreboot\n	f	4	2016-04-14 10:08:54.568874	2016-04-14 10:08:54.568874	f	t	\N
15	FreeBSD (mfsBSD) PXELinux	<%#\nkind: PXELinux\nname: FreeBSD (mfsBSD) PXELinux\noses:\n- FreeBSD 10.0\n%>\n# foreman_url=<%= foreman_url('provision') %>\nDEFAULT freebsd\n\nLABEL freebsd\n    KERNEL memdisk\n    APPEND initrd=<%= @initrd %> harddisk raw\n	f	1	2016-04-14 10:08:54.574261	2016-04-14 10:08:54.574261	f	t	\N
16	Grubby default	#!/bin/bash\n<%#\nkind: script\nname: Grubby default\n%>\n\nKERNEL="/boot/kernel"\nINITRD="/boot/initrd.img"\n\nwget -O "$KERNEL" "<%= @host.url_for_boot(:kernel) %>"\nwget -O "$INITRD" "<%= @host.url_for_boot(:initrd) %>"\n\ngrubby --add-kernel=$KERNEL --initrd=$INITRD  --copy-default --title "<%= @host.operatingsystem %>" --make-default  --args="ks=<%= foreman_url('provision')%>"\n	f	6	2016-04-14 10:08:54.579379	2016-04-14 10:08:54.579379	f	t	\N
17	Jumpstart default	<%#\nkind: provision\nname: Jumpstart default\n%>\ninstall_type <%= @install_type %>\npartitioning explicit\n<%= @disk %>\n<% if @host.use_image  -%>\narchive_location nfs <%=@archive_location%>\n<% else -%>\nsystem_type <%= @system_type %>\npackage <%= @packages %> add\ncluster <%= @cluster %>\n<% end -%>\n	f	4	2016-04-14 10:08:54.58468	2016-04-14 10:08:54.58468	f	t	\N
18	Jumpstart default finish	<%#\nkind: finish\nname: Jumpstart default finish\n%>\nlogger "Starting finish script"\n\n# Do not turn the machine off after 30 minutes. Very annoying!\n/bin/touch /noautoshutdown\n\n# Install the root password\n/usr/bin/perl -p -i -e 's/^root:[^:]+/root:<%= @host.root_pass.gsub('/', '\\/')-%>/' /etc/shadow\n\n# Root can ssh into this box. This is very useful while we rebuild this\n/usr/bin/perl -p -i -e "s/PermitRootLogin no/PermitRootLogin yes/" /etc/ssh/sshd_config\n\n# Now ensure that we have the newest puppet and facter installed\nmount /proc\n/usr/bin/cat /etc/mnttab | sed -e 's/\\/a/\\//' | sed -e 's/\\/a//' > /a/etc/mnttab\n/sbin/mount -F mntfs mnttab /etc/mnttab\n/usr/sbin/mknod /devices/pseudo/random@0:random c 190 0\n/usr/sbin/mknod /devices/pseudo/random@0:urandom c 190 1\n/usr/sbin/pkgadd -a /tmp/admin -d http://get.opencsw.org/now all\n/opt/csw/bin/pkgutil -U -y\n/opt/csw/bin/pkgutil -u -f -y CSWfacter CSWpuppet CSWwget\n\n/usr/bin/echo "Creating helper startup script to start puppet"\nONETIME=S99.enable.puppet\n/usr/bin/cat > /etc/rc3.d/$ONETIME << EOF\n#!/bin/sh\n#\n# $ONETIME\n#\n# runs once at startup and then removes itself.\n#\nPATH=/usr/bin:/usr/sbin; export PATH\n/usr/sbin/svccfg import /var/opt/csw/svc/manifest/network/cswpuppetd.xml\n/usr/sbin/svcadm enable svc:/network/cswpuppetd\nsleep 2\nrm \\$0\nEOF\n\n/usr/bin/echo "Configuring puppet"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' -%>\nEOF\n# The x86 version of the puppet package ignores the --config parameter. This should fix that and not hurt other installations\nif [ -f /etc/opt/csw/puppet/puppetd.conf ]\nthen\n    rm -f /etc/opt/csw/puppet/puppetd.conf\n    ln -s /etc/puppet/puppet.conf /etc/opt/csw/puppet/puppetd.conf\nfi\n/opt/csw/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag --server <%= @host.puppetmaster %> --no-daemonize\necho "Informing Foreman that we are built"\n/opt/csw/bin/wget --no-check-certificate -O /dev/null <%= foreman_url %>\nexit 0\n	f	5	2016-04-14 10:08:54.589845	2016-04-14 10:08:54.589845	f	t	\N
19	Jumpstart default PXEGrub	<%#\nkind: PXEGrub\nname: Jumpstart default PXEGrub\n%>\ndefault=0\ntimeout=10\ntitle Solaris_10 Jumpstart\n        kernel <%= multiboot %> kernel/unix - install dhcp nowin -B install_config=<%= jumpstart_path %>,sysid_config=<%= jumpstart_path %>/sysidcfg/sysidcfg_primary,install_media=<%= install_path %>,install_boot=<%= install_path %>/boot\n        module <%= miniroot %>\ntitle Solaris 10\n        findroot (rootfs0,0,a)\n        kernel$ /platform/i86pc/multiboot\n        module /platform/i86pc/boot_archive\n	f	2	2016-04-14 10:08:54.595225	2016-04-14 10:08:54.595225	f	t	\N
20	Kickstart default	<%#\nkind: provision\nname: Kickstart default\noses:\n- CentOS 4\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n%>\n<%#\nThis template accepts the following parameters:\n- lang: string (default="en_US.UTF-8")\n- keyboard: string (default="us")\n- time-zone: string (default="UTC")\n- http-proxy: string (default="")\n- http-proxy-port: string (default="")\n- force-puppet: boolean (default=false)\n- enable-puppetlabs-repo: boolean (default=false)\n- salt_master: string (default=undef)\n- ntp-server: string (default="0.fedora.pool.ntp.org")\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  realm_compatible = (@host.operatingsystem.name == 'Fedora' && os_major >= 20) || (rhel_compatible && os_major >= 7)\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  proxy_string = @host.params['http-proxy'] ? " --proxy=http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}" : ''\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %><%= proxy_string %>\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nselinux --enforcing\nkeyboard <%= @host.params['keyboard'] || 'us' %>\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : "static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select(&:present?).join(',')}" %> --device=<%= @host.mac -%> --hostname <%= @host %>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=sha256 --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n<% if rhel_compatible && os_major > 4 -%>\nservices --disabled gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd\n<% end -%>\n\n<% if realm_compatible && @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'Active Directory' -%>\nrealm join --one-time-password='<%= @host.otp %>' <%= @host.realm %>\n<% end -%>\n\n<% if @host.operatingsystem.name == 'Fedora' -%>\nrepo --name=fedora-everything --mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=fedora-<%= @host.operatingsystem.major %>&arch=<%= @host.architecture %><%= proxy_string %>\n<% if puppet_enabled && @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\nrepo --name=puppetlabs-products --baseurl=http://yum.puppetlabs.com/fedora/f<%= @host.operatingsystem.major %>/products/<%= @host.architecture %><%= proxy_string %>\nrepo --name=puppetlabs-deps --baseurl=http://yum.puppetlabs.com/fedora/f<%= @host.operatingsystem.major %>/dependencies/<%= @host.architecture %><%= proxy_string %>\n<% end -%>\n<% elsif rhel_compatible && os_major > 4 -%>\nrepo --name="EPEL" --mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-<%= @host.operatingsystem.major %>&arch=<%= @host.architecture %><%= proxy_string %>\n<% if puppet_enabled && @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\nrepo --name=puppetlabs-products --baseurl=http://yum.puppetlabs.com/el/<%= @host.operatingsystem.major %>/products/<%= @host.architecture %><%= proxy_string %>\nrepo --name=puppetlabs-deps --baseurl=http://yum.puppetlabs.com/el/<%= @host.operatingsystem.major %>/dependencies/<%= @host.architecture %><%= proxy_string %>\n<% end -%>\n<% end -%>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append="nofb quiet splash=quiet <%=ks_console%>" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append="nofb quiet splash=quiet" <%= grub_pass %>\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages\nyum\ndhclient\nntp\nwget\n@Core\n<% if os_major >= 6 -%>\nredhat-lsb-core\n<% end -%>\n<% if rhel_compatible && os_major > 4 -%>\nepel-release\n<% end -%>\n<% if puppet_enabled %>\npuppet\n<% if @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\npuppetlabs-release\n<% end -%>\n<% end -%>\n<% if salt_enabled %>\nsalt-minion\n<% end -%>\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n%post\nlogger "Starting anaconda <%= @host %> postinstall"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho "updating system time"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<% if chef_enabled %>\necho "Bootstraping chef"\n<%= respond_to?(:chef_bootstrap) ? chef_bootstrap(@host) : snippet_if_exists("chef-client omnibus bootstrap") %>\n<% end%>\n\n<% if puppet_enabled %>\necho "Configuring puppet"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\n\n# Setup puppet to run on system reboot\n/sbin/chkconfig --level 345 puppet on\n\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n<% if salt_enabled %>\ncat > /etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\n# Setup salt-minion to run on system reboot\n/sbin/chkconfig --level 345 salt-minion on\n# Running salt-call to trigger key signing\nsalt-call --no-color --grains >/dev/null\n<% end -%>\n\nsync\n\n# Inform the build system that we are done.\necho "Informing Foreman that we are built"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url %>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n	f	4	2016-04-14 10:08:54.600587	2016-04-14 10:08:54.600587	f	t	\N
21	Kickstart RHEL default	<%#\nkind: provision\nname: Kickstart RHEL default\noses:\n- RedHat 4\n- RedHat 5\n- RedHat 6\n- RedHat 7\n%>\n<%#\nThis template accepts the following parameters:\n- lang: string (default="en_US.UTF-8")\n- keyboard: string (default="us")\n- time-zone: string (default="UTC")\n- http-proxy: string (default="")\n- http-proxy-port: string (default="")\n- force-puppet: boolean (default=false)\n- enable-puppetlabs-repo: boolean (default=false)\n- salt_master: string (default=undef)\n- ntp-server: string (default="0.fedora.pool.ntp.org")\n%>\n<%\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  proxy_string = @host.params['http-proxy'] ? " --proxy=http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}" : ''\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n  section_end = os_major <= 5 ? '' : '%end'\n%>\ninstall\n<%= @mediapath %><%= proxy_string %>\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nselinux --enforcing\nkeyboard <%= @host.params['keyboard'] || 'us' %>\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n  <% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n  <% dhcp = !@static -%>\n<% end -%>\nnetwork --bootproto <%= dhcp ? 'dhcp' : "static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select(&:present?).join(',')}" %> --device=<%= @host.mac -%> --hostname <%= @host %>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=sha256 --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if os_major >= 7 && @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'Active Directory' -%>\nrealm join --one-time-password=<%= @host.otp %> <%= @host.realm %>\n<% end -%>\n\n<% if os_major > 4 -%>\nservices --disabled gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd\n\nrepo --name="EPEL" --mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-<%= @host.operatingsystem.major %>&arch=<%= @host.architecture %><%= proxy_string %>\n<% if puppet_enabled && @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\nrepo --name=puppetlabs-products --baseurl=http://yum.puppetlabs.com/el/<%= @host.operatingsystem.major %>/products/<%= @host.architecture %><%= proxy_string %>\nrepo --name=puppetlabs-deps --baseurl=http://yum.puppetlabs.com/el/<%= @host.operatingsystem.major %>/dependencies/<%= @host.architecture %><%= proxy_string %>\n<% end -%>\n<% end -%>\n\nbootloader --location=mbr --append="nofb quiet splash=quiet" <%= grub_pass %>\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages\nyum\ndhclient\nntp\nwget\n@Core\n<% if os_major >= 6 -%>\nredhat-lsb-core\n<% end -%>\nepel-release\n<% if puppet_enabled && @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\npuppetlabs-release\n<% end -%>\n<% if salt_enabled %>\nsalt-minion\n<% end -%>\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n%post\nlogger "Starting anaconda <%= @host %> postinstall"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho "updating system time"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet 'redhat_register' %>\n\n<% if @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<% if puppet_enabled %>\n# and add the puppet package\nyum -t -y -e 0 install puppet\n\necho "Configuring puppet"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\n\n# Setup puppet to run on system reboot\n/sbin/chkconfig --level 345 puppet on\n\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n<% if salt_enabled %>\ncat > /etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\n# Setup salt-minion to run on system reboot\n/sbin/chkconfig --level 345 salt-minion on\n# Running salt-call to trigger key signing\nsalt-call --no-color --grains >/dev/null\n<% end -%>\n\nsync\n\n# Inform the build system that we are done.\necho "Informing Foreman that we are built"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url %>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n	f	4	2016-04-14 10:08:54.606082	2016-04-14 10:08:54.606082	f	t	\N
22	Kickstart default finish	<%#\nkind: finish\nname: Kickstart default finish\noses:\n- CentOS 4\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n%>\n\n<% if @host.provision_method == 'image' && !root_pass.empty? -%>\n# Install the root password\necho 'root:<%= root_pass -%>' | /usr/sbin/chpasswd -e\n<% end -%>\n\n<% if rhel_compatible -%>\n<%= snippet 'epel' -%>\n<% end -%>\n\n<% if puppet_enabled -%>\n<% if @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\n<% if @host.operatingsystem.name == 'Fedora' -%>\nrpm -ivh http://yum.puppetlabs.com/puppetlabs-release-fedora-<%= os_major -%>.noarch.rpm\n<% else -%>\nrpm -ivh http://yum.puppetlabs.com/puppetlabs-release-el-<%= os_major -%>.noarch.rpm\n<% end -%>\n<% end -%>\nyum -t -y -e 0 install puppet\n<% end -%>\n\n#update local time\necho "updating system time"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<% if puppet_enabled %>\necho "Configuring puppet"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\n\n# Setup puppet to run on system reboot\n<% if @host.operatingsystem.name == 'Fedora' -%>\npuppet_unit=puppet\n/usr/bin/systemctl list-unit-files | grep -q puppetagent && puppet_unit=puppetagent\n/usr/bin/systemctl enable ${puppet_unit}\n<% else -%>\n/sbin/chkconfig --level 345 puppet on\n<% end -%>\n\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf -o --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\nexit 0\n	f	5	2016-04-14 10:08:54.611605	2016-04-14 10:08:54.611605	f	t	\N
23	Kickstart default PXELinux	<%#\nkind: PXELinux\nname: Kickstart default PXELinux\noses:\n- CentOS 4\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n- RedHat 4\n- RedHat 5\n- RedHat 6\n- RedHat 7\n%>\nDEFAULT linux\n\nLABEL linux\n    KERNEL <%= @kernel %>\n    <% if @host.operatingsystem.name == 'Fedora' and @host.operatingsystem.major.to_i > 16 -%>\n    APPEND initrd=<%= @initrd %> ks=<%= foreman_url('provision')%> ks.device=bootif network ks.sendmac\n    <% elsif @host.operatingsystem.name != 'Fedora' and @host.operatingsystem.major.to_i >= 7 -%>\n    APPEND initrd=<%= @initrd %> ks=<%= foreman_url('provision')%> network ks.sendmac\n    <% else -%>\n    APPEND initrd=<%= @initrd %> ks=<%= foreman_url('provision')%> ksdevice=bootif network kssendmac\n    <% end -%>\n    IPAPPEND 2\n	f	1	2016-04-14 10:08:54.616794	2016-04-14 10:08:54.616794	f	t	\N
24	Kickstart default iPXE	#!gpxe\n<%#\nkind: iPXE\nname: Kickstart default iPXE\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n- RedHat 5\n- RedHat 6\n- RedHat 7\n%>\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) && subnet.dhcp_boot_mode? -%>\n  <% static = '' -%>\n<% else -%>\n  <% static_arg = 'static=yes' -%>\n  <% static = (@host.token.nil? ? '?' : '&') + static_arg -%>\n<% end -%>\n\n<%# This template will not function with Safemode set to true.\n    Please disable it in Settings > Provisioning               %>\n\nkernel <%= "#{@host.url_for_boot(:kernel)}" %> ks=<%= foreman_url('provision')%><%= static %> ksdevice=<%= @host.mac %> network kssendmac ip=${netX/ip} netmask=${netX/netmask} gateway=${netX/gateway} dns=${dns}\ninitrd <%= "#{@host.url_for_boot(:initrd)}" %>\n\nboot\n	f	3	2016-04-14 10:08:54.622222	2016-04-14 10:08:54.622222	f	t	\N
25	Kickstart default user data	<%#\nkind: user_data\nname: Kickstart default user data\noses:\n- CentOS 4\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n-%>\n#!/bin/bash\n\n<%# Cloud instances frequently have incorrect hosts data %>\n<%= snippet 'fix_hosts' %>\n\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n%>\n<% if puppet_enabled %>\nyum install -y puppet\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\n\n# Setup puppet to run on system reboot\n/sbin/chkconfig --level 345 puppet on\n\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf --onetime --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n# UserData still needs wget to mark as finished\n/usr/bin/wget --quiet --output-document=/dev/null --no-check-certificate <%= foreman_url('built') %>\n	f	7	2016-04-14 10:08:54.627788	2016-04-14 10:08:54.627788	f	t	\N
26	Preseed default	<%#\nkind: provision\nname: Preseed default\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n- Ubuntu 14.04\n%>\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  proxy_string = @host.params['http-proxy'] ? " http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}" : ''\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n%>\n# Locale\nd-i debian-installer/locale string <%= @host.params['lang'] || 'en_US' %>\n# country and keyboard settings are automatic. Keep them ...\n# ... for wheezy and newer:\nd-i keyboard-configuration/xkb-keymap seen true\n# ... for squeeze and older:\nd-i console-keymaps-at/keymap seen true\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n  <% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n  <% dhcp = !@static -%>\n<% end -%>\n<% unless dhcp -%>\n# Static network configuration.\nd-i preseed/early_command string /bin/killall.sh; /bin/netcfg\nd-i netcfg/disable_dhcp boolean true\nd-i netcfg/get_ipaddress string <%= @host.ip %>\nd-i netcfg/get_netmask string <%= subnet.mask %>\nd-i netcfg/get_nameservers string <%= [subnet.dns_primary,subnet.dns_secondary].reject{|n| n.blank?}.join(' ') %>\nd-i netcfg/get_gateway string <%= subnet.gateway %>\nd-i netcfg/confirm_static boolean true\n<% end -%>\n\n# Network configuration\nd-i netcfg/choose_interface select auto\nd-i netcfg/get_hostname string <%= @host %>\nd-i netcfg/get_domain string <%= @host.domain %>\nd-i netcfg/wireless_wep string\n\nd-i hw-detect/load_firmware boolean true\n\n# Mirror settings\nd-i mirror/country string manual\nd-i mirror/http/hostname string <%= @preseed_server %>\nd-i mirror/http/directory string <%= @preseed_path %>\nd-i mirror/http/proxy string<%= proxy_string %>\nd-i mirror/codename string <%= @host.operatingsystem.release_name %>\nd-i mirror/suite string <%= @host.operatingsystem.release_name %>\nd-i mirror/udeb/suite string <%= @host.operatingsystem.release_name %>\n\n# Time settings\nd-i clock-setup/utc boolean true\nd-i time/zone string <%= @host.params['time-zone'] || 'UTC' %>\n\n# NTP\nd-i clock-setup/ntp boolean true\nd-i clock-setup/ntp-server string <%= @host.params['ntp-server'] || '0.debian.pool.ntp.org' %>\n\n# Set alignment for automatic partitioning\n# Choices: cylinder, minimal, optimal\n#d-i partman/alignment select cylinder\n\n<%= @host.diskLayout %>\n\n# Install different kernel\n#d-i base-installer/kernel/image string linux-server\n\n# User settings\nd-i passwd/root-password-crypted password <%= root_pass %>\nuser-setup-udeb passwd/root-login boolean true\nd-i passwd passwd/make-user boolean false\nuser-setup-udeb passwd/make-user boolean false\n\n<% repos = 0 %>\n<% if puppet_enabled && @host.params['enable-puppetlabs-repo'] && @host.params['enable-puppetlabs-repo'] == 'true' -%>\n# Puppetlabs products\nd-i apt-setup/local<%= repos %>/repository string \\\n      http://apt.puppetlabs.com <%= @host.operatingsystem.release_name %> main\nd-i apt-setup/local<%= repos %>/comment string Puppetlabs products\nd-i apt-setup/local<%= repos %>/source boolean true\nd-i apt-setup/local<%= repos %>/key string http://apt.puppetlabs.com/pubkey.gpg\n<% repos += 1 -%>\n# Puppetlabs dependencies\nd-i apt-setup/local<%= repos %>/repository string \\\n      http://apt.puppetlabs.com <%= @host.operatingsystem.release_name %> dependencies\nd-i apt-setup/local<%= repos %>/comment string Puppetlabs dependencies\nd-i apt-setup/local<%= repos %>/source boolean true\nd-i apt-setup/local<%= repos %>/key string http://apt.puppetlabs.com/pubkey.gpg\n<% repos += 1 -%>\n<% end -%>\n\n<% if salt_enabled -%>\n<% salt_package = 'salt-minion' -%>\n<% if @host.params['enable-saltstack-repo'] && @host.params['enable-saltstack-repo'] == 'true' -%>\n<% if @host.operatingsystem.name == 'Debian' -%>\nd-i apt-setup/local<%= repos %>/repository string http://debian.saltstack.com/debian <%= @host.operatingsystem.release_name %>-saltstack main\nd-i apt-setup/local<%= repos %>/comment string SaltStack Repository\nd-i apt-setup/local<%= repos %>/key string http://debian.saltstack.com/debian-salt-team-joehealy.gpg.key\n<% repos += 1 -%>\n<% end -%>\n<% if @host.operatingsystem.name == 'Ubuntu' -%>\nd-i apt-setup/local<%= repos %>/repository string http://ppa.launchpad.net/saltstack/salt/ubuntu <%= @host.operatingsystem.release_name %> main\nd-i apt-setup/local<%= repos %>/comment string SaltStack Repository\nd-i apt-setup/local<%= repos %>/key string http://keyserver.ubuntu.com/pks/lookup?op=get&search=0x4759FA960E27C0A6\n<% repos += 1 -%>\n<% end -%>\n<% end -%>\n<% else -%>\n<% salt_package = '' -%>\n<% end -%>\n\n# Install minimal task set (see tasksel --task-packages minimal)\ntasksel tasksel/first multiselect minimal, ssh-server, openssh-server\n\n<% if puppet_enabled %>\n  <% if @host.operatingsystem.name == 'Ubuntu' and @host.operatingsystem.major.to_i == 10 -%>\n    <% puppet_package = 'puppet/lucid-backports' -%>\nd-i apt-setup/backports boolean true\n  <% else -%>\n    <% puppet_package = 'puppet' -%>\n  <% end -%>\n<% else -%>\n  <% puppet_package = '' -%>\n<% end -%>\n\n# Install some base packages\nd-i pkgsel/include string <%= puppet_package %> <%= salt_package %> lsb-release\nd-i pkgsel/update-policy select unattended-upgrades\n\npopularity-contest popularity-contest/participate boolean false\n\n# Boot loader settings\n#grub-pc grub-pc/hidden_timeout boolean false\n#grub-pc grub-pc/timeout string 10\nd-i grub-installer/only_debian boolean true\nd-i grub-installer/with_other_os boolean true\n<% if @host.params['install-disk'] -%>\nd-i grub-installer/bootdev string <%= @host.params['install-disk'] %>\n<% elsif @host.operatingsystem.name == 'Debian' and @host.operatingsystem.major.to_i >= 8 -%>\nd-i grub-installer/bootdev string default\n<% end -%>\nd-i finish-install/reboot_in_progress note\n\nd-i preseed/late_command string wget -Y off <%= @static ? "'#{foreman_url('finish')}&static=true'" : foreman_url('finish') %> -O /target/tmp/finish.sh && in-target chmod +x /tmp/finish.sh && in-target /tmp/finish.sh\n	f	4	2016-04-14 10:08:54.63301	2016-04-14 10:08:54.63301	f	t	\N
27	Preseed default finish	<%#\nkind: finish\nname: Preseed default finish\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n- Ubuntu 14.04\n%>\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n  <% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n  <% dhcp = !@static -%>\n<% end -%>\n<% unless dhcp -%>\n# host and domain name need setting as these values may have come from dhcp if pxe booting\n/bin/sed -i "s/^search.*$/search <%= @host.domain %>/g" /etc/resolv.conf\n/bin/sed -i "s/.*dns-search.*/\\tdns-search <%= @host.domain %>/g" /etc/network/interfaces\n/bin/sed -i "s/^<%= @host.ip %>.*/<%= @host.ip %>\\t<%= @host.shortname %>.<%= @host.domain %>\\t<%= @host.shortname %>/g" /etc/hosts\n/bin/echo <%= @host.shortname %> > /etc/hostname\n<% end -%>\n<% if puppet_enabled %>\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\nif [ -f "/etc/default/puppet" ]\nthen\n/bin/sed -i 's/^START=no/START=yes/' /etc/default/puppet\nfi\n/bin/touch /etc/puppet/namespaceauth.conf\n/usr/bin/puppet agent --enable\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf --onetime --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n<% if @host.info['parameters']['realm'] && @host.otp && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n<% if salt_enabled %>\ncat > /etc/salt/minion << EOF\n<%= snippet 'saltstack_minion' %>\nEOF\n# Running salt-call to trigger key signing\nsalt-call --no-color --grains >/dev/null\n<% end -%>\n\n<% if chef_enabled %>\n<%= respond_to?(:chef_bootstrap) ? chef_bootstrap(@host) : snippet_if_exists("chef-client omnibus bootstrap") %>\n<% end%>\n\n/usr/bin/wget --no-proxy --quiet --output-document=/dev/null --no-check-certificate <%= foreman_url %>\n	f	5	2016-04-14 10:08:54.638501	2016-04-14 10:08:54.638501	f	t	\N
28	Preseed default PXELinux	<%#\nkind: PXELinux\nname: Preseed default PXELinux\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n- Ubuntu 14.04\n%>\n\n<% if @host.operatingsystem.name == 'Debian' -%>\n<% keyboard_params = "auto=true domain=#{@host.domain}" -%>\n<% else -%>\n<% keyboard_params = 'console-setup/ask_detect=false console-setup/layout=USA console-setup/variant=USA keyboard-configuration/layoutcode=us localechooser/translation/warn-light=true localechooser/translation/warn-severe=true' -%>\n<% end -%>\nDEFAULT linux\n\nLABEL linux\n    KERNEL <%= @kernel %>\n    APPEND initrd=<%= @initrd %> interface=auto url=<%= foreman_url('provision')%> ramdisk_size=10800 root=/dev/rd/0 rw auto hostname=<%= @host.name %> <%= keyboard_params %> locale=<%= @host.params['lang'] || 'en_US' %>\n    IPAPPEND 2\n	f	1	2016-04-14 10:08:54.643906	2016-04-14 10:08:54.643906	f	t	\N
29	Preseed default iPXE	#!gpxe\n<%#\nkind: iPXE\nname: Preseed default iPXE\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 12.04\n- Ubuntu 14.04\n%>\n<% if @host.operatingsystem.name == 'Debian' -%>\n<% keyboard_params = "auto=true domain=#{@host.domain}" -%>\n<% else -%>\n<% keyboard_params = 'console-setup/ask_detect=false console-setup/layout=USA console-setup/variant=USA keyboard-configuration/layoutcode=us' -%>\n<% end -%>\n<% kernel, initrd = @host.operatingsystem.boot_files_uri(@host.medium,@host.architecture) -%>\n<% static = @host.token.nil? ? '?static=yes' : '&static=yes' -%>\n\n<%# This template will not function with Safemode set to true.\n    Please disable it in Settings > Provisioning               %>\n\nkernel <%= kernel %> interface=auto url=<%= foreman_url('provision')%><%= static %> ramdisk_size=10800 root=/dev/rd/0 rw auto netcfg/disable_dhcp=true BOOTIF=${netX/mac} hostname=<%= @host.name %> <%= keyboard_params %> locale=<%= @host.params['lang'] || 'en_US' %> netcfg/get_ipaddress=${netX/ip} netcfg/get_netmask=${netX/netmask} netcfg/get_gateway=${netX/gateway} netcfg/get_nameservers=${dns} netcfg/confirm_static=true\ninitrd <%= initrd %>\n\nboot\n	f	3	2016-04-14 10:08:54.649293	2016-04-14 10:08:54.649293	f	t	\N
30	Preseed default user data	<%#\nkind: user_data\nname: Preseed default user data\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 12.04\n- Ubuntu 14.04\n-%>\n#!/bin/bash\n\n<%# Cloud instances frequently have incorrect hosts data %>\n<%= snippet 'fix_hosts' %>\n\n<%\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet'] && @host.params['force-puppet'] == 'true'\n%>\n<% if puppet_enabled %>\napt-get update\napt-get install -y puppet\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet 'puppet.conf' %>\nEOF\nif [ -f "/etc/default/puppet" ]\nthen\n/bin/sed -i 's/^START=no/START=yes/' /etc/default/puppet\nfi\n/bin/touch /etc/puppet/namespaceauth.conf\n/usr/bin/puppet agent --enable\n/usr/bin/puppet agent --config /etc/puppet/puppet.conf --onetime --tags no_such_tag <%= @host.puppetmaster.blank? ? '' : "--server #{@host.puppetmaster}" %> --no-daemonize\n<% end -%>\n\n# UserData still needs wget to mark as finished\n/usr/bin/wget --quiet --output-document=/dev/null --no-check-certificate <%= foreman_url('built') %>\n	f	7	2016-04-14 10:08:54.65442	2016-04-14 10:08:54.65442	f	t	\N
31	UserData default	<%#\nkind: user_data\nname: UserData default\noses:\n- CentOS 4\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Debian 6.0\n- Debian 7.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\n<%# Contact Foreman to confirm instance is built -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\n	f	7	2016-04-14 10:08:54.659579	2016-04-14 10:08:54.659579	f	t	\N
32	WAIK default PXELinux	<%#\nkind: PXELinux\nname: WAIK default PXELinux\n%>\nDEFAULT winPE\n\nLABEL winPE\n    KERNEL /Boot/startrom.0\n	f	1	2016-04-14 10:08:54.668289	2016-04-14 10:08:54.668289	f	t	\N
33	Junos default SLAX	<%#\nkind: provision\nname: Junos default SLAX\n-%>\nversion 1.0;\n\n/* ------------------------------------------------------------------\n * LICENSE\n * ------------------------------------------------------------------\n *\n * Copyright (c) 2013, Juniper Networks\n *\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met: \n *\n * (1) Redistributions of source code must retain the above copyright notice, this \n * list of conditions and the following disclaimer. \n *\n * (2) Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution. \n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * The views and conclusions contained in the software and documentation are those\n * of the authors and should not be interpreted as representing official policies, \n * either expressed or implied, of Juniper Networks.\n * \n *\n * ------------------------------------------------------------------\n * AUTHORS AND CONTRIBUTORS\n * ------------------------------------------------------------------\n *\n * Jeremy Schulman, Juniper Networks\n * - initial release (https://github.com/jeremyschulman/jctyztp/)\n *\n * Frank Wall, noris network AG\n * - adapt for integration in The Foreman\n * - fix compatibility with older Junos releases\n * \n *\n * ------------------------------------------------------------------\n * LIMITATIONS\n * ------------------------------------------------------------------\n *\n * To maintain backwards compatibility with JunOS 11.x (and maybe \n * even 10.x) you MUST AVOID all of these:\n * - global variable $junos-context (introduced with Junos 11.1)\n * - mutable variables (introduced with JunOS 12.2 -> SLAX 1.1)\n * - native functions (introduced with JunOS 12.2 -> SLAX 1.1)\n *\n * ------------------------------------------------------------------\n */\n\n/* ------------------------------------------------------------------ */\n/* XML namespaces                                                     */\n/* ------------------------------------------------------------------ */\n\n/* Juniper */\nns junos = "http://xml.juniper.net/junos/*/junos";\nns xnm = "http://xml.juniper.net/xnm/1.1/xnm";\nns jcs = "http://xml.juniper.net/junos/commit-scripts/1.0";\nns ztp = "http://xml.juniper.net/junos/ztp";\n\n/* EXSLT */\nns exsl extension = "http://exslt.org/common";\nns func extension = "http://exslt.org/functions";\nns str extension = "http://exslt.org/strings";\n\n/* private namespace for this script */\nns jctyztp = "http://xml.juniper.com/jctyztp/1.0";\nns fmztp = "http://xml.juniper.com/fmztp/1.0";\n\n/* depending on Junos version relative path may be broken */\n/* import '../import/junos.xsl'; */\nimport '/usr/libdata/cscript/import/junos.xsl';\n\n/* ------------------------------------------------------------------ */\n/* Script parameters                                                  */\n/* ------------------------------------------------------------------ */\n\nparam $server = 'ztpserver';\nparam $mediapath = '<%= @mediapath %>';\n\n/* ------------------------------------------------------------------ */\n/* Constants                                                          */\n/* ------------------------------------------------------------------ */\n\nvar $APPNAME = 'foreman-ztp';\nvar $SYSLOG = 'user.info';\nvar $TMPDIR = '/var/tmp';\nvar $JUNOS_CONF = '/var/tmp/junos.conf';\n\nvar $ZTP_GROUP_NAME = "fmztp";\nvar $ZTP_MACRO_NAME = "conf";\nvar $ZTP_LOCKFILE = '/tmp/fmztp.lock';\n\n/* ------------------------------------------------------------------ */\n/* Global variables                                                   */\n/* ------------------------------------------------------------------ */\n\n/* Open a connection to the device API */\nvar $jnx = jcs:open();\n\n/* ------------------------------------------------------------------ */\n/*                                MAIN                                */ \n/* ------------------------------------------------------------------ */\n\nmatch / {\n\n  /* Terminate on connection error */\n  if(not( $jnx )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ":ERROR: unable to connect to Junos API");\n    expr fmztp:terminate();\n  }\n  \n  var $running = fmztp:only_once();\n  if( $running ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": start op script: already running, exiting..." );\n    <xsl:message terminate="yes">;\n  }\n  \n  /* if the $JUNOS_CONF file is not on the device, then */\n  /* download it from the server */\n  if(not( fmztp:file-exists( $JUNOS_CONF ))) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": obtaining device config file");\n    var $cp = fmztp:dl_junos_conf();\n  }\n  \n  /* now load $JUNOS_CONF into the candidate configuration so we can */\n  /* extract the ZTP config */\n  var $ztp_conf = fmztp:ld_junos_conf();\n  var $has_version = $ztp_conf/has_version;\n  var $new_package = $ztp_conf/package;\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": preparing update from ", $has_version, " to ", $new_package );\n  \n  /* if we have a version difference, then we will install the new OS */\n  /* and reboot the device.  the $JUNOS_CONF file will be loaded on */\n  /* after the install process completes */\n  if( $ztp_conf/install ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": Junos install required" );\n    var $os = fmztp:install_os( $ztp_conf );\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": rebooting in 60 seconds" );\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": SCRIPT-END");\n    expr fmztp:reboot( 1 );\n    expr jcs:close( $jnx );\n  }\n  else {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": no Junos install required" );\n    /* puppet agent is only supported on Junos 12.3R2.5 */\n    if( jcs:regex( "12.3R2.5", $ztp_conf/has_version )) {\n\texpr jcs:syslog( $SYSLOG, $APPNAME, ": puppet agent install required" );\n\tvar $puppet = fmztp:install_puppet( $ztp_conf );\n    }\n    else {\n\texpr jcs:syslog( $SYSLOG, $APPNAME, ": os version is ", $has_version, ", but puppet agent is only available on 12.3R2.5" );\n    }\n    var $fini = fmztp:finalize();\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": SCRIPT-END");\n    expr jcs:close( $jnx );\n  }\n}\n\n/* ------------------------------------------------------------------ */\n/* HTTP Junos configuration file onto the device                      */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:dl_junos_conf">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": downloading new Junos conf...");\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": URL: ", '<%= foreman_url('finish') %>');\n\n  var $get = <file-copy> {\n    <source> '<%= foreman_url('finish') %>';\n    <destination> $JUNOS_CONF;\n    <staging-directory> $TMPDIR;\n  };\n\n  var $got = jcs:execute( $jnx, $get );\n\n  if(not( fmztp:file-exists( $JUNOS_CONF ))) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ":ERROR: unable to find new Junos conf at ", $JUNOS_CONF);\n    expr fmztp:terminate();\n  }\n\n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Load the $JUNOS_CONF file into the candidate config and extract    */\n/* the ZTP config from the [edit groups] area.  Do *NOT* commit       */\n/* this configuration yet, since we may need to install the OS first  */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:ld_junos_conf">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": loading new Junos conf...");\n\n  /* get the current version from the configuration file */\n  \n  var $get_cur_ver = <get-configuration database='committed'> { <configuration> { <version>; }};\n  var $got_cur_ver = jcs:execute( $jnx, $get_cur_ver );\n\n  /* now load the configuration file we got from the ztp server */\n  var $do_load = <load-configuration action="override" url=$JUNOS_CONF format="text">;\n  var $did_load = jcs:execute( $jnx, $do_load );\n  if(not( $did_load/load-success )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ":ERROR: unable to load config ", $JUNOS_CONF );\n    expr fmztp:terminate();\n  }\n  \n  expr jcs:syslog( $SYSLOG, $APPNAME, ": extracting Junos config parameters...");\n  var $get = <get-configuration> { <configuration> {\n    <version>;\n    <groups> { <name> $ZTP_GROUP_NAME;\n      <apply-macro> { <name> $ZTP_MACRO_NAME;\n      }\n    }\n  }};\n  \n  var $got = jcs:execute( $jnx, $get );\n\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": package: ", $got//data[name = 'package']/value);\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": URL: ", $mediapath);\n\n  /* create a node-set to store the following elements             */\n  /* has_version = current Junos version string                    */\n  /* package = filename of Junos package (*.tgz)                   */\n  /* mediapath = URL where package is obtained from                */\n  /* install = present if a install is requeired                   */\n  var $ver = $got_cur_ver/version;\n  var $package = $got//data[name = 'package']/value;\n  var $puppet = $got//data[name = 'puppet']/value;\n  var $conf := {\n    <has_version> $ver; \n    <package> $package;\n    <puppet> $puppet;\n    <url> $mediapath;\n    if(not( jcs:regex( $ver, $package ))) {\n      <install>;\n    }\n  }\n\n  /* @@@ should put some trap here on ensuring that the config */\n  /* @@@ file actually had the correct group/macro defined */\n    \n  <func:result select="$conf">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Junos Software Installation - download the software from the HTTP  */\n/* server and perform the 'request system software add' operation     */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:install_os">\n{\n  param $ztp_conf;\n\n  var $local_image = $TMPDIR _ "/" _ $ztp_conf/package;\n  \n  if( fmztp:file-exists( $local_image )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": junos image exists, no download needed" );\n  }\n  else {\n  \n    /* request system storage cleanup */\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": cleaning filesystem" );\n    var $clean = jcs:execute( $jnx, 'request-system-storage-cleanup' ); \n\n    /* file copy .... */\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": downloading junos image..." );    \n    expr jcs:syslog( $SYSLOG, $APPNAME, ": URL: ", $ztp_conf/url, $ztp_conf/package );\n    var $do_copy = <file-copy> {\n      <source> $ztp_conf/url _ $ztp_conf/package;\n      <destination> $TMPDIR;\n      <staging-directory> $TMPDIR;\n    };\n    var $did_copy = jcs:execute( $jnx, $do_copy );\n    \n    /* trap error here */\n    if( not(fmztp:file-exists( $local_image )) ) {\n        expr jcs:syslog( $SYSLOG, $APPNAME, ": ERROR: unable to download junos image" );\n        expr fmztp:terminate();\n    }\n  }\n  \n  /* request system software add ... */\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": installing junos image" );    \n  var $do_install = <request-package-add> {\n    <no-validate>;\n    <package-name> $local_image;\n  };\n  var $did_install = jcs:execute( $jnx, $do_install );\n  /* @@@ need to trap error here on $did_install */\n  \n  expr jcs:syslog( $SYSLOG, $APPNAME, ": completed installing junos image" );\n   \n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Reboot the device given a delay, in minutes                        */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:reboot">\n{\n  param $in_min;\n\n  var $do_reboot = <request-reboot> { <in> $in_min; };\n  var $did_reboot = jcs:execute( $jnx, $do_reboot );\n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Puppet Agent Installation - download the software from the HTTP    */\n/* server and perform the 'request system software add' operation     */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:install_puppet">\n{\n  param $ztp_conf;\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": starting puppet installation..." );\n\n  if (fmztp:is-installed("puppet")) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": package puppet is already installed" );\n    <func:result select="true()">;\n  }\n\n  var $local_image = $TMPDIR _ "/" _ $ztp_conf/puppet;\n  \n  if( fmztp:file-exists( $local_image )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": package puppet exists, no download needed" );\n  }\n  else {\n  \n    /* request system storage cleanup */\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": cleaning filesystem" );\n    var $clean = jcs:execute( $jnx, 'request-system-storage-cleanup' ); \n\n    /* file copy .... */\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": downloading puppet image..." );    \n    expr jcs:syslog( $SYSLOG, $APPNAME, ": URL: ", $ztp_conf/url, $ztp_conf/puppet );    \n    var $do_copy = <file-copy> {\n      <source> $ztp_conf/url _ $ztp_conf/puppet;\n      <destination> $TMPDIR;\n      <staging-directory> $TMPDIR;\n    };\n    var $did_copy = jcs:execute( $jnx, $do_copy );\n    \n    /* trap error on $did_copy */\n    if( not(fmztp:file-exists( $local_image )) ) {\n      expr jcs:syslog( $SYSLOG, $APPNAME, ": ERROR: failed to download puppet image" );\n      expr fmztp:terminate();\n    }\n  }\n\n  /* request system software add ... */\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": installing puppet image" );    \n  var $do_install = <request-package-add> {\n    <no-validate>;\n    <package-name> $local_image;\n  };\n  var $did_install = jcs:execute( $jnx, $do_install );\n  \n  /* NOTE: To complete the puppet installation you need to take manual steps, see:\n   *       http://www.juniper.net/techpubs/en_US/release-independent/junos-puppet/information-products/pathway-pages/index.html\n   */\n\n  /* validate installation */\n  if (not(fmztp:is-installed("puppet"))) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": ERROR: failed to install package puppet" );\n    expr fmztp:terminate();\n  }\n\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": completed installing puppet image" );\n   \n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Finalize the ZTP process; i.e. after the OS is correct.  Remove    */\n/* the $JUNOS_CONF file and committing the configuration to make      */\n/* it active.                                                         */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:finalize">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": deleting temp config file...");  \n  var $rm1 = fmztp:file-delete( $JUNOS_CONF );\n\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": sending finish signal to foreman...");  \n  var $do_foreman = <file-copy> {\n      <source> '<%= foreman_url %>';\n      <destination> "/tmp";\n      <staging-directory> "/tmp";\n  };\n  var $did_foreman = jcs:execute( $jnx, $do_foreman );\n\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": deleting ztp lock file...");  \n  var $rm2 = fmztp:file-delete( $ZTP_LOCKFILE );\n\n  /* commit the configuration that was previously loaded */  \n  expr jcs:syslog( $SYSLOG, $APPNAME, ": committing configuration...");  \n  var $commit = jcs:execute( $jnx, 'commit-configuration' );\n  if( $commit//self::xnm:error ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, ":ERROR: unable to commit configuration: ", $commit//self::xnm:error/message );\n    var $die = fmztp:terminate();\n  }\n\n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Helper routine: check to see if a file exists on the device,       */\n/* returns [ true | false ]                                           */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:file-exists">\n{\n  param $filename;\n  var $ls_file = <file-list> { <path> $filename; };\n  var $ls_got = jcs:execute( $jnx, $ls_file );\n  var $retval = boolean( $ls_got//file-information );\n\n  <func:result select="$retval">;\n}\n\n<func:function name="fmztp:file-delete">\n{\n  param $filename;\n  var $do_rm = <file-delete> { <path> $filename; };\n  var $did_rm = jcs:execute( $jnx, $do_rm );\n  /* @@@ trap error */\n  \n  <func:result select="true()">;\n}\n\n/* ------------------------------------------------------------------ */\n/* Helper routine: create a lockfile to make sure the script only     */\n/* runs once, and terminate if it is already running.                 */\n/* returns [ true | false ]                                           */\n/* ------------------------------------------------------------------ */\n\n<func:function name="fmztp:only_once">\n{\n  if( fmztp:file-exists( $ZTP_LOCKFILE )) {\n    <func:result select="true()">;\n  }\n  else {\n    var $do_lock = <file-put> {\n      <filename> $ZTP_LOCKFILE;\n      <encoding> 'ascii';\n      <file-contents> 'locked';\n    };\n    var $did_lock = jcs:execute( $jnx, $do_lock );\n    <func:result select="false()">;\n  }\n}\n\n<func:function name="fmztp:terminate">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, ": SCRIPT-FAILED" );\n  var $rm_lock = fmztp:file-delete( $ZTP_LOCKFILE );\n  <xsl:message terminate="yes">;\n}\n\n/* ------------------------------------------------- */\n/* check if software package is installed            */\n/* ------------------------------------------------- */\n<func:function name="fmztp:is-installed">\n{\n  param $string;\n\n  var $do_query = <get-software-information>;\n  var $did_query = jcs:execute( $jnx, $do_query );\n\n  if( jcs:regex( $string, $did_query )) {\n    expr jcs:output("package found: ", $string);\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": package found: ", $string);\n    <func:result select="true()">;\n  }\n  else {\n    expr jcs:output("package NOT found: ", $string);\n    expr jcs:syslog( $SYSLOG, $APPNAME, ": package NOT found: ", $string);\n    <func:result select="false()">;\n  }\n}\n	f	4	2016-04-14 10:08:54.673809	2016-04-14 10:08:54.673809	f	t	\N
34	Junos default ZTP config	<%#\nkind: ZTP\nname: Junos default ZTP config\n-%>\nsystem {\n    host-name <%= @host.shortname %>;\n    root-authentication {\n      encrypted-password "<%= root_pass %>"; ## SECRET-DATA\n    }\n    services {\n        ssh;\n        netconf {\n            ssh;\n        }\n    }\n    syslog {\n        user * {\n            any emergency;\n            user info;\n        }\n        file messages {\n            any notice;\n            authorization info;\n        }\n        console {\n            user info;\n        }\n    }\n}\ninterfaces {\n    vme {\n        unit 0 {\n            family inet {\n                dhcp;\n            }\n        }\n    }\n}\nevent-options {\n    generate-event {\n        fmztp time-interval 90;\n    }\n    policy fmztp {\n        events fmztp;\n        then {\n            execute-commands {\n                commands {\n                    "op url <%= foreman_url('provision')%>.slax";\n                }\n            }\n        }\n    }\n}\nprotocols {\n    igmp-snooping {\n        vlan all;\n    }\n    rstp;\n    lldp {\n        interface all;\n    }\n    lldp-med {\n        interface all;\n    }\n}\nethernet-switching-options {\n    storm-control {\n        interface all;\n    }\n}\n	f	8	2016-04-14 10:08:54.68024	2016-04-14 10:08:54.68024	f	t	\N
35	Junos default finish	<%#\nkind: finish\nname: Junos default finish\n-%>\nsystem {\n    host-name <%= @host %>;\n    time-zone <%= @host.params['time-zone'] || 'Etc/UTC' %>;\n    root-authentication {\n        encrypted-password "<%= root_pass %>"; ## SECRET-DATA\n    }\n    name-server {\n        <%= @host.subnet.dns_primary || '8.8.8.8' %>;\n        <% if @host.subnet.dns_secondary -%>\n        <%= @host.subnet.dns_secondary %>;\n        <% end -%>\n    }\n    ntp {\n        boot-server <%= @host.params['ntp-server'] || '0.pool.ntp.org' %>;\n        server <%= @host.params['ntp-server'] || '0.pool.ntp.org' %>;\n    }\n    login {\n        message "This device was provisioned by using The Foreman!\\nSee http://theforeman.org/ for further information.\\n";\n        class automation {\n            permissions all;\n        }\n        user puppet {\n            uid 2001;\n            class automation;\n            authentication {\n                encrypted-password "<%= root_pass %>"; ## SECRET-DATA\n            }\n            shell csh;\n        }\n    }\n    services {\n        ssh {\n            protocol-version v2;\n        }\n        netconf {\n            ssh;\n        }\n    }\n    syslog {\n        user * {\n            any emergency;\n        }\n        file messages {\n            any notice;\n            authorization info;\n        }\n        file interactive-commands {\n            interactive-commands any;\n        }\n    }\n    ntp {\n        boot-server 0.pool.ntp.org;\n        server 0.pool.ntp.org;\n        server 1.pool.ntp.org;\n    }\n    extensions {\n        providers {\n            juniper {\n                license-type juniper deployment-scope commercial;\n            }\n        }\n    }\n}\nchassis {\n    alarm {\n        management-ethernet {\n            link-down ignore;\n        }\n    }\n}\ninterfaces {\n    interface-range ACCESS-PORT {\n        member ge-0/0/0;\n        unit 0 {\n            family ethernet-switching {\n                port-mode access;\n            }\n        }\n    }\n    interface-range UPLINK-PORT {\n        member ge-0/0/47;\n        unit 0 {\n            family ethernet-switching {\n                port-mode trunk;\n                vlan {\n                    members all;\n                }\n            }\n        }\n    }\n    vlan {\n        unit 37 {\n            family inet;\n        }\n    }\n    vme {\n        unit 0 {\n            family inet {\n                dhcp;\n            }\n        }\n    }\n}\nprotocols {\n    igmp-snooping {\n        vlan all;\n    }\n    rstp;\n    lldp {\n        interface all;\n    }\n    lldp-med {\n        interface all;\n    }\n}\nethernet-switching-options {\n    storm-control {\n        interface all;\n    }\n    bpdu-block {\n        interface ACCESS-PORT;\n        disable-timeout 120;\n    }\n}\nvlans {\n    testlan {\n        vlan-id 37;\n        l3-interface vlan.37;\n    }\n}\ngroups {\n    fmztp {\n        apply-macro conf {\n            package jinstall-ex-4200-<%= @host.operatingsystem.major %>R<%= @host.operatingsystem.minor %>-domestic-signed.tgz;\n            puppet jpuppet-ex-1.0R1.1.tgz;\n        }\n    }\n}\n	f	5	2016-04-14 10:08:54.685673	2016-04-14 10:08:54.685673	f	t	\N
36	alterator_pkglist	<%#\nkind: snippet\nname: alterator_pkglist\n-%>\n<%# \n  This template will not function with Safemode set to true. \n%>\n<%= Net::HTTP.get(URI.parse("#{@mediapath}/Metadata/pkg-groups.tar")) %>\n	t	\N	2016-04-14 10:08:54.756765	2016-04-14 10:08:54.756765	f	t	\N
37	coreos_cloudconfig	#cloud-config\n<%#\nkind: snippet\nname: coreos_cloudconfig\n%>\n      coreos:\n        etcd:\n<% if @host.params['etcd_discovery_url'] -%>\n          discovery: <%= @host.params['etcd_discovery_url'] %>\n<% end -%>\n          addr: <%= @host.ip %>:4001\n          peer-addr: <%= @host.ip %>:7001\n        units:\n          - name: etcd.service\n            command: start\n          - name: fleet.service\n            command: start\n          - name: docker-tcp.socket\n            command: start\n            enable: yes\n            content: |\n              [Unit]\n              Description=Docker Socket for the API\n              \n              [Socket]\n              ListenStream=2375\n              BindIPv6Only=both\n              Service=docker.service\n              \n              [Install]\n              WantedBy=sockets.target\n          - name: enable-docker-tcp.service\n            command: start\n            content: |\n              [Unit]\n              Description=Enable the Docker Socket for the API\n              \n              [Service]\n              Type=oneshot\n              ExecStart=/usr/bin/systemctl enable docker-tcp.socket\n<% if @host.params['ssh_authorized_keys'] -%>\n      ssh_authorized_keys:\n  <% @host.params['ssh_authorized_keys'].split(',').map(&:strip).each do |ssh_key| -%>\n      - "<%= ssh_key %>"\n  <% end -%>\n<% else -%>\n      users:\n        - name: core\n          passwd: <%= root_pass %>\n<% end -%>\n	t	\N	2016-04-14 10:08:54.762697	2016-04-14 10:08:54.762697	f	t	\N
38	epel	<%#\nkind: snippet\nname: epel\n%>\n\nsu -c 'rpm -Uvh <%= @host.os.medium_uri(@host, "http://dl.fedoraproject.org/pub/epel/epel-release-latest-#{@host.operatingsystem.major}.noarch.rpm") %>'\n	t	\N	2016-04-14 10:08:54.767964	2016-04-14 10:08:54.767964	f	t	\N
39	fix_hosts	<%#\nkind: snippet\nname: fix_hosts\n%>\necho "<%= @host.shortname %>" > /etc/hostname\nhostname <%= @host.shortname %>\ncat > /etc/hosts << EOF\n<%# simple snippet to generate /etc/hosts when provisioning image based systems -%>\n127.0.0.1   <%= @host %> <%= @host.shortname %> localhost localhost.localdomain\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\nEOF\n	t	\N	2016-04-14 10:08:54.773177	2016-04-14 10:08:54.773177	f	t	\N
40	freeipa_register	<%#\nkind: snippet\nname: freeipa_register\n%>\n# FreeIPA Registration Snippet\n#\n# Optional parameters:\n#\n#   freeipa_server              IPA server\n#\n#   freeipa_sudo                Enable sudoers\n#                               Default: true\n#\n#   freeipa_ssh                 Enable ssh integration\n#                               Default: true\n#\n#   freeipa_automount           Enable automounter\n#                               Default: false\n#\n#   freeipa_automount_location  Location for automounts\n#\n#   freeipa_mkhomedir           Enable automatically making home directories\n#                               Default: true\n#\n#   freeipa_opts                Additional options to pass directly to installer\n#\n<% if @host.operatingsystem.family == 'Redhat' -%>\n  <% if @host.operatingsystem.name == 'Fedora' -%>\n    freeipa_client=freeipa-client\n  <% else -%>\n    freeipa_client=ipa-client\n  <% end -%>\n<% else -%>\n  freeipa_client=freeipa-client\n<% end -%>\n\n<%= @host.operatingsystem.family == 'Redhat' ? 'yum install -y libsss_sudo' : 'apt-get install -y libsss-sudo' %> $freeipa_client\n\n##\n## IPA Client Installation\n##\n\n<% if @host.params['freeipa_server'] -%>\nfreeipa_server="--server <%= @host.params['freeipa_server'] %>"\n<% end -%>\n\n<% unless @host.param_false? 'freeipa_mkhomedir' %>\nfreeipa_mkhomedir="--mkhomedir"\n<% end -%>\n\n<% if @host.param_false? 'freeipa_ssh' %>\nfreeipa_ssh="--no-ssh"\n<% end -%>\n\n<% if @host.params['freeipa_opts'] -%>\nfreeipa_opts="<%= @host.params['freeipa_opts'] %>"\n<% end -%>\n\n/usr/sbin/ipa-client-install -w '<%= @host.otp %>' --realm=<%= @host.realm %> -U $freeipa_mkhomedir $freeipa_opts $freeipa_server $freeipa_ssh\n\n##\n## Automounter\n##\n\n<% if @host.params['freeipa_automount_location'] -%>\nautomount_location="--location <%= @host.params['freeipa_automount_location'] %>"\n<% end -%>\n\n<% if @host.param_true? 'freeipa_automount' -%>\nif [ -f /usr/sbin/ipa-client-automount ]\nthen\n  /usr/sbin/ipa-client-automount $freeipa_server $automount_location --unattended\nfi\n<% end -%>\n\n##\n## Sudoers\n##\n\n<% unless @host.param_false? 'freeipa_enable_sudo' %>\n\nfreeipa_client_version=$(ipa-client-install --version)\nfreeipa_client_version_major=$(echo $freeipa_client_version | cut -f1 -d.)\nfreeipa_client_version_minor=$(echo $freeipa_client_version | cut -f2 -d.)\nfreeipa_realm=$(grep default_realm /etc/krb5.conf | cut -d"=" -f2 | tr -d ' ')\nfreeipa_domain=$(grep -A 2 domain_realm /etc/krb5.conf | tail -n1 | awk '{print $1}')\nfreeipa_dn=$(for word in $(echo $freeipa_domain | sed 's/\\./ /g'); do echo -n dc=$word,; done)\nsssd_version=$(sssd --version)\nsssd_major=$(echo $sssd_version | cut -f1 -d.)\nsssd_minor=$(echo $sssd_version | cut -f2 -d.)\nLDAP_CONFIG=$(mktemp)\n\n# >=ipa-client-4.1.0 automatically configures sssd for sudo\n# =<ipa-client-3 requires manual configuration which this snippet takes care of\n\nif [ $freeipa_client_version_major -lt 4 ]\nthen\n  # Modify sssd.conf\n  sed -i -e "s/services = .*/\\0, sudo/" /etc/sssd/sssd.conf\n\n  # Modify sssd.conf for sssd <1.11 (RHEL <6.6)\n  if [ $sssd_minor -lt 11 ] || [ $sssd_major -lt 1 ]\n  then\n    <% if @host.params['freeipa_server'] -%>\n    ldap_uri=", ldap://<%= @host.params['freeipa_server'] %>"\n    krb5_server=<%= @host.params['freeipa_server'] %>\n    <% else -%>\n    krb5_server="_srv_"\n    <% end -%>\n\ncat <<EOF > $LDAP_CONFIG\nsudo_provider = ldap\nldap_uri = _srv_ $ldap_uri\nldap_sudo_search_base = ou=SUDOers,${freeipa_dn%?}\nldap_sasl_mech = GSSAPI\nldap_sasl_authid = host/$HOSTNAME\nldap_sasl_realm = $freeipa_realm\nkrb5_server = $krb5_server\nEOF\n  sed -i -e "/\\[domain\\/.*\\]/ r $LDAP_CONFIG" /etc/sssd/sssd.conf\n  fi\n\n  # Modify nsswitch.conf\n  grep -q sudoers /etc/nsswitch.conf\n  if [[ $? -eq 0 ]];\n  then\n    sed -i -e "s/^sudoers.*/sudoers:    files sss/" /etc/nsswitch.conf\n  else\n    echo "sudoers:    files sss" >> /etc/nsswitch.conf\n  fi\n\n  # Configure nisdomain\n  <% if @host.operatingsystem.family == 'Redhat' -%>\n    authconfig --nisdomain ${freeipa_domain} --update\n    chkconfig sssd on\n    \n    if [[ $(rpm -qa systemd | wc -l) -gt 0 ]];\n    then\n      domain_service=/usr/lib/systemd/system/*-domainname.service\n      \n      # Workaround for BZ1071969 on RHEL 7.0\n      grep -q "DefaultDependencies=no" $domain_service\n      if [[ $? -ne 0 ]]\n      then\n        sed -i -e "s/\\[Unit\\]/\\[Unit\\]\\nDefaultDependencies=no/" $domain_service\n      fi\n\n      systemctl start $(basename $domain_service)\n      systemctl enable $(basename $domain_service)\n    fi\n  <% else -%>\n  # OS is not RedHat\n  sed -i -e '/^exit /d' /etc/rc.local\n  echo "nisdomainname ${freeipa_domain}" >> /etc/rc.local\n  echo "exit 0" >> /etc/rc.local\n  nisdomainname ${freeipa_domain}  \n  <% end -%>\nfi\n\n<% end -%>\n\n	t	\N	2016-04-14 10:08:54.778314	2016-04-14 10:08:54.778314	f	t	\N
41	http_proxy	<% if (proxy = @host.params["http_proxy"]) -%>\nhttp_proxy=<%= proxy %>\nexport http_proxy\nhttps_proxy=<%= proxy %>\nexport https_proxy\nno_proxy=localhost,127.0.0.0/8,*.local,*.<%= @host.domain.name -%>,puppet\nexport no_proxy\n<% end -%>\n	t	\N	2016-04-14 10:08:54.784053	2016-04-14 10:08:54.784053	f	t	\N
42	kickstart_networking_setup	<%#\nkind: snippet\nname: kickstart_networking_setup\ndescription: this will configure your host networking, it configures your primary interface as well\n    as other configures NICs. It supports physical, VLAN and Alias interfaces. It's intended to be\n    called from %post in your kickstart template. Note that this snippet can be used with Foreman 1.7\n    and later\n%>\n<% subnet = @host.subnet -%>\n<% dhcp = subnet.dhcp_boot_mode? -%>\n\n<% if @host.respond_to?(:has_primary_interface?) %>\n<%# Foreman 1.7 - primary interface contained in @host %>\n# primary interface\nreal=`ip -o link | grep <%= @host.mac -%> | awk '{print $2;}' | sed s/://`\n<% if @host.has_primary_interface? %>\ncat << EOF > /etc/sysconfig/network-scripts/ifcfg-$real\nBOOTPROTO="<%= dhcp ? 'dhcp' : 'none' -%>"\n<% unless dhcp -%>\nIPADDR="<%= @host.ip -%>"\nNETMASK="<%= subnet.mask -%>"\n<% if !subnet.gateway.nil? && !subnet.gateway.empty? -%>\nGATEWAY="<%= subnet.gateway %>"\n<% end -%>\n<% end -%>\nDEVICE="$real"\nHWADDR="<%= @host.mac -%>"\nONBOOT=yes\nEOF\n<% end -%>\n<% end -%>\n\n<% bonded_interfaces = [] %>\n<% bonds = @host.bond_interfaces %>\n<% bonds.each do |bond| %>\n<% subnet = bond.subnet -%>\n<% dhcp = subnet.nil? ? false : subnet.dhcp_boot_mode? -%>\n# <%= bond.identifier %> interface\nreal="<%= bond.identifier -%>"\ncat << EOF > /etc/sysconfig/network-scripts/ifcfg-$real\nBOOTPROTO="<%= dhcp ? 'dhcp' : 'none' -%>"\n<% unless dhcp || subnet.nil? -%>\nIPADDR="<%= bond.ip -%>"\nNETMASK="<%= subnet.mask -%>"\n<% if !subnet.gateway.nil? && !subnet.gateway.empty? -%>\nGATEWAY="<%= subnet.gateway %>"\n<% end -%>\n<% end -%>\nDEVICE="$real"\nONBOOT=yes\nPEERDNS=no\nPEERROUTES=no\nDEFROUTE=no\nTYPE=Bond\nBONDING_OPTS="<%= bond.bond_options -%> mode=<%= bond.mode -%>"\nBONDING_MASTER=yes\nNM_CONTROLLED=no\nEOF\n\n<% @host.interfaces_with_identifier(bond.attached_devices_identifiers).each do |interface| -%>\n<% next if !interface.managed? -%>\n\n<% subnet = interface.subnet -%>\n<% virtual = interface.virtual? -%>\n<% vlan = virtual && subnet.has_vlanid? -%>\n<% alias_type = virtual && !subnet.nil? && !subnet.has_vlanid? && interface.identifier.include?(':') -%>\n<% dhcp = !subnet.nil? && subnet.dhcp_boot_mode? -%>\n\n# <%= interface.identifier %> interface\nreal=`ip -o link | grep <%= interface.respond_to?(:inheriting_mac) ? interface.inheriting_mac : interface.mac -%> | awk '{print $2;}' | sed s/:$//`\n<% if virtual -%>\nreal=`echo <%= interface.identifier -%> | sed s/<%= interface.attached_to -%>/$real/`\n<% end -%>\n\ncat << EOF > /etc/sysconfig/network-scripts/ifcfg-$real\nBOOTPROTO="none"\nDEVICE="$real"\n<% unless virtual -%>\nHWADDR="<%= interface.mac -%>"\n<% end -%>\nONBOOT=yes\nPEERDNS=no\nPEERROUTES=no\n<% if vlan -%>\nVLAN=yes\n<% elsif alias_type -%>\nTYPE=Alias\n<% end -%>\nNM_CONTROLLED=no\nMASTER=<%= bond.identifier %>\nSLAVE=yes\nEOF\n\n<% bonded_interfaces.push(interface.identifier) -%>\n<% end %>\n<% end %>\n\n<% @host.managed_interfaces.each do |interface| %>\n<% next if !interface.managed? || interface.subnet.nil? -%>\n<% next if bonded_interfaces.include?(interface.identifier) -%>\n\n<% subnet = interface.subnet -%>\n<% virtual = interface.virtual? -%>\n<% vlan = virtual && subnet.has_vlanid? -%>\n<% alias_type = virtual && !subnet.has_vlanid? && interface.identifier.include?(':') -%>\n<% dhcp = subnet.dhcp_boot_mode? -%>\n\n# <%= interface.identifier %> interface\nreal=`ip -o link | grep <%= interface.mac -%> | awk '{print $2;}' | sed s/:$//`\n<% if virtual -%>\n  real=`echo <%= interface.identifier -%> | sed s/<%= interface.attached_to -%>/$real/`\n<% end -%>\n\ncat << EOF > /etc/sysconfig/network-scripts/ifcfg-$real\nBOOTPROTO="<%= dhcp ? 'dhcp' : 'none' -%>"\n<% unless dhcp -%>\nIPADDR="<%= interface.ip -%>"\nNETMASK="<%= subnet.mask -%>"\n<% if !subnet.gateway.nil? && !subnet.gateway.empty? -%>\nGATEWAY="<%= subnet.gateway %>"\n<% end -%>\n<% end -%>\nDEVICE="$real"\n<% unless virtual -%>\nHWADDR="<%= interface.mac -%>"\n<% end -%>\nONBOOT=yes\n<% if interface.respond_to?(:primary) && interface.primary -%>\nPEERDNS=yes\nPEERROUTES=yes\n<% else -%>\nPEERDNS=no\nPEERROUTES=no\n<% end -%>\n<% if vlan -%>\nVLAN=yes\n<% elsif alias_type -%>\nTYPE=Alias\n<% end -%>\nEOF\n\n<% end %>\n	t	\N	2016-04-14 10:08:54.78933	2016-04-14 10:08:54.78933	f	t	\N
44	redhat_register	<%#\nkind: snippet\nname: redhat_register\n%>\n# Red Hat Registration Snippet\n#\n# Set these parameters if you're using rhnreg_ks:\n#\n#   spacewalk_type = 'site'     (local Spacewalk/Satellite server)\n#                  = 'hosted'   (RHN hosted)\n#   spacewalk_host = <hostname> (hostname of Spacewalk server, optional for\n#                                RHN hosted)\n#\n# Set these parameters if you're using subscription-manager:\n#\n#   subscription_manager = 'true' (you're going to use subscription-manager)\n#\n#   subscription_manager_username = <username> (if using hosted RHN)\n#\n#   subscription_manager_password = <password> (if using hosted RHN)\n#\n#   subscription_manager_certpkg_url = <url> (url of cert package when using\n#                                             when using foreman with katello\n#                                             for example:\n#                                             http://fqdn/pub\n#                                             /katello-ca-consumer-latest.noarch.rpm)\n#\n#   subscription_manager_host = <hostname> (deprecated for\n#                                           subscription_manager_certpkg_url:\n#                                           hostname of SAM/Katello\n#                                           installation, if using SAM.\n#                                           hostname is used to determine the\n#                                           consumer cert url.)\n#\n#   subscription_manager_org = <org name> (organization name, if using\n#                                          SAM/Katello)\n#\n#   subscription_manager_repos = <repos> (comma separated list of repos (like\n#                                         rhel-6-server-optional-rpms) to\n#                                         enable after registration)\n#\n#   subscription_manager_pool = <pool> (specific pool to be used for\n#                                       registration)\n#\n#   http-proxy = <host> (proxy hostname to be used for registration)\n#\n#   http-proxy-port = <port> (proxy port to be used for registration)\n#\n#   http-proxy-user = <user> (proxy user to be used for registration)\n#\n#   http-proxy-password = <password> (proxy password to be\n#                                           used for registration)\n#\n#\n# Set this parameter regardless of which registration method you're using:\n#\n#   activation_key = <key>      (activation key string, not needed if using\n#                                subscription-manager with hosted RHN)\n#\n\n<% unless @host.params['subscription_manager'] %>\n  <% type = @host.params['spacewalk_type'] || 'hosted' %>\n\n  <% if @host.params['activation_key'] %>\n    # Discovered Activation Key <%= @host.params['activation_key'] %>\n    rhn_activation_key="<%= @host.params['activation_key'] -%>"\n\n    <% if type == 'site' -%>\n    satellite_hostname="<%= @host.params['spacewalk_host'] -%>"\n    rhn_cert_file="RHN-ORG-TRUSTED-SSL-CERT"\n    <% else -%>\n    satellite_hostname="<%= @host.params['spacewalk_host'] || 'xmlrpc.rhn.redhat.com' -%>"\n    rhn_cert_file="RHNS-CA-CERT"\n    <% end -%>\n\n    echo "Registering to RHN Satellite at [$satellite_hostname]"\n    echo "Using Registration Key [$rhn_activation_key]"\n\n    <% if type == 'site' -%>\n    # Obtain our RHN Satellite Certificate\n    echo "Obtaining RHN SSL certificate"\n    curl -o /usr/share/rhn/$rhn_cert_file -k https://$satellite_hostname/pub/$rhn_cert_file\n    <% if @host.operatingsystem.name == 'SLES' -%>\n    # if SLES then add CA Cert to CA Certs for curl\n    cp /usr/share/rhn/$rhn_cert_file /etc/ssl/certs/\n    ln -s /etc/ssl/certs/$rhn_cert_file /etc/ssl/certs/`openssl x509 -hash -noout -in /etc/ssl/certs/$rhn_cert_file`.0\n    <% end -%>\n    <% end -%>\n\n    # Update our up2date configuration file\n    echo "Updating SSL CA Certificate to /usr/share/rhn/$rhn_cert_file"\n    sed -i -e "s|^sslCACert=.*$|sslCACert=/usr/share/rhn/$rhn_cert_file|" /etc/sysconfig/rhn/up2date\n\n    # Update our Satellite Hostname\n    echo "Updating Satellite Hostname to [$satellite_hostname]"\n    sed -i -e "s|^serverURL=.*$|serverURL=https://$satellite_hostname/XMLRPC|" /etc/sysconfig/rhn/up2date\n    sed -i -e "s|^noSSLServerURL=.*$|noSSLServerURL=https://$satellite_hostname/XMLRPC|" /etc/sysconfig/rhn/up2date\n\n    # Restart messagebus/HAL to try and prevent hardware detection errors in rhnreg_ks\n    echo "Restarting services..."\n    <% if @host.operatingsystem.name == 'SLES' -%>\n    <% if @host.operatingsystem.major.to_i < 12 -%>\n    service haldaemon restart\n    <% end -%>\n    <% else -%>\n    service messagebus restart\n    service hald restart\n    <% end -%>\n\n    # Now, perform our registration\n    #  (might get hardware errors here, due to dbus/messagebus lameness. These are safe to ignore.)\n    echo -n "Performing RHN Registration... "\n    rhnreg_ks --activationkey=$rhn_activation_key\n    echo "done."\n\n    # Check we registered\n    echo -n "Checking System Registration... "\n    if ! rhn_check; then\n        echo "FAILED"\n        echo " >> RHN Registration FAILED. Please Investigate. <<"\n    else\n        echo "registration successful."\n    fi\n  <% else %>\n    # Not registering - host.params['activation_key'] not found.\n  <% end %>\n<% else %>\n  echo "Starting the subscription-manager registration process"\n  yum -t -y -e 0 install subscription-manager yum-utils\n  <% (enabled_repos = "yum-config-manager --enable #{@host.params['subscription_manager_repos'].gsub(',', ' ')}") if @host.params['subscription_manager_repos'] %>\n  <% if @host.params['http-proxy'] %>\n    subscription-manager config --server.proxy_hostname="<%= @host.params['http-proxy'] %>"\n    <% if @host.params['http-proxy-user'] %>\n      subscription-manager config --server.proxy_user="<%= @host.params['http-proxy-user'] %>"\n    <% end %>\n    <% if @host.params['http-proxy-password'] %>\n      subscription-manager config --server.proxy_password="<%= @host.params['http-proxy-password'] %>"\n    <% end %>\n    <% if @host.params['http-proxy-port'] %>\n      subscription-manager config --server.proxy_port="<%= @host.params['http-proxy-port'] %>"\n    <% end %>\n  <% end %>\n  <% if @host.params['subscription_manager_username'] && @host.params['subscription_manager_password'] %>\n    <% if @host.params['subscription_manager_pool'] %>\n      subscription-manager register --username="<%= @host.params['subscription_manager_username'] %>" --password="<%= @host.params['subscription_manager_password'] %>"\n      subscription-manager attach --pool="<%= @host.params['subscription_manager_pool'] %>"\n    <% else %>\n      subscription-manager register --username="<%= @host.params['subscription_manager_username'] %>" --password="<%= @host.params['subscription_manager_password'] %>" --auto-attach\n    <% end %>\n    # workaround for RHEL 6.4 bug https://bugzilla.redhat.com/show_bug.cgi?id=1008016\n    subscription-manager repos --list > /dev/null\n    <%= enabled_repos if enabled_repos %>\n  <% elsif @host.params['activation_key'] %>\n    <% if @host.params['subscription_manager_certpkg_url'] %>\n      rpm -Uvh <%= @host.params['subscription_manager_certpkg_url'] %>\n    <% elsif @host.params['subscription_manager_host'] %>\n      rpm -Uvh <%= @host.params['subscription_manager_host'] %>/pub/candlepin-cert-consumer-latest.noarch.rpm\n    <% end %>\n    subscription-manager register --org="<%= @host.params['subscription_manager_org'] %>" --activationkey="<%= @host.params['activation_key'] %>"\n    # workaround for RHEL 6.4 bug https://bugzilla.redhat.com/show_bug.cgi?id=1008016\n    subscription-manager repos --list > /dev/null\n    <%= enabled_repos if enabled_repos %>\n  <% else %>\n    # Not registering host.params['activation_key'] not found.\n  <% end %>\n<% end %>\n# End Red Hat Registration Snippet\n	t	\N	2016-04-14 10:08:54.800468	2016-04-14 10:08:54.800468	f	t	\N
45	saltstack_minion	<%#\nkind: snippet\nname: saltstack_minion\n%>\nmaster: <%= @host.params['salt_master'] %>\nlog_level: warning\n\n<%#\n# Grains (http://docs.saltstack.com/en/latest/topics/targeting/grains.html#grains-in-the-minion-config)\n#\n# Possible parameters are:\n#\n# * {'cluster': 'alpha'}\n# * {'roles': ['webserver', 'frontend']}\n#\n%>\ngrains: <%= @host.params['salt_grains'] ? @host.params['salt_grains'] : '{}' %>\n	t	\N	2016-04-14 10:08:54.806236	2016-04-14 10:08:54.806236	f	t	\N
46	CentOS_7.1 PXELinux	default linux\nlabel linux\nkernel boot/CentOS7.1-7.1-x86_64-vmlinuz\nIPAPPEND 2\nappend initrd=boot/CentOS7.1-7.1-x86_64-initrd.img ks=http://<%= @host.params['foreman_server'] %>:3000/unattended/provision ksdevice=bootif network kssendmac nodmraid biosdevname=0\n	f	1	2016-04-14 10:38:12.579965	2016-04-14 11:54:32.937767	f	f	\N
43	puppet.conf	<%#\nkind: snippet\nname: puppet.conf\n%>\n[main]\n<% if @host.operatingsystem.name == 'FreeBSD' -%>\n    vardir = /var/puppet\n    logdir = \\$vardir/log\n<% else -%>\n    vardir = /var/lib/puppet\n    logdir = /var/log/puppet\n<% end -%>\n    rundir = /var/run/puppet\n    ssldir = \\$vardir/ssl\n    privatekeydir = \\$ssldir/private_keys { group = service }\n    hostprivkey = \\$privatekeydir/\\$certname.pem { mode = 640 }\n    autosign       = \\$confdir/autosign.conf { mode = 664 }\n    stringify_facts = false\n\n[agent]\n    classfile = \\$vardir/classes.txt\n\n    localconfig   = \\$vardir/localconfig\n    report        = true\n    pluginsync    = true\n    masterport    = 8140\n    environment   = <%= @host.environment %>\n    server        = <%= @host.params['puppet_master_domain'] %>\n    listen        = false\n    splay         = true\n    runinterval   = 9600\n    noop          = false\n    configtimeout = 1200	t	\N	2016-04-14 10:08:54.794826	2016-05-13 15:34:49.118029	f	t	\N
47	CentOS_7.1 Provision	install\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --disable\nkeyboard us\nskipx\nnetwork --bootproto=static --ip=<%= @host.ip %> --netmask=255.255.255.0 --nameserver=10.255.0.80 --gateway=<%= @host.subnet.gateway %> --hostname=<%= @host.shortname %> --device=bootif --onboot=on \n%include /tmp/part-include\nrootpw  ObcRozf6\nfirewall --disabled\ntimezone  Asia/Shanghai\n#bootloader --location=mbr --append="nofb quiet splash=quiet biosdevname=0 intel_iommu=off" --md5pass=<%= root_pass %>\n#bootloader --location=mbr --append="nofb quiet splash=quiet biosdevname=1 intel_iommu=off"\n#bootloader --location=mbr --append="nofb quiet splash=quiet net.ifnames=0 biosdevname=0 intel_iommu=off"\n%include /tmp/bootloader.txt\nauthconfig  --useshadow  --passalgo=sha512\nlogging --level=debug\ntext\nreboot\n\n%pre\n#!/bin/bash\nVIRTUAL=0\nDISKS=`ls /sys/block/ | grep sd`\nVDISKS=`ls /sys/block/ | grep vd`\nIS_SSD=0\n\ndmidecode | egrep -i 'vendor' | grep QEMU && VIRTUAL=1\ncat /proc/cpuinfo |grep QEMU && VIRTUAL=1\ndmesg |grep "Booting paravirtualized kernel on KVM" && VIRTUAL=1\ndmidecode | grep -i 'manufacturer' |grep VMware && VIRTUAL=1\n\nfor disk in $DISKS\ndo\n  IS_SSD=`cat /sys/block/$disk/queue/rotational`\n  SIZE=`cat /sys/block/$disk/size`\n  F_SIZE=$[$SIZE*512/1024/1024/1024]\n  if [[ $IS_SSD == 0 && $F_SIZE -gt 400 && $F_SIZE -lt 600 ]]\n  then\n      echo "Compute" \n  elif [[ $F_SIZE -gt 1100 && $F_SIZE -lt 2000 ]] \n  then\n      echo "RAID 10"\n  elif [[ $F_SIZE -gt 2000 && $F_SIZE -lt 7000 ]] \n  then\n      echo "RAID 10"\n  elif [[ $IS_SSD == 1 && $F_SIZE -gt 3500 ]]\n  then\n      echo "Ceph"\n  else\n      echo $disk > /tmp/systemdisk\n  fi\ndone\n\n#deviceID=`ls /sys/bus/scsi/devices/ | grep '^7:0:0:0'  | head -n1`\ndeviceID=`ls /sys/bus/scsi/devices/ | grep '^0' | grep -v '^0:0' | head -n1`\n#deviceID=`lsscsi  | grep -v -E 'sr|ATA' |   grep dev | grep '0:0]'|sed 's/\\[\\(.*\\)\\].*/\\1/g' |head -n1`\n#deviceID=`ls /sys/bus/scsi/devices/ | grep '^1' | head -n1`\ndevicePath="/sys/bus/scsi/devices"\nif [[ ! -d $devicePath/$deviceID/block ]]; then\n    deviceID=`ls /sys/bus/scsi/devices/|grep '^0:0' | head -n1`\nfi\nls $devicePath/$deviceID/block/ | head -n1 > /tmp/systemdisk\n\nfor disk in $VDISKS\ndo \n   echo $disk > /tmp/systemdisk\ndone\n\nfinaldisk=`cat /tmp/systemdisk`\n#finaldisk='sda'\necho "zerombr" >> /tmp/part-include\necho "clearpart --all --drives=$finaldisk" >> /tmp/part-include\necho "part /boot --size=1000 --ondisk=$finaldisk" >> /tmp/part-include\necho "part swap --size=4000 --ondisk=$finaldisk" >> /tmp/part-include\necho "part pv.01 --size=20000 --grow --ondisk=$finaldisk" >> /tmp/part-include\necho "volgroup ustack_pv pv.01" >> /tmp/part-include\nif [[ $VIRTUAL == 0 ]]\nthen\necho "logvol / --vgname=ustack_pv --size=20000 --name=rootvol" >> /tmp/part-include\necho "bootloader --location=mbr --driveorder=$finaldisk --append='nofb quiet splash=quiet intel_iommu=off'" >> /tmp/bootloader.txt\nelse\necho "logvol / --vgname=ustack_pv --size=10000 --name=rootvol" >> /tmp/part-include\necho "bootloader --location=mbr --append='nofb quiet splash=quiet intel_iommu=off console=ttyS0' >" >> /tmp/bootloader.txt\nfi\necho "logvol /home --vgname=ustack_pv --size=5000 --name=homevol" >> /tmp-include\necho "logvol /var --vgname=ustack_pv --grow --size=5000 --name=varvol" >> /tmp/part-include\n\n%end\n\n%packages\n@core\n%end\n\n%post\nlogger "Starting anaconda <%= @host %> postinstall"\n#/usr/bin/chvt 3\n# iptables -F\n# /sbin/service iptables save\n\n# puppet config\n#puppetmaster=`echo <%= @host.subnet.gateway %> | cut -d "." -f1-3`".253"\n\nidc_region=`echo <%= @host.name %> | awk -F'.' '{print $(NF-2)}'`\ndns_server1=`echo <%= @host.subnet.gateway %> | cut -d "." -f1-3`".249"\ndns_server2=`echo <%= @host.subnet.gateway %> | cut -d "." -f1-3`".250"\n\necho "<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>" >> /etc/hosts\n#echo "10.255.0.205 server-205.0.uc.ustack.in" >> /etc/hosts\necho "<%= @host.params['yum_server'] %> mirrors.ustack.com" >> /etc/hosts\necho "<%= @host.params['puppet_server'] %> <%= @host.params['puppet_master_domain'] %>" >> /etc/hosts\necho "<%= @host.params['foreman_server'] %> foreman.ustack.com" >> /etc/hosts\necho "<%= @host.params['ntp_server'] %> ntp.0.uc.ustack.in" >> /etc/hosts\n\n#echo "<%= @host.ip %> <%= @host.name %> <%= @host.shortname %>" >> /etc/hosts\n# echo "10.255.0.205 server-205.0.uc.ustack.in" >> /etc/hosts\n#echo "10.255.0.61 mirrors.ustack.com" >> /etc/hosts\n#echo "10.255.0.43 puppet.0.uc.ustack.in" >> /etc/hosts\n\ncat > /etc/resolv.conf << EOF\nnameserver 10.255.0.80\nEOF\n\nrm -rf /etc/yum.repos.d/*\ncat > /etc/yum.repos.d/ustack.repo << EOF \n[openstack_liberity]\n# openstack liberity\nname=Packages for uStack base - x86_64\nbaseurl=http://mirrors.ustack.com/repo/eos-0.1/centos/os/x86_64/\nenabled=1\ngpgcheck=0\n\n[uos-release]\nname=uos relaese\nbaseurl=http://mirrors.ustack.com/repo/uos-release/\nenabled=1\ngpgcheck=0\nEOF\n\nyum clean all\nyum -y install uos-release\nyum -y install kernel kernel-devel net-tools ntp ntpdate vim puppet\n# and add the puppet package\necho "Configuring puppet"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippets "puppet.conf" %>\nEOF\n<%= @host.puppetmaster %>\n# chkconfig puppet off\nsystemctl disable puppet\n\n\n# Disable most things. Puppet will activate these if required.\necho "Disabling various system services"\n# <% %w{autofs gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\n#   /sbin/chkconfig --level 345 <%= service %> off 2>/dev/null\n# <% end -%>\n<% %w{autofs NetworkManager gpm sendmail cups iptables ip6tables auditd arptables_jf xfs pcmcia isdn rawdevices hpoj bluetooth openibd avahi-daemon avahi-dnsconfd hidd hplip pcscd restorecond mcstrans rhnsd yum-updatesd}.each do |service| -%>\n  /usr/bin/systemctl disable <%= service %> 2>/dev/null\n<% end -%>\n\nproxy=`echo <%= @host.subnet.gateway %> | cut -d "." -f1-3`".251"\n\ncat > /etc/rc.local << EOF\n#!/bin/bash\nntpdate $proxy\nntpdate $proxy\nexit 0\nEOF\nchmod +x /etc/rc.d/rc.local\n\necho 'UseDNS no' >> /etc/ssh/sshd_config\nsed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config\n\necho "Informing Foreman that we are built"\n#yum -y install wget\n#wget -q -O /dev/null --no-check-certificate <%= foreman_url %>\ncurl <%= foreman_url %>\n\ndeclare -A linked\ndeclare -A no_link\ngen_nic_udev_rule() {\n    nic_device_name=$1\n    nic_mac_address=$2\n    echo 'SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="'${nic_mac_address}'", ATTR{type}=="1", KERNEL=="*", NAME="'${nic_device_name}'"' >> /etc/udev/rules.d/70-persistent-net.rules\n}\n\nset_nic_init_script() {\n    nic_new_name=$1\n    nic_mac=$2\n    nic_script_file="/etc/sysconfig/network-scripts/ifcfg-${nic_new_name}"\n    gen_nic_udev_rule ${nic_new_name} ${nic_mac}\n    cat > ${nic_script_file} << EOF\nDEVICE=${nic_new_name}\nHWADDR=${nic_mac}\nTYPE=Ethernet\nONBOOT=yes\nNM_CONTROLLED=no\nBOOTPROTO=static\nEOF\n}\nset_default_network() {\n    nic=$(echo $1 | tr -d ' ')\n    nic_script_file="/etc/sysconfig/network-scripts/ifcfg-${nic}"\n\n    ip_netmask=<%= @host.subnet.mask %>\n    ip_address=<%= @host.ip %>\n    gateway_address=<%= @host.subnet.gateway %>\n    cat >> ${nic_script_file} << EOF\nIPADDR=${ip_address}\nNETMASK=${ip_netmask}\nGATEWAY=${gateway_address}\nEOF\n}\nrm  -f /etc/sysconfig/network-scripts/ifcfg-*\n\n#eth0_mac=24:6e:96:06:85:24\neth0_mac='<%= @host.mac %>'\neth0_interface=`ip a | grep -B 1 ${eth0_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\nmac_pre=`echo ${eth0_mac} | sed 's/..$//'`\neth1_mac=`ifconfig -a | grep $mac_pre | awk '{print $2}' | sort | sed -n "/$eth0_mac/,+1{//n;p}"`\nset_nic_init_script eth0 ${eth0_mac}\n\nif [ $eth1_mac ];then\n  eth1_interface=`ip a | grep -B 1 ${eth1_mac} | awk -F'[: ]+'  '/mtu/{print $2}'`\n  set_nic_init_script eth1 ${eth1_mac}\n  nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E "${eth0_interface}|${eth1_interface}" | awk -F ':' '{print $1}' | tr -d ' ')\nelse\n  nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' | grep -v -E "${eth0_interface}" | awk -F ':' '{print $1}' | tr -d ' ')\nfi\n\n#nic_device_list=$(cat /proc/net/dev | grep -v  -E 'face|Inter|lo' | awk -F ':' '{print $1}' | tr -d ' ')\nfor nic in ${nic_device_list}\ndo\n    echo $nic\n    ifup ${nic}  > /dev/null 2>&1\n    if [ $? -eq 1 ];then\n        ip a add 0 dev ${nic} > /dev/null 2>&1\n    fi\n    mac=$(ip a s ${nic} |  awk '/ether/{print $2}')\n    is_linked=`ethtool $nic | grep 'Link detected: yes' | wc -l`\n    if [ $is_linked -eq 1 ];then\n        linked[${mac}]=$nic\n    else\n        no_link[${mac}]=$nic\n    fi\ndone\nif [ ${#linked[@]} -eq 0 ];then\n    nic_seq_number=2\n    for mac in $(echo ${!no_link[@]})\n    do\n        new_name="eth${nic_seq_number}"\n        set_nic_init_script  ${new_name} $mac\n        let nic_seq_number=nic_seq_number+1\n    done\n# has problem\nelif [ ${#linked[@]} -eq 1 ];then\n    if [ '<%= @host.hostgroup %>' -eq 'Network' ];then\n        set_nic_init_script eth3 ${!linked[@]}\n        nic_seq_number=2\n        for mac in $(printf "%s\\n" "${!linked[@]}" | sort)  $(printf "%s\\n" "${!no_link[@]}" | sort)\n        do\n            new_name="eth${nic_seq_number}"\n            set_nic_init_script  ${new_name} $mac\n            if [ $nic_seq_number -eq '2' ];then\n                let nic_seq_number=nic_seq_number+2\n            else\n                let nic_seq_number=nic_seq_number+1\n            fi\n        done\n    elif [ '<%= @host.hostgroup %>' -eq 'Storage' ];then\n        set_nic_init_script eth2 ${!linked[@]}\n        nic_seq_number=3\n        for mac in $(printf "%s\\n" "${!no_link[@]}" | sort)\n        do\n            new_name="eth${nic_seq_number}"\n            set_nic_init_script  ${new_name} $mac\n            let nic_seq_number=nic_seq_number+1\n        done\n    else\n        nic_seq_number=2\n        for mac in $(printf "%s\\n" "${!no_link[@]}" | sort)\n        do\n            new_name="eth${nic_seq_number}"\n            set_nic_init_script  ${new_name} $mac\n        done\n    fi\nelif [ ${#linked[@]} -ge 2 ];then\n    nic_seq_number=2\n    for mac in $(printf "%s\\n" "${!linked[@]}" | sort)  $(printf "%s\\n" "${!no_link[@]}" | sort)\n    do\n        new_name="eth${nic_seq_number}"\n        set_nic_init_script  ${new_name} $mac\n        let nic_seq_number=nic_seq_number+1\n    done\n    echo ${!linked[@]}\nfi\n\n\nset_default_network eth0\n\nexit 0\n\n\n%end	f	4	2016-04-14 10:38:57.450032	2016-06-14 12:53:11.971857	f	f	\N
\.


--
-- Name: config_templates_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('config_templates_id_seq', 47, true);


--
-- Data for Name: config_templates_operatingsystems; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY config_templates_operatingsystems (config_template_id, operatingsystem_id) FROM stdin;
46	1
47	1
\.


--
-- Data for Name: domains; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY domains (id, name, fullname, created_at, updated_at, dns_id, hosts_count, hostgroups_count) FROM stdin;
\.


--
-- Name: domains_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('domains_id_seq', 7, true);


--
-- Data for Name: environment_classes; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY environment_classes (puppetclass_id, environment_id, id, lookup_key_id) FROM stdin;
\.


--
-- Name: environment_classes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('environment_classes_id_seq', 1, false);


--
-- Data for Name: environments; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY environments (id, name, created_at, updated_at, hosts_count, hostgroups_count) FROM stdin;
1	products	2016-04-14 10:46:08.340729	2016-04-14 10:46:08.340729	0	1
2	liberty	2016-05-13 14:45:07.522988	2016-05-13 14:45:07.522988	0	0
\.


--
-- Name: environments_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('environments_id_seq', 2, true);


--
-- Data for Name: external_usergroups; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY external_usergroups (id, name, auth_source_id, usergroup_id) FROM stdin;
\.


--
-- Name: external_usergroups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('external_usergroups_id_seq', 1, false);


--
-- Data for Name: fact_names; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY fact_names (id, name, updated_at, created_at, compose, short_name, type, ancestry) FROM stdin;
\.


--
-- Name: fact_names_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('fact_names_id_seq', 1, false);


--
-- Data for Name: fact_values; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY fact_values (id, value, fact_name_id, host_id, updated_at, created_at) FROM stdin;
\.


--
-- Name: fact_values_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('fact_values_id_seq', 1, false);


--
-- Data for Name: features; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY features (id, name, created_at, updated_at) FROM stdin;
1	Templates	2016-04-14 10:08:36.809153	2016-04-14 10:08:36.809153
2	TFTP	2016-04-14 10:08:55.013383	2016-04-14 10:08:55.013383
3	DNS	2016-04-14 10:08:55.015806	2016-04-14 10:08:55.015806
4	DHCP	2016-04-14 10:08:55.017497	2016-04-14 10:08:55.017497
5	Puppet	2016-04-14 10:08:55.019062	2016-04-14 10:08:55.019062
6	Puppet CA	2016-04-14 10:08:55.0206	2016-04-14 10:08:55.0206
7	BMC	2016-04-14 10:08:55.022174	2016-04-14 10:08:55.022174
8	Chef Proxy	2016-04-14 10:08:55.02387	2016-04-14 10:08:55.02387
9	Realm	2016-04-14 10:08:55.025404	2016-04-14 10:08:55.025404
10	Facts	2016-04-14 10:08:55.026768	2016-04-14 10:08:55.026768
\.


--
-- Name: features_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('features_id_seq', 10, true);


--
-- Data for Name: features_smart_proxies; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY features_smart_proxies (smart_proxy_id, feature_id) FROM stdin;
\.


--
-- Data for Name: filterings; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY filterings (id, filter_id, permission_id, created_at, updated_at) FROM stdin;
1	1	1	2016-04-14 10:08:51.951144	2016-04-14 10:08:51.951144
2	1	2	2016-04-14 10:08:51.953308	2016-04-14 10:08:51.953308
3	1	3	2016-04-14 10:08:51.954152	2016-04-14 10:08:51.954152
4	1	4	2016-04-14 10:08:51.955278	2016-04-14 10:08:51.955278
5	2	5	2016-04-14 10:08:51.979553	2016-04-14 10:08:51.979553
6	3	6	2016-04-14 10:08:51.99741	2016-04-14 10:08:51.99741
7	3	7	2016-04-14 10:08:51.999263	2016-04-14 10:08:51.999263
8	3	8	2016-04-14 10:08:52.00057	2016-04-14 10:08:52.00057
9	3	9	2016-04-14 10:08:52.001882	2016-04-14 10:08:52.001882
10	4	10	2016-04-14 10:08:52.019886	2016-04-14 10:08:52.019886
11	4	11	2016-04-14 10:08:52.021283	2016-04-14 10:08:52.021283
12	4	12	2016-04-14 10:08:52.0226	2016-04-14 10:08:52.0226
13	4	13	2016-04-14 10:08:52.024031	2016-04-14 10:08:52.024031
14	5	18	2016-04-14 10:08:52.042862	2016-04-14 10:08:52.042862
15	5	19	2016-04-14 10:08:52.044043	2016-04-14 10:08:52.044043
16	5	20	2016-04-14 10:08:52.045176	2016-04-14 10:08:52.045176
17	5	21	2016-04-14 10:08:52.046296	2016-04-14 10:08:52.046296
18	5	22	2016-04-14 10:08:52.0474	2016-04-14 10:08:52.0474
19	5	23	2016-04-14 10:08:52.048515	2016-04-14 10:08:52.048515
20	5	24	2016-04-14 10:08:52.049678	2016-04-14 10:08:52.049678
21	5	25	2016-04-14 10:08:52.050839	2016-04-14 10:08:52.050839
22	5	26	2016-04-14 10:08:52.051931	2016-04-14 10:08:52.051931
23	5	27	2016-04-14 10:08:52.053028	2016-04-14 10:08:52.053028
24	6	28	2016-04-14 10:08:52.068238	2016-04-14 10:08:52.068238
25	6	29	2016-04-14 10:08:52.069326	2016-04-14 10:08:52.069326
26	6	30	2016-04-14 10:08:52.07039	2016-04-14 10:08:52.07039
27	6	31	2016-04-14 10:08:52.071431	2016-04-14 10:08:52.071431
28	6	32	2016-04-14 10:08:52.072569	2016-04-14 10:08:52.072569
29	7	38	2016-04-14 10:08:52.087099	2016-04-14 10:08:52.087099
30	7	114	2016-04-14 10:08:52.08813	2016-04-14 10:08:52.08813
31	7	131	2016-04-14 10:08:52.089217	2016-04-14 10:08:52.089217
32	7	142	2016-04-14 10:08:52.090249	2016-04-14 10:08:52.090249
33	7	148	2016-04-14 10:08:52.091254	2016-04-14 10:08:52.091254
34	8	39	2016-04-14 10:08:52.105658	2016-04-14 10:08:52.105658
35	8	40	2016-04-14 10:08:52.106804	2016-04-14 10:08:52.106804
36	8	41	2016-04-14 10:08:52.107895	2016-04-14 10:08:52.107895
37	8	42	2016-04-14 10:08:52.108981	2016-04-14 10:08:52.108981
38	9	43	2016-04-14 10:08:52.124143	2016-04-14 10:08:52.124143
39	9	44	2016-04-14 10:08:52.125309	2016-04-14 10:08:52.125309
40	9	45	2016-04-14 10:08:52.126414	2016-04-14 10:08:52.126414
41	9	46	2016-04-14 10:08:52.127532	2016-04-14 10:08:52.127532
42	9	47	2016-04-14 10:08:52.128645	2016-04-14 10:08:52.128645
43	10	52	2016-04-14 10:08:52.143485	2016-04-14 10:08:52.143485
44	10	53	2016-04-14 10:08:52.14463	2016-04-14 10:08:52.14463
45	10	54	2016-04-14 10:08:52.145766	2016-04-14 10:08:52.145766
46	10	55	2016-04-14 10:08:52.14685	2016-04-14 10:08:52.14685
47	11	56	2016-04-14 10:08:52.160662	2016-04-14 10:08:52.160662
48	11	57	2016-04-14 10:08:52.161846	2016-04-14 10:08:52.161846
49	12	62	2016-04-14 10:08:52.176031	2016-04-14 10:08:52.176031
50	12	63	2016-04-14 10:08:52.177146	2016-04-14 10:08:52.177146
51	12	64	2016-04-14 10:08:52.178427	2016-04-14 10:08:52.178427
52	12	65	2016-04-14 10:08:52.179466	2016-04-14 10:08:52.179466
53	13	66	2016-04-14 10:08:52.192688	2016-04-14 10:08:52.192688
54	14	67	2016-04-14 10:08:52.207296	2016-04-14 10:08:52.207296
55	14	68	2016-04-14 10:08:52.208486	2016-04-14 10:08:52.208486
56	14	69	2016-04-14 10:08:52.209617	2016-04-14 10:08:52.209617
57	15	70	2016-04-14 10:08:52.224688	2016-04-14 10:08:52.224688
58	15	71	2016-04-14 10:08:52.225878	2016-04-14 10:08:52.225878
59	15	72	2016-04-14 10:08:52.226993	2016-04-14 10:08:52.226993
60	15	73	2016-04-14 10:08:52.228113	2016-04-14 10:08:52.228113
61	16	74	2016-04-14 10:08:52.24382	2016-04-14 10:08:52.24382
62	16	75	2016-04-14 10:08:52.245017	2016-04-14 10:08:52.245017
63	16	76	2016-04-14 10:08:52.246157	2016-04-14 10:08:52.246157
64	16	77	2016-04-14 10:08:52.247213	2016-04-14 10:08:52.247213
65	16	78	2016-04-14 10:08:52.248261	2016-04-14 10:08:52.248261
66	16	79	2016-04-14 10:08:52.249309	2016-04-14 10:08:52.249309
67	16	80	2016-04-14 10:08:52.250358	2016-04-14 10:08:52.250358
68	16	81	2016-04-14 10:08:52.251511	2016-04-14 10:08:52.251511
69	16	82	2016-04-14 10:08:52.252584	2016-04-14 10:08:52.252584
70	17	83	2016-04-14 10:08:52.266867	2016-04-14 10:08:52.266867
71	17	84	2016-04-14 10:08:52.267917	2016-04-14 10:08:52.267917
72	17	85	2016-04-14 10:08:52.268901	2016-04-14 10:08:52.268901
73	17	86	2016-04-14 10:08:52.269982	2016-04-14 10:08:52.269982
74	18	87	2016-04-14 10:08:52.284138	2016-04-14 10:08:52.284138
75	18	88	2016-04-14 10:08:52.285229	2016-04-14 10:08:52.285229
76	18	89	2016-04-14 10:08:52.286485	2016-04-14 10:08:52.286485
77	18	90	2016-04-14 10:08:52.287507	2016-04-14 10:08:52.287507
78	18	91	2016-04-14 10:08:52.288494	2016-04-14 10:08:52.288494
79	19	92	2016-04-14 10:08:52.302294	2016-04-14 10:08:52.302294
80	20	93	2016-04-14 10:08:52.3722	2016-04-14 10:08:52.3722
81	20	94	2016-04-14 10:08:52.373477	2016-04-14 10:08:52.373477
82	20	95	2016-04-14 10:08:52.374589	2016-04-14 10:08:52.374589
83	20	96	2016-04-14 10:08:52.375503	2016-04-14 10:08:52.375503
84	21	97	2016-04-14 10:08:52.452258	2016-04-14 10:08:52.452258
85	21	98	2016-04-14 10:08:52.453064	2016-04-14 10:08:52.453064
86	21	99	2016-04-14 10:08:52.453831	2016-04-14 10:08:52.453831
87	21	100	2016-04-14 10:08:52.454599	2016-04-14 10:08:52.454599
88	22	101	2016-04-14 10:08:52.465275	2016-04-14 10:08:52.465275
89	22	102	2016-04-14 10:08:52.466083	2016-04-14 10:08:52.466083
90	22	103	2016-04-14 10:08:52.466882	2016-04-14 10:08:52.466882
91	22	104	2016-04-14 10:08:52.467646	2016-04-14 10:08:52.467646
92	23	105	2016-04-14 10:08:52.478784	2016-04-14 10:08:52.478784
93	23	106	2016-04-14 10:08:52.479656	2016-04-14 10:08:52.479656
94	23	107	2016-04-14 10:08:52.480514	2016-04-14 10:08:52.480514
95	23	108	2016-04-14 10:08:52.48129	2016-04-14 10:08:52.48129
96	23	109	2016-04-14 10:08:52.48215	2016-04-14 10:08:52.48215
97	24	110	2016-04-14 10:08:52.493719	2016-04-14 10:08:52.493719
98	24	111	2016-04-14 10:08:52.49461	2016-04-14 10:08:52.49461
99	24	112	2016-04-14 10:08:52.495457	2016-04-14 10:08:52.495457
100	24	113	2016-04-14 10:08:52.496304	2016-04-14 10:08:52.496304
101	25	115	2016-04-14 10:08:52.508262	2016-04-14 10:08:52.508262
102	25	116	2016-04-14 10:08:52.509169	2016-04-14 10:08:52.509169
103	25	117	2016-04-14 10:08:52.510028	2016-04-14 10:08:52.510028
104	25	118	2016-04-14 10:08:52.510889	2016-04-14 10:08:52.510889
105	25	119	2016-04-14 10:08:52.511745	2016-04-14 10:08:52.511745
106	26	120	2016-04-14 10:08:52.523075	2016-04-14 10:08:52.523075
107	26	121	2016-04-14 10:08:52.523896	2016-04-14 10:08:52.523896
108	26	122	2016-04-14 10:08:52.524697	2016-04-14 10:08:52.524697
109	26	123	2016-04-14 10:08:52.52547	2016-04-14 10:08:52.52547
110	27	124	2016-04-14 10:08:52.536068	2016-04-14 10:08:52.536068
111	27	125	2016-04-14 10:08:52.536858	2016-04-14 10:08:52.536858
112	27	126	2016-04-14 10:08:52.537619	2016-04-14 10:08:52.537619
113	28	132	2016-04-14 10:08:52.549499	2016-04-14 10:08:52.549499
114	28	133	2016-04-14 10:08:52.550314	2016-04-14 10:08:52.550314
115	28	134	2016-04-14 10:08:52.551101	2016-04-14 10:08:52.551101
116	28	135	2016-04-14 10:08:52.551876	2016-04-14 10:08:52.551876
117	28	136	2016-04-14 10:08:52.552723	2016-04-14 10:08:52.552723
118	28	137	2016-04-14 10:08:52.553496	2016-04-14 10:08:52.553496
119	28	138	2016-04-14 10:08:52.554271	2016-04-14 10:08:52.554271
120	28	139	2016-04-14 10:08:52.555137	2016-04-14 10:08:52.555137
121	28	140	2016-04-14 10:08:52.555944	2016-04-14 10:08:52.555944
122	28	141	2016-04-14 10:08:52.556668	2016-04-14 10:08:52.556668
123	29	143	2016-04-14 10:08:52.568511	2016-04-14 10:08:52.568511
124	29	144	2016-04-14 10:08:52.569411	2016-04-14 10:08:52.569411
125	29	145	2016-04-14 10:08:52.57027	2016-04-14 10:08:52.57027
126	29	146	2016-04-14 10:08:52.571041	2016-04-14 10:08:52.571041
127	29	147	2016-04-14 10:08:52.571833	2016-04-14 10:08:52.571833
128	30	149	2016-04-14 10:08:52.583913	2016-04-14 10:08:52.583913
129	30	150	2016-04-14 10:08:52.584808	2016-04-14 10:08:52.584808
130	30	151	2016-04-14 10:08:52.585667	2016-04-14 10:08:52.585667
131	30	152	2016-04-14 10:08:52.586531	2016-04-14 10:08:52.586531
132	30	153	2016-04-14 10:08:52.587398	2016-04-14 10:08:52.587398
133	31	154	2016-04-14 10:08:52.599051	2016-04-14 10:08:52.599051
134	31	155	2016-04-14 10:08:52.599881	2016-04-14 10:08:52.599881
135	31	156	2016-04-14 10:08:52.600674	2016-04-14 10:08:52.600674
136	31	157	2016-04-14 10:08:52.601489	2016-04-14 10:08:52.601489
137	32	158	2016-04-14 10:08:52.612027	2016-04-14 10:08:52.612027
138	32	159	2016-04-14 10:08:52.613136	2016-04-14 10:08:52.613136
139	32	160	2016-04-14 10:08:52.613888	2016-04-14 10:08:52.613888
140	32	161	2016-04-14 10:08:52.61463	2016-04-14 10:08:52.61463
141	33	110	2016-04-14 10:08:52.633721	2016-04-14 10:08:52.633721
142	33	111	2016-04-14 10:08:52.63465	2016-04-14 10:08:52.63465
143	33	112	2016-04-14 10:08:52.63553	2016-04-14 10:08:52.63553
144	33	113	2016-04-14 10:08:52.636415	2016-04-14 10:08:52.636415
145	34	74	2016-04-14 10:08:52.656977	2016-04-14 10:08:52.656977
146	35	74	2016-04-14 10:08:52.678283	2016-04-14 10:08:52.678283
147	35	75	2016-04-14 10:08:52.679124	2016-04-14 10:08:52.679124
148	35	76	2016-04-14 10:08:52.679871	2016-04-14 10:08:52.679871
149	35	77	2016-04-14 10:08:52.680677	2016-04-14 10:08:52.680677
150	35	78	2016-04-14 10:08:52.681552	2016-04-14 10:08:52.681552
151	36	1	2016-04-14 10:08:52.704553	2016-04-14 10:08:52.704553
152	37	5	2016-04-14 10:08:52.718468	2016-04-14 10:08:52.718468
153	38	6	2016-04-14 10:08:52.780632	2016-04-14 10:08:52.780632
154	39	10	2016-04-14 10:08:52.803152	2016-04-14 10:08:52.803152
155	40	14	2016-04-14 10:08:52.821486	2016-04-14 10:08:52.821486
156	41	18	2016-04-14 10:08:52.840763	2016-04-14 10:08:52.840763
157	41	22	2016-04-14 10:08:52.842159	2016-04-14 10:08:52.842159
158	42	28	2016-04-14 10:08:52.939087	2016-04-14 10:08:52.939087
159	43	34	2016-04-14 10:08:52.951118	2016-04-14 10:08:52.951118
160	44	38	2016-04-14 10:08:52.963226	2016-04-14 10:08:52.963226
161	44	114	2016-04-14 10:08:52.964144	2016-04-14 10:08:52.964144
162	44	131	2016-04-14 10:08:52.965027	2016-04-14 10:08:52.965027
163	44	142	2016-04-14 10:08:52.965945	2016-04-14 10:08:52.965945
164	44	148	2016-04-14 10:08:52.966813	2016-04-14 10:08:52.966813
165	45	39	2016-04-14 10:08:52.98448	2016-04-14 10:08:52.98448
166	46	43	2016-04-14 10:08:52.997565	2016-04-14 10:08:52.997565
167	47	48	2016-04-14 10:08:53.010471	2016-04-14 10:08:53.010471
168	48	52	2016-04-14 10:08:53.022783	2016-04-14 10:08:53.022783
169	49	56	2016-04-14 10:08:53.034109	2016-04-14 10:08:53.034109
170	50	58	2016-04-14 10:08:53.04663	2016-04-14 10:08:53.04663
171	51	62	2016-04-14 10:08:53.058063	2016-04-14 10:08:53.058063
172	52	70	2016-04-14 10:08:53.069943	2016-04-14 10:08:53.069943
173	53	74	2016-04-14 10:08:53.081378	2016-04-14 10:08:53.081378
174	54	83	2016-04-14 10:08:53.093036	2016-04-14 10:08:53.093036
175	55	87	2016-04-14 10:08:53.105031	2016-04-14 10:08:53.105031
176	56	92	2016-04-14 10:08:53.116458	2016-04-14 10:08:53.116458
177	57	93	2016-04-14 10:08:53.128534	2016-04-14 10:08:53.128534
178	58	97	2016-04-14 10:08:53.139874	2016-04-14 10:08:53.139874
179	59	101	2016-04-14 10:08:53.151034	2016-04-14 10:08:53.151034
180	60	105	2016-04-14 10:08:53.163376	2016-04-14 10:08:53.163376
181	61	110	2016-04-14 10:08:53.174652	2016-04-14 10:08:53.174652
182	62	115	2016-04-14 10:08:53.1867	2016-04-14 10:08:53.1867
183	63	120	2016-04-14 10:08:53.197902	2016-04-14 10:08:53.197902
184	64	124	2016-04-14 10:08:53.209334	2016-04-14 10:08:53.209334
185	65	127	2016-04-14 10:08:53.221568	2016-04-14 10:08:53.221568
186	66	132	2016-04-14 10:08:53.23346	2016-04-14 10:08:53.23346
187	66	136	2016-04-14 10:08:53.234383	2016-04-14 10:08:53.234383
188	66	139	2016-04-14 10:08:53.235253	2016-04-14 10:08:53.235253
189	67	143	2016-04-14 10:08:53.377012	2016-04-14 10:08:53.377012
190	68	149	2016-04-14 10:08:53.389319	2016-04-14 10:08:53.389319
191	69	154	2016-04-14 10:08:53.399918	2016-04-14 10:08:53.399918
192	70	158	2016-04-14 10:08:53.411341	2016-04-14 10:08:53.411341
193	71	1	2016-04-14 10:08:53.431595	2016-04-14 10:08:53.431595
194	72	5	2016-04-14 10:08:53.446008	2016-04-14 10:08:53.446008
195	73	6	2016-04-14 10:08:53.456402	2016-04-14 10:08:53.456402
196	74	38	2016-04-14 10:08:53.468338	2016-04-14 10:08:53.468338
197	74	131	2016-04-14 10:08:53.469502	2016-04-14 10:08:53.469502
198	74	142	2016-04-14 10:08:53.470405	2016-04-14 10:08:53.470405
199	75	39	2016-04-14 10:08:53.481417	2016-04-14 10:08:53.481417
200	76	43	2016-04-14 10:08:53.493127	2016-04-14 10:08:53.493127
201	76	47	2016-04-14 10:08:53.494032	2016-04-14 10:08:53.494032
202	77	52	2016-04-14 10:08:53.505714	2016-04-14 10:08:53.505714
203	77	53	2016-04-14 10:08:53.506566	2016-04-14 10:08:53.506566
204	77	54	2016-04-14 10:08:53.507378	2016-04-14 10:08:53.507378
205	77	55	2016-04-14 10:08:53.508195	2016-04-14 10:08:53.508195
206	78	56	2016-04-14 10:08:53.519192	2016-04-14 10:08:53.519192
207	79	62	2016-04-14 10:08:53.530612	2016-04-14 10:08:53.530612
208	80	70	2016-04-14 10:08:53.541641	2016-04-14 10:08:53.541641
209	81	74	2016-04-14 10:08:53.553658	2016-04-14 10:08:53.553658
210	81	75	2016-04-14 10:08:53.554567	2016-04-14 10:08:53.554567
211	81	76	2016-04-14 10:08:53.555446	2016-04-14 10:08:53.555446
212	81	77	2016-04-14 10:08:53.556324	2016-04-14 10:08:53.556324
213	81	78	2016-04-14 10:08:53.557143	2016-04-14 10:08:53.557143
214	82	92	2016-04-14 10:08:53.567753	2016-04-14 10:08:53.567753
215	83	93	2016-04-14 10:08:53.578394	2016-04-14 10:08:53.578394
216	83	94	2016-04-14 10:08:53.57919	2016-04-14 10:08:53.57919
217	83	95	2016-04-14 10:08:53.579946	2016-04-14 10:08:53.579946
218	83	96	2016-04-14 10:08:53.580714	2016-04-14 10:08:53.580714
219	84	97	2016-04-14 10:08:53.592253	2016-04-14 10:08:53.592253
220	85	101	2016-04-14 10:08:53.603423	2016-04-14 10:08:53.603423
221	86	110	2016-04-14 10:08:53.614909	2016-04-14 10:08:53.614909
222	87	115	2016-04-14 10:08:53.625948	2016-04-14 10:08:53.625948
223	87	119	2016-04-14 10:08:53.626811	2016-04-14 10:08:53.626811
224	88	120	2016-04-14 10:08:53.637366	2016-04-14 10:08:53.637366
225	89	124	2016-04-14 10:08:53.648876	2016-04-14 10:08:53.648876
226	89	125	2016-04-14 10:08:53.6498	2016-04-14 10:08:53.6498
227	90	132	2016-04-14 10:08:53.66139	2016-04-14 10:08:53.66139
228	90	134	2016-04-14 10:08:53.714314	2016-04-14 10:08:53.714314
229	90	136	2016-04-14 10:08:53.71562	2016-04-14 10:08:53.71562
230	90	139	2016-04-14 10:08:53.716421	2016-04-14 10:08:53.716421
231	91	143	2016-04-14 10:08:53.729823	2016-04-14 10:08:53.729823
232	91	145	2016-04-14 10:08:53.731061	2016-04-14 10:08:53.731061
233	92	154	2016-04-14 10:08:53.806841	2016-04-14 10:08:53.806841
234	92	155	2016-04-14 10:08:53.807696	2016-04-14 10:08:53.807696
235	92	156	2016-04-14 10:08:53.80868	2016-04-14 10:08:53.80868
236	92	157	2016-04-14 10:08:53.809496	2016-04-14 10:08:53.809496
237	93	158	2016-04-14 10:08:53.819858	2016-04-14 10:08:53.819858
238	93	160	2016-04-14 10:08:53.820644	2016-04-14 10:08:53.820644
239	94	1	2016-04-14 10:08:53.83911	2016-04-14 10:08:53.83911
240	95	6	2016-04-14 10:08:53.85361	2016-04-14 10:08:53.85361
241	96	38	2016-04-14 10:08:53.865308	2016-04-14 10:08:53.865308
242	96	131	2016-04-14 10:08:53.866135	2016-04-14 10:08:53.866135
243	96	142	2016-04-14 10:08:53.866911	2016-04-14 10:08:53.866911
244	97	39	2016-04-14 10:08:53.877019	2016-04-14 10:08:53.877019
245	98	43	2016-04-14 10:08:53.888596	2016-04-14 10:08:53.888596
246	99	52	2016-04-14 10:08:53.899386	2016-04-14 10:08:53.899386
247	100	56	2016-04-14 10:08:53.911141	2016-04-14 10:08:53.911141
248	101	62	2016-04-14 10:08:53.921953	2016-04-14 10:08:53.921953
249	102	70	2016-04-14 10:08:53.932379	2016-04-14 10:08:53.932379
250	103	74	2016-04-14 10:08:53.94377	2016-04-14 10:08:53.94377
251	104	87	2016-04-14 10:08:53.95467	2016-04-14 10:08:53.95467
252	105	92	2016-04-14 10:08:53.966371	2016-04-14 10:08:53.966371
253	106	93	2016-04-14 10:08:53.977097	2016-04-14 10:08:53.977097
254	107	97	2016-04-14 10:08:53.987447	2016-04-14 10:08:53.987447
255	108	101	2016-04-14 10:08:53.998738	2016-04-14 10:08:53.998738
256	109	105	2016-04-14 10:08:54.009934	2016-04-14 10:08:54.009934
257	110	110	2016-04-14 10:08:54.020806	2016-04-14 10:08:54.020806
258	111	115	2016-04-14 10:08:54.031558	2016-04-14 10:08:54.031558
259	112	120	2016-04-14 10:08:54.04257	2016-04-14 10:08:54.04257
260	113	124	2016-04-14 10:08:54.053737	2016-04-14 10:08:54.053737
261	114	143	2016-04-14 10:08:54.065146	2016-04-14 10:08:54.065146
262	115	10	2016-04-14 10:08:54.083449	2016-04-14 10:08:54.083449
263	116	148	2016-04-14 10:08:54.146665	2016-04-14 10:08:54.146665
\.


--
-- Name: filterings_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('filterings_id_seq', 263, true);


--
-- Data for Name: filters; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY filters (id, search, role_id, created_at, updated_at, taxonomy_search) FROM stdin;
1	\N	1	2016-04-14 10:08:51.948823	2016-04-14 10:08:51.948823	\N
2	\N	1	2016-04-14 10:08:51.977877	2016-04-14 10:08:51.977877	\N
3	\N	1	2016-04-14 10:08:51.995732	2016-04-14 10:08:51.995732	\N
4	\N	1	2016-04-14 10:08:52.018196	2016-04-14 10:08:52.018196	\N
5	\N	1	2016-04-14 10:08:52.041521	2016-04-14 10:08:52.041521	\N
6	\N	1	2016-04-14 10:08:52.066967	2016-04-14 10:08:52.066967	\N
7	\N	1	2016-04-14 10:08:52.085885	2016-04-14 10:08:52.085885	\N
8	\N	1	2016-04-14 10:08:52.104429	2016-04-14 10:08:52.104429	\N
9	\N	1	2016-04-14 10:08:52.12286	2016-04-14 10:08:52.12286	\N
10	\N	1	2016-04-14 10:08:52.142231	2016-04-14 10:08:52.142231	\N
11	\N	1	2016-04-14 10:08:52.15922	2016-04-14 10:08:52.15922	\N
12	\N	1	2016-04-14 10:08:52.174825	2016-04-14 10:08:52.174825	\N
13	\N	1	2016-04-14 10:08:52.191468	2016-04-14 10:08:52.191468	\N
14	\N	1	2016-04-14 10:08:52.206056	2016-04-14 10:08:52.206056	\N
15	\N	1	2016-04-14 10:08:52.22344	2016-04-14 10:08:52.22344	\N
16	\N	1	2016-04-14 10:08:52.242548	2016-04-14 10:08:52.242548	\N
17	\N	1	2016-04-14 10:08:52.265695	2016-04-14 10:08:52.265695	\N
18	\N	1	2016-04-14 10:08:52.282951	2016-04-14 10:08:52.282951	\N
19	\N	1	2016-04-14 10:08:52.301082	2016-04-14 10:08:52.301082	\N
20	\N	1	2016-04-14 10:08:52.370994	2016-04-14 10:08:52.370994	\N
21	\N	1	2016-04-14 10:08:52.451104	2016-04-14 10:08:52.451104	\N
22	\N	1	2016-04-14 10:08:52.464339	2016-04-14 10:08:52.464339	\N
23	\N	1	2016-04-14 10:08:52.477854	2016-04-14 10:08:52.477854	\N
24	\N	1	2016-04-14 10:08:52.492762	2016-04-14 10:08:52.492762	\N
25	\N	1	2016-04-14 10:08:52.507313	2016-04-14 10:08:52.507313	\N
26	\N	1	2016-04-14 10:08:52.52212	2016-04-14 10:08:52.52212	\N
27	\N	1	2016-04-14 10:08:52.534868	2016-04-14 10:08:52.534868	\N
28	\N	1	2016-04-14 10:08:52.548611	2016-04-14 10:08:52.548611	\N
29	\N	1	2016-04-14 10:08:52.567554	2016-04-14 10:08:52.567554	\N
30	\N	1	2016-04-14 10:08:52.582956	2016-04-14 10:08:52.582956	\N
31	\N	1	2016-04-14 10:08:52.598077	2016-04-14 10:08:52.598077	\N
32	\N	1	2016-04-14 10:08:52.611113	2016-04-14 10:08:52.611113	\N
33	\N	2	2016-04-14 10:08:52.63267	2016-04-14 10:08:52.63267	\N
34	\N	3	2016-04-14 10:08:52.655956	2016-04-14 10:08:52.655956	\N
35	\N	4	2016-04-14 10:08:52.677242	2016-04-14 10:08:52.677242	\N
36	\N	5	2016-04-14 10:08:52.703465	2016-04-14 10:08:52.703465	\N
37	\N	5	2016-04-14 10:08:52.717485	2016-04-14 10:08:52.717485	\N
38	\N	5	2016-04-14 10:08:52.779124	2016-04-14 10:08:52.779124	\N
39	\N	5	2016-04-14 10:08:52.801117	2016-04-14 10:08:52.801117	\N
40	\N	5	2016-04-14 10:08:52.820116	2016-04-14 10:08:52.820116	\N
41	\N	5	2016-04-14 10:08:52.839068	2016-04-14 10:08:52.839068	\N
42	\N	5	2016-04-14 10:08:52.937396	2016-04-14 10:08:52.937396	\N
43	\N	5	2016-04-14 10:08:52.950086	2016-04-14 10:08:52.950086	\N
44	\N	5	2016-04-14 10:08:52.962224	2016-04-14 10:08:52.962224	\N
45	\N	5	2016-04-14 10:08:52.982911	2016-04-14 10:08:52.982911	\N
46	\N	5	2016-04-14 10:08:52.996498	2016-04-14 10:08:52.996498	\N
47	\N	5	2016-04-14 10:08:53.009427	2016-04-14 10:08:53.009427	\N
48	\N	5	2016-04-14 10:08:53.021706	2016-04-14 10:08:53.021706	\N
49	\N	5	2016-04-14 10:08:53.033139	2016-04-14 10:08:53.033139	\N
50	\N	5	2016-04-14 10:08:53.045567	2016-04-14 10:08:53.045567	\N
51	\N	5	2016-04-14 10:08:53.057039	2016-04-14 10:08:53.057039	\N
52	\N	5	2016-04-14 10:08:53.068903	2016-04-14 10:08:53.068903	\N
53	\N	5	2016-04-14 10:08:53.080307	2016-04-14 10:08:53.080307	\N
54	\N	5	2016-04-14 10:08:53.091963	2016-04-14 10:08:53.091963	\N
55	\N	5	2016-04-14 10:08:53.104006	2016-04-14 10:08:53.104006	\N
56	\N	5	2016-04-14 10:08:53.1155	2016-04-14 10:08:53.1155	\N
57	\N	5	2016-04-14 10:08:53.127484	2016-04-14 10:08:53.127484	\N
58	\N	5	2016-04-14 10:08:53.138896	2016-04-14 10:08:53.138896	\N
59	\N	5	2016-04-14 10:08:53.149984	2016-04-14 10:08:53.149984	\N
60	\N	5	2016-04-14 10:08:53.162329	2016-04-14 10:08:53.162329	\N
61	\N	5	2016-04-14 10:08:53.173611	2016-04-14 10:08:53.173611	\N
62	\N	5	2016-04-14 10:08:53.185656	2016-04-14 10:08:53.185656	\N
63	\N	5	2016-04-14 10:08:53.196908	2016-04-14 10:08:53.196908	\N
64	\N	5	2016-04-14 10:08:53.208285	2016-04-14 10:08:53.208285	\N
65	\N	5	2016-04-14 10:08:53.220517	2016-04-14 10:08:53.220517	\N
66	\N	5	2016-04-14 10:08:53.232436	2016-04-14 10:08:53.232436	\N
67	\N	5	2016-04-14 10:08:53.375444	2016-04-14 10:08:53.375444	\N
68	\N	5	2016-04-14 10:08:53.388449	2016-04-14 10:08:53.388449	\N
69	\N	5	2016-04-14 10:08:53.398952	2016-04-14 10:08:53.398952	\N
70	\N	5	2016-04-14 10:08:53.410219	2016-04-14 10:08:53.410219	\N
71	\N	6	2016-04-14 10:08:53.430566	2016-04-14 10:08:53.430566	\N
72	\N	6	2016-04-14 10:08:53.44506	2016-04-14 10:08:53.44506	\N
73	\N	6	2016-04-14 10:08:53.455519	2016-04-14 10:08:53.455519	\N
74	\N	6	2016-04-14 10:08:53.467406	2016-04-14 10:08:53.467406	\N
75	\N	6	2016-04-14 10:08:53.480417	2016-04-14 10:08:53.480417	\N
76	\N	6	2016-04-14 10:08:53.492165	2016-04-14 10:08:53.492165	\N
77	\N	6	2016-04-14 10:08:53.504818	2016-04-14 10:08:53.504818	\N
78	\N	6	2016-04-14 10:08:53.518302	2016-04-14 10:08:53.518302	\N
79	\N	6	2016-04-14 10:08:53.529598	2016-04-14 10:08:53.529598	\N
80	\N	6	2016-04-14 10:08:53.540726	2016-04-14 10:08:53.540726	\N
81	\N	6	2016-04-14 10:08:53.552688	2016-04-14 10:08:53.552688	\N
82	\N	6	2016-04-14 10:08:53.56686	2016-04-14 10:08:53.56686	\N
83	\N	6	2016-04-14 10:08:53.577424	2016-04-14 10:08:53.577424	\N
84	\N	6	2016-04-14 10:08:53.591164	2016-04-14 10:08:53.591164	\N
85	\N	6	2016-04-14 10:08:53.602458	2016-04-14 10:08:53.602458	\N
86	\N	6	2016-04-14 10:08:53.613935	2016-04-14 10:08:53.613935	\N
87	\N	6	2016-04-14 10:08:53.624969	2016-04-14 10:08:53.624969	\N
88	\N	6	2016-04-14 10:08:53.636364	2016-04-14 10:08:53.636364	\N
89	\N	6	2016-04-14 10:08:53.647932	2016-04-14 10:08:53.647932	\N
90	\N	6	2016-04-14 10:08:53.660257	2016-04-14 10:08:53.660257	\N
91	\N	6	2016-04-14 10:08:53.728476	2016-04-14 10:08:53.728476	\N
92	\N	6	2016-04-14 10:08:53.805617	2016-04-14 10:08:53.805617	\N
93	\N	6	2016-04-14 10:08:53.818916	2016-04-14 10:08:53.818916	\N
94	\N	7	2016-04-14 10:08:53.838118	2016-04-14 10:08:53.838118	\N
95	\N	7	2016-04-14 10:08:53.85264	2016-04-14 10:08:53.85264	\N
96	\N	7	2016-04-14 10:08:53.864345	2016-04-14 10:08:53.864345	\N
97	\N	7	2016-04-14 10:08:53.876144	2016-04-14 10:08:53.876144	\N
98	\N	7	2016-04-14 10:08:53.887539	2016-04-14 10:08:53.887539	\N
99	\N	7	2016-04-14 10:08:53.898471	2016-04-14 10:08:53.898471	\N
100	\N	7	2016-04-14 10:08:53.90993	2016-04-14 10:08:53.90993	\N
101	\N	7	2016-04-14 10:08:53.920975	2016-04-14 10:08:53.920975	\N
102	\N	7	2016-04-14 10:08:53.931368	2016-04-14 10:08:53.931368	\N
103	\N	7	2016-04-14 10:08:53.942805	2016-04-14 10:08:53.942805	\N
104	\N	7	2016-04-14 10:08:53.95374	2016-04-14 10:08:53.95374	\N
105	\N	7	2016-04-14 10:08:53.965331	2016-04-14 10:08:53.965331	\N
106	\N	7	2016-04-14 10:08:53.976177	2016-04-14 10:08:53.976177	\N
107	\N	7	2016-04-14 10:08:53.986551	2016-04-14 10:08:53.986551	\N
108	\N	7	2016-04-14 10:08:53.997756	2016-04-14 10:08:53.997756	\N
109	\N	7	2016-04-14 10:08:54.008947	2016-04-14 10:08:54.008947	\N
110	\N	7	2016-04-14 10:08:54.019866	2016-04-14 10:08:54.019866	\N
111	\N	7	2016-04-14 10:08:54.030613	2016-04-14 10:08:54.030613	\N
112	\N	7	2016-04-14 10:08:54.041596	2016-04-14 10:08:54.041596	\N
113	\N	7	2016-04-14 10:08:54.052758	2016-04-14 10:08:54.052758	\N
114	\N	7	2016-04-14 10:08:54.06415	2016-04-14 10:08:54.06415	\N
115	\N	8	2016-04-14 10:08:54.082438	2016-04-14 10:08:54.082438	\N
116	\N	8	2016-04-14 10:08:54.145819	2016-04-14 10:08:54.145819	\N
\.


--
-- Name: filters_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('filters_id_seq', 116, true);


--
-- Data for Name: host_classes; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY host_classes (puppetclass_id, host_id, id) FROM stdin;
\.


--
-- Name: host_classes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('host_classes_id_seq', 1, false);


--
-- Data for Name: host_config_groups; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY host_config_groups (id, config_group_id, host_id, host_type, created_at, updated_at) FROM stdin;
\.


--
-- Name: host_config_groups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('host_config_groups_id_seq', 1, false);


--
-- Data for Name: hostgroup_classes; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY hostgroup_classes (hostgroup_id, puppetclass_id, id) FROM stdin;
\.


--
-- Name: hostgroup_classes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('hostgroup_classes_id_seq', 1, false);


--
-- Data for Name: hostgroups; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY hostgroups (id, name, created_at, updated_at, environment_id, operatingsystem_id, architecture_id, medium_id, ptable_id, root_pass, puppet_ca_proxy_id, use_image, image_file, ancestry, vm_defaults, subnet_id, domain_id, puppet_proxy_id, title, realm_id, compute_profile_id, grub_pass) FROM stdin;
9	CephMon	2016-04-14 10:43:41.443089	2016-04-14 10:53:45.244978	\N	\N	1	\N	\N	$1$ZMPVG3QR$qravQotMd0wuDSvttCCew1	\N	\N	\N	\N	\N	\N	\N	\N	CephMon	\N	\N	$1$r2MHWNWa$hU6gw1E3xfpJll3kpqXPg1
4	Compute	2016-04-14 10:42:52.681531	2016-04-14 10:53:59.61729	\N	\N	1	\N	\N	$1$bwrkoBAo$fzEAdYfnChdr6EckOOWdn/	\N	\N	\N	\N	\N	\N	\N	\N	Compute	\N	\N	$1$8Nmdk9cm$H26EIGwTUAtvdr2kogVfr.
2	Hypervisor	2016-04-14 10:42:35.964214	2016-04-14 10:55:17.562646	\N	\N	1	\N	\N	$1$9fmAnE3r$RcuivJbC20gxlKqEM8lx..	\N	\N	\N	\N	\N	\N	\N	\N	Hypervisor	\N	\N	$1$B1vaFy7d$l1Z6Qj6jDn8igL2mof5aF0
1	LB	2016-04-14 10:15:47.12547	2016-04-14 10:55:28.796191	\N	\N	1	\N	\N	$1$ePsF9DY+$/uOonaSgtIeRC/k7ZJlYf.	\N	\N	\N	\N	\N	\N	\N	\N	LB	\N	\N	$1$dZADAZt0$rtB0LjgJqyFNd7wyXHvS00
7	Memcached	2016-04-14 10:43:23.177554	2016-04-14 10:55:40.453043	\N	\N	1	\N	\N	$1$ljLD4ZB9$5iD6qpBMIiAnOHpqujkOX1	\N	\N	\N	\N	\N	\N	\N	\N	Memcached	\N	\N	$1$ui/sX1Xf$1g5Voh5Dms4NryrL2gSUM.
3	Network	2016-04-14 10:42:45.240657	2016-04-14 10:56:57.82998	\N	\N	1	\N	\N	$1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/	\N	\N	\N	\N	\N	\N	\N	\N	Network	\N	\N	$1$kCwW+SCk$n/31Ip3ddqMpmj7wTvrxG/
5	Web	2016-04-14 10:43:02.079271	2016-04-15 02:57:44.207737	\N	\N	1	\N	\N	$1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1	\N	\N	\N	\N	\N	\N	\N	\N	Web	\N	\N	$1$51P5CU9g$YxPm3.edOcJ1GuR9hVxJF1
8	Mysql	2016-04-14 10:43:31.601283	2016-04-15 02:57:52.934391	\N	\N	1	\N	\N	$1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90	\N	\N	\N	\N	\N	\N	\N	\N	Mysql	\N	\N	$1$Ag6abnYM$ZLB6/REEq1tNq3mfen1s90
6	MQ	2016-04-14 10:43:10.647301	2016-04-15 02:58:02.050452	\N	\N	1	\N	\N	$1$gH5dYc0/$vVrrWXgzGknocivizSMjU/	\N	\N	\N	\N	\N	\N	\N	\N	MQ	\N	\N	$1$gH5dYc0/$vVrrWXgzGknocivizSMjU/
10	Storage	2016-05-04 03:58:43.248717	2016-05-04 03:58:43.248717	1	1	1	\N	8		\N	\N	\N	\N	\N	\N	\N	\N	Storage	\N	\N	
\.


--
-- Name: hostgroups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('hostgroups_id_seq', 10, true);


--
-- Data for Name: hosts; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY hosts (id, name, last_compile, last_freshcheck, last_report, updated_at, source_file_id, created_at, root_pass, serial, puppet_status, architecture_id, operatingsystem_id, environment_id, ptable_id, medium_id, build, comment, disk, installed_at, model_id, hostgroup_id, owner_id, owner_type, enabled, puppet_ca_proxy_id, managed, use_image, image_file, uuid, compute_resource_id, puppet_proxy_id, certname, image_id, organization_id, location_id, type, otp, realm_id, compute_profile_id, provision_method, grub_pass) FROM stdin;
\.


--
-- Name: hosts_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('hosts_id_seq', 30, true);


--
-- Data for Name: images; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY images (id, operatingsystem_id, compute_resource_id, architecture_id, uuid, username, name, created_at, updated_at, iam_role, user_data, password) FROM stdin;
\.


--
-- Name: images_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('images_id_seq', 1, false);


--
-- Data for Name: key_pairs; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY key_pairs (id, secret, compute_resource_id, name, created_at, updated_at, public) FROM stdin;
\.


--
-- Name: key_pairs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('key_pairs_id_seq', 1, false);


--
-- Data for Name: locations_organizations; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY locations_organizations (location_id, organization_id) FROM stdin;
\.


--
-- Data for Name: logs; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY logs (id, source_id, message_id, report_id, level_id, created_at, updated_at) FROM stdin;
\.


--
-- Name: logs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('logs_id_seq', 1, false);


--
-- Data for Name: lookup_keys; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY lookup_keys (id, key, created_at, updated_at, puppetclass_id, default_value, path, description, validator_type, validator_rule, is_param, key_type, override, required, lookup_values_count, merge_overrides, avoid_duplicates, use_puppet_default) FROM stdin;
\.


--
-- Name: lookup_keys_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('lookup_keys_id_seq', 1, false);


--
-- Data for Name: lookup_values; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY lookup_values (id, match, value, lookup_key_id, created_at, updated_at, use_puppet_default) FROM stdin;
\.


--
-- Name: lookup_values_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('lookup_values_id_seq', 1, false);


--
-- Data for Name: mail_notifications; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY mail_notifications (id, name, description, mailer, method, subscriptable, default_interval, created_at, updated_at, subscription_type) FROM stdin;
1	puppet_summary	A summary of eventful puppet reports	HostMailer	summary	t	\N	2016-04-14 10:08:55.171185	2016-04-14 10:08:55.171185	report
2	puppet_error_state	A notification when a host reports a puppet error	HostMailer	error_state	t	\N	2016-04-14 10:08:55.174752	2016-04-14 10:08:55.174752	alert
3	welcome	A mail a user receives upon account creation	UserMailer	welcome	f	\N	2016-04-14 10:08:55.177381	2016-04-14 10:08:55.177381	\N
\.


--
-- Name: mail_notifications_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('mail_notifications_id_seq', 3, true);


--
-- Data for Name: media; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY media (id, name, path, created_at, updated_at, media_path, config_path, image_path, os_family) FROM stdin;
1	CentOS mirror	http://mirror.centos.org/centos/$version/os/$arch	2016-04-14 10:08:54.965218	2016-04-14 10:08:54.965218	\N	\N	\N	Redhat
2	Debian mirror	http://ftp.debian.org/debian	2016-04-14 10:08:54.972399	2016-04-14 10:08:54.972399	\N	\N	\N	Debian
3	Fedora mirror	http://dl.fedoraproject.org/pub/fedora/linux/releases/$major/Fedora/$arch/os/	2016-04-14 10:08:54.978368	2016-04-14 10:08:54.978368	\N	\N	\N	Redhat
4	FreeBSD mirror	http://ftp.freebsd.org/pub/FreeBSD/releases/$arch/$version-RELEASE/	2016-04-14 10:08:54.983801	2016-04-14 10:08:54.983801	\N	\N	\N	Freebsd
5	OpenSUSE mirror	http://download.opensuse.org/distribution/$version/repo/oss	2016-04-14 10:08:54.989242	2016-04-14 10:08:54.989242	\N	\N	\N	Suse
6	Ubuntu mirror	http://archive.ubuntu.com/ubuntu	2016-04-14 10:08:54.995092	2016-04-14 10:08:54.995092	\N	\N	\N	Debian
7	CoreOS mirror	http://$release.release.core-os.net	2016-04-14 10:08:55.001022	2016-04-14 10:08:55.001022	\N	\N	\N	Coreos
\.


--
-- Name: media_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('media_id_seq', 9, true);


--
-- Data for Name: media_operatingsystems; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY media_operatingsystems (medium_id, operatingsystem_id) FROM stdin;
\.


--
-- Data for Name: messages; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY messages (id, value, digest) FROM stdin;
\.


--
-- Name: messages_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('messages_id_seq', 1, false);


--
-- Data for Name: models; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY models (id, name, info, created_at, updated_at, vendor_class, hardware_model, hosts_count) FROM stdin;
\.


--
-- Name: models_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('models_id_seq', 1, false);


--
-- Data for Name: nics; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY nics (id, mac, ip, type, name, host_id, subnet_id, domain_id, attrs, created_at, updated_at, provider, username, password, virtual, link, identifier, tag, attached_to, managed, mode, attached_devices, bond_options, "primary", provision, compute_attributes) FROM stdin;
\.


--
-- Name: nics_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('nics_id_seq', 29, true);


--
-- Data for Name: operatingsystems; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY operatingsystems (id, major, name, minor, nameindicator, created_at, updated_at, release_name, type, description, hosts_count, hostgroups_count, password_hash, title) FROM stdin;
2	6	CentOS	5	\N	2016-04-14 10:49:23.641972	2016-04-14 10:49:50.093831		Redhat		0	0	MD5	CentOS 6.5
1	7	CentOS7.1	1	\N	2016-04-14 10:36:00.795067	2016-04-14 10:36:00.795067		Redhat	CentOS 7.1	0	1	MD5	CentOS 7.1
\.


--
-- Name: operatingsystems_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('operatingsystems_id_seq', 2, true);


--
-- Data for Name: operatingsystems_ptables; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY operatingsystems_ptables (ptable_id, operatingsystem_id) FROM stdin;
8	1
\.


--
-- Data for Name: operatingsystems_puppetclasses; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY operatingsystems_puppetclasses (puppetclass_id, operatingsystem_id) FROM stdin;
\.


--
-- Data for Name: os_default_templates; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY os_default_templates (id, config_template_id, template_kind_id, operatingsystem_id, created_at, updated_at) FROM stdin;
1	47	4	1	2016-04-14 10:41:16.991292	2016-04-14 10:41:16.991292
2	46	1	1	2016-04-14 10:41:16.994176	2016-04-14 10:41:16.994176
\.


--
-- Name: os_default_templates_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('os_default_templates_id_seq', 2, true);


--
-- Data for Name: parameters; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY parameters (id, name, value, reference_id, created_at, updated_at, type, priority, hidden_value) FROM stdin;
1	foreman_server	10.0.100.31	\N	2016-04-14 10:44:25.361454	2016-05-05 07:31:41.687372	CommonParameter	0	f
2	ntp_server	10.0.100.31	\N	2016-04-14 10:44:37.087189	2016-05-05 07:31:45.137604	CommonParameter	0	f
4	puppet_server	10.0.100.31	\N	2016-04-14 10:45:06.330857	2016-05-05 07:31:48.385657	CommonParameter	0	f
3	yum_server	10.0.100.31	\N	2016-04-14 10:44:50.744433	2016-05-05 07:32:09.929531	CommonParameter	0	f
5	puppet_master_domain	puppet.0.uc.ustack.in	\N	2016-05-13 15:38:44.631246	2016-05-13 15:38:44.631246	CommonParameter	0	f
\.


--
-- Name: parameters_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('parameters_id_seq', 5, true);


--
-- Data for Name: permissions; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY permissions (id, name, resource_type, created_at, updated_at) FROM stdin;
1	view_architectures	Architecture	2016-04-14 10:08:38.350636	2016-04-14 10:08:38.350636
2	create_architectures	Architecture	2016-04-14 10:08:38.354746	2016-04-14 10:08:38.354746
3	edit_architectures	Architecture	2016-04-14 10:08:38.357242	2016-04-14 10:08:38.357242
4	destroy_architectures	Architecture	2016-04-14 10:08:38.360017	2016-04-14 10:08:38.360017
5	view_audit_logs	Audit	2016-04-14 10:08:38.362484	2016-04-14 10:08:38.362484
6	view_authenticators	AuthSourceLdap	2016-04-14 10:08:38.364825	2016-04-14 10:08:38.364825
7	create_authenticators	AuthSourceLdap	2016-04-14 10:08:38.36718	2016-04-14 10:08:38.36718
8	edit_authenticators	AuthSourceLdap	2016-04-14 10:08:38.36942	2016-04-14 10:08:38.36942
9	destroy_authenticators	AuthSourceLdap	2016-04-14 10:08:38.371679	2016-04-14 10:08:38.371679
10	view_bookmarks	Bookmark	2016-04-14 10:08:38.373865	2016-04-14 10:08:38.373865
11	create_bookmarks	Bookmark	2016-04-14 10:08:38.375959	2016-04-14 10:08:38.375959
12	edit_bookmarks	Bookmark	2016-04-14 10:08:38.378098	2016-04-14 10:08:38.378098
13	destroy_bookmarks	Bookmark	2016-04-14 10:08:38.380332	2016-04-14 10:08:38.380332
14	view_compute_profiles	ComputeProfile	2016-04-14 10:08:38.382606	2016-04-14 10:08:38.382606
15	create_compute_profiles	ComputeProfile	2016-04-14 10:08:38.384771	2016-04-14 10:08:38.384771
16	edit_compute_profiles	ComputeProfile	2016-04-14 10:08:38.386913	2016-04-14 10:08:38.386913
17	destroy_compute_profiles	ComputeProfile	2016-04-14 10:08:38.389212	2016-04-14 10:08:38.389212
18	view_compute_resources	ComputeResource	2016-04-14 10:08:38.391528	2016-04-14 10:08:38.391528
19	create_compute_resources	ComputeResource	2016-04-14 10:08:38.393871	2016-04-14 10:08:38.393871
20	edit_compute_resources	ComputeResource	2016-04-14 10:08:38.396046	2016-04-14 10:08:38.396046
21	destroy_compute_resources	ComputeResource	2016-04-14 10:08:38.398189	2016-04-14 10:08:38.398189
22	view_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.40045	2016-04-14 10:08:38.40045
23	create_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.402792	2016-04-14 10:08:38.402792
24	edit_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.405065	2016-04-14 10:08:38.405065
25	destroy_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.407248	2016-04-14 10:08:38.407248
26	power_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.40945	2016-04-14 10:08:38.40945
27	console_compute_resources_vms	ComputeResource	2016-04-14 10:08:38.412007	2016-04-14 10:08:38.412007
28	view_templates	ConfigTemplate	2016-04-14 10:08:38.414204	2016-04-14 10:08:38.414204
29	create_templates	ConfigTemplate	2016-04-14 10:08:38.416414	2016-04-14 10:08:38.416414
30	edit_templates	ConfigTemplate	2016-04-14 10:08:38.418844	2016-04-14 10:08:38.418844
31	destroy_templates	ConfigTemplate	2016-04-14 10:08:38.421238	2016-04-14 10:08:38.421238
32	deploy_templates	ConfigTemplate	2016-04-14 10:08:38.423632	2016-04-14 10:08:38.423632
33	lock_templates	ConfigTemplate	2016-04-14 10:08:38.426102	2016-04-14 10:08:38.426102
34	view_config_groups	ConfigGroup	2016-04-14 10:08:38.428605	2016-04-14 10:08:38.428605
35	create_config_groups	ConfigGroup	2016-04-14 10:08:38.431049	2016-04-14 10:08:38.431049
36	edit_config_groups	ConfigGroup	2016-04-14 10:08:38.433662	2016-04-14 10:08:38.433662
37	destroy_config_groups	ConfigGroup	2016-04-14 10:08:38.436178	2016-04-14 10:08:38.436178
38	access_dashboard	\N	2016-04-14 10:08:38.438554	2016-04-14 10:08:38.438554
39	view_domains	Domain	2016-04-14 10:08:38.441021	2016-04-14 10:08:38.441021
40	create_domains	Domain	2016-04-14 10:08:38.443331	2016-04-14 10:08:38.443331
41	edit_domains	Domain	2016-04-14 10:08:38.445544	2016-04-14 10:08:38.445544
42	destroy_domains	Domain	2016-04-14 10:08:38.447861	2016-04-14 10:08:38.447861
43	view_environments	Environment	2016-04-14 10:08:38.450145	2016-04-14 10:08:38.450145
44	create_environments	Environment	2016-04-14 10:08:38.452383	2016-04-14 10:08:38.452383
45	edit_environments	Environment	2016-04-14 10:08:38.454534	2016-04-14 10:08:38.454534
46	destroy_environments	Environment	2016-04-14 10:08:38.456714	2016-04-14 10:08:38.456714
47	import_environments	Environment	2016-04-14 10:08:38.458923	2016-04-14 10:08:38.458923
48	view_external_usergroups	ExternalUsergroups	2016-04-14 10:08:38.461087	2016-04-14 10:08:38.461087
49	create_external_usergroups	ExternalUsergroups	2016-04-14 10:08:38.463377	2016-04-14 10:08:38.463377
50	edit_external_usergroups	ExternalUsergroups	2016-04-14 10:08:38.465717	2016-04-14 10:08:38.465717
51	destroy_external_usergroups	ExternalUsergroups	2016-04-14 10:08:38.467955	2016-04-14 10:08:38.467955
52	view_external_variables	LookupKey	2016-04-14 10:08:38.4702	2016-04-14 10:08:38.4702
53	create_external_variables	LookupKey	2016-04-14 10:08:38.472526	2016-04-14 10:08:38.472526
54	edit_external_variables	LookupKey	2016-04-14 10:08:38.474884	2016-04-14 10:08:38.474884
55	destroy_external_variables	LookupKey	2016-04-14 10:08:38.477218	2016-04-14 10:08:38.477218
56	view_facts	FactValue	2016-04-14 10:08:38.479541	2016-04-14 10:08:38.479541
57	upload_facts	FactValue	2016-04-14 10:08:38.481859	2016-04-14 10:08:38.481859
58	view_filters	Filter	2016-04-14 10:08:38.4842	2016-04-14 10:08:38.4842
59	create_filters	Filter	2016-04-14 10:08:38.486592	2016-04-14 10:08:38.486592
60	edit_filters	Filter	2016-04-14 10:08:38.488909	2016-04-14 10:08:38.488909
61	destroy_filters	Filter	2016-04-14 10:08:38.491212	2016-04-14 10:08:38.491212
62	view_globals	CommonParameter	2016-04-14 10:08:38.493489	2016-04-14 10:08:38.493489
63	create_globals	CommonParameter	2016-04-14 10:08:38.49581	2016-04-14 10:08:38.49581
64	edit_globals	CommonParameter	2016-04-14 10:08:38.498087	2016-04-14 10:08:38.498087
65	destroy_globals	CommonParameter	2016-04-14 10:08:38.500356	2016-04-14 10:08:38.500356
66	edit_classes	HostClass	2016-04-14 10:08:38.502603	2016-04-14 10:08:38.502603
67	create_params	Parameter	2016-04-14 10:08:38.504917	2016-04-14 10:08:38.504917
68	edit_params	Parameter	2016-04-14 10:08:38.50722	2016-04-14 10:08:38.50722
69	destroy_params	Parameter	2016-04-14 10:08:38.509504	2016-04-14 10:08:38.509504
70	view_hostgroups	Hostgroup	2016-04-14 10:08:38.51191	2016-04-14 10:08:38.51191
71	create_hostgroups	Hostgroup	2016-04-14 10:08:38.5143	2016-04-14 10:08:38.5143
72	edit_hostgroups	Hostgroup	2016-04-14 10:08:38.516627	2016-04-14 10:08:38.516627
73	destroy_hostgroups	Hostgroup	2016-04-14 10:08:38.518987	2016-04-14 10:08:38.518987
74	view_hosts	Host	2016-04-14 10:08:38.521297	2016-04-14 10:08:38.521297
75	create_hosts	Host	2016-04-14 10:08:38.52363	2016-04-14 10:08:38.52363
76	edit_hosts	Host	2016-04-14 10:08:38.525966	2016-04-14 10:08:38.525966
77	destroy_hosts	Host	2016-04-14 10:08:38.528285	2016-04-14 10:08:38.528285
78	build_hosts	Host	2016-04-14 10:08:38.530589	2016-04-14 10:08:38.530589
79	power_hosts	Host	2016-04-14 10:08:38.53295	2016-04-14 10:08:38.53295
80	console_hosts	Host	2016-04-14 10:08:38.535492	2016-04-14 10:08:38.535492
81	ipmi_boot	Host	2016-04-14 10:08:38.53786	2016-04-14 10:08:38.53786
82	puppetrun_hosts	Host	2016-04-14 10:08:38.540202	2016-04-14 10:08:38.540202
83	view_images	Image	2016-04-14 10:08:38.542519	2016-04-14 10:08:38.542519
84	create_images	Image	2016-04-14 10:08:38.544817	2016-04-14 10:08:38.544817
85	edit_images	Image	2016-04-14 10:08:38.547079	2016-04-14 10:08:38.547079
86	destroy_images	Image	2016-04-14 10:08:38.549372	2016-04-14 10:08:38.549372
87	view_locations	Location	2016-04-14 10:08:38.551606	2016-04-14 10:08:38.551606
88	create_locations	Location	2016-04-14 10:08:38.553885	2016-04-14 10:08:38.553885
89	edit_locations	Location	2016-04-14 10:08:38.556193	2016-04-14 10:08:38.556193
90	destroy_locations	Location	2016-04-14 10:08:38.558512	2016-04-14 10:08:38.558512
91	assign_locations	Location	2016-04-14 10:08:38.560835	2016-04-14 10:08:38.560835
92	view_mail_notifications	MailNotification	2016-04-14 10:08:38.563091	2016-04-14 10:08:38.563091
93	view_media	Medium	2016-04-14 10:08:38.565378	2016-04-14 10:08:38.565378
94	create_media	Medium	2016-04-14 10:08:38.567626	2016-04-14 10:08:38.567626
95	edit_media	Medium	2016-04-14 10:08:38.569903	2016-04-14 10:08:38.569903
96	destroy_media	Medium	2016-04-14 10:08:38.5722	2016-04-14 10:08:38.5722
97	view_models	Model	2016-04-14 10:08:38.574513	2016-04-14 10:08:38.574513
98	create_models	Model	2016-04-14 10:08:38.576872	2016-04-14 10:08:38.576872
99	edit_models	Model	2016-04-14 10:08:38.579232	2016-04-14 10:08:38.579232
100	destroy_models	Model	2016-04-14 10:08:38.581712	2016-04-14 10:08:38.581712
101	view_operatingsystems	Operatingsystem	2016-04-14 10:08:38.583923	2016-04-14 10:08:38.583923
102	create_operatingsystems	Operatingsystem	2016-04-14 10:08:38.586126	2016-04-14 10:08:38.586126
103	edit_operatingsystems	Operatingsystem	2016-04-14 10:08:38.588592	2016-04-14 10:08:38.588592
104	destroy_operatingsystems	Operatingsystem	2016-04-14 10:08:38.590917	2016-04-14 10:08:38.590917
105	view_organizations	Organization	2016-04-14 10:08:38.593249	2016-04-14 10:08:38.593249
106	create_organizations	Organization	2016-04-14 10:08:38.595625	2016-04-14 10:08:38.595625
107	edit_organizations	Organization	2016-04-14 10:08:38.597976	2016-04-14 10:08:38.597976
108	destroy_organizations	Organization	2016-04-14 10:08:38.600277	2016-04-14 10:08:38.600277
109	assign_organizations	Organization	2016-04-14 10:08:38.602578	2016-04-14 10:08:38.602578
110	view_ptables	Ptable	2016-04-14 10:08:38.604915	2016-04-14 10:08:38.604915
111	create_ptables	Ptable	2016-04-14 10:08:38.681384	2016-04-14 10:08:38.681384
112	edit_ptables	Ptable	2016-04-14 10:08:38.683786	2016-04-14 10:08:38.683786
113	destroy_ptables	Ptable	2016-04-14 10:08:38.686019	2016-04-14 10:08:38.686019
114	view_plugins	\N	2016-04-14 10:08:38.688157	2016-04-14 10:08:38.688157
115	view_puppetclasses	Puppetclass	2016-04-14 10:08:38.690379	2016-04-14 10:08:38.690379
116	create_puppetclasses	Puppetclass	2016-04-14 10:08:38.692508	2016-04-14 10:08:38.692508
117	edit_puppetclasses	Puppetclass	2016-04-14 10:08:38.694795	2016-04-14 10:08:38.694795
118	destroy_puppetclasses	Puppetclass	2016-04-14 10:08:38.69704	2016-04-14 10:08:38.69704
119	import_puppetclasses	Puppetclass	2016-04-14 10:08:38.699256	2016-04-14 10:08:38.699256
120	view_realms	Realm	2016-04-14 10:08:38.701548	2016-04-14 10:08:38.701548
121	create_realms	Realm	2016-04-14 10:08:38.703845	2016-04-14 10:08:38.703845
122	edit_realms	Realm	2016-04-14 10:08:38.706084	2016-04-14 10:08:38.706084
123	destroy_realms	Realm	2016-04-14 10:08:38.708344	2016-04-14 10:08:38.708344
124	view_reports	Report	2016-04-14 10:08:38.710604	2016-04-14 10:08:38.710604
125	destroy_reports	Report	2016-04-14 10:08:38.712871	2016-04-14 10:08:38.712871
126	upload_reports	Report	2016-04-14 10:08:38.715005	2016-04-14 10:08:38.715005
127	view_roles	Role	2016-04-14 10:08:38.717189	2016-04-14 10:08:38.717189
128	create_roles	Role	2016-04-14 10:08:38.71947	2016-04-14 10:08:38.71947
129	edit_roles	Role	2016-04-14 10:08:38.721721	2016-04-14 10:08:38.721721
130	destroy_roles	Role	2016-04-14 10:08:38.723914	2016-04-14 10:08:38.723914
131	access_settings	\N	2016-04-14 10:08:38.726105	2016-04-14 10:08:38.726105
132	view_smart_proxies	SmartProxy	2016-04-14 10:08:38.730927	2016-04-14 10:08:38.730927
133	create_smart_proxies	SmartProxy	2016-04-14 10:08:38.734533	2016-04-14 10:08:38.734533
134	edit_smart_proxies	SmartProxy	2016-04-14 10:08:38.736932	2016-04-14 10:08:38.736932
135	destroy_smart_proxies	SmartProxy	2016-04-14 10:08:38.739276	2016-04-14 10:08:38.739276
136	view_smart_proxies_autosign	SmartProxy	2016-04-14 10:08:38.741637	2016-04-14 10:08:38.741637
137	create_smart_proxies_autosign	SmartProxy	2016-04-14 10:08:38.744035	2016-04-14 10:08:38.744035
138	destroy_smart_proxies_autosign	SmartProxy	2016-04-14 10:08:38.746407	2016-04-14 10:08:38.746407
139	view_smart_proxies_puppetca	SmartProxy	2016-04-14 10:08:38.748677	2016-04-14 10:08:38.748677
140	edit_smart_proxies_puppetca	SmartProxy	2016-04-14 10:08:38.750923	2016-04-14 10:08:38.750923
141	destroy_smart_proxies_puppetca	SmartProxy	2016-04-14 10:08:38.753221	2016-04-14 10:08:38.753221
142	view_statistics	\N	2016-04-14 10:08:38.755569	2016-04-14 10:08:38.755569
143	view_subnets	Subnet	2016-04-14 10:08:38.757958	2016-04-14 10:08:38.757958
144	create_subnets	Subnet	2016-04-14 10:08:38.760304	2016-04-14 10:08:38.760304
145	edit_subnets	Subnet	2016-04-14 10:08:38.762614	2016-04-14 10:08:38.762614
146	destroy_subnets	Subnet	2016-04-14 10:08:38.764993	2016-04-14 10:08:38.764993
147	import_subnets	Subnet	2016-04-14 10:08:38.767306	2016-04-14 10:08:38.767306
148	view_tasks	\N	2016-04-14 10:08:38.769556	2016-04-14 10:08:38.769556
149	view_trends	Trend	2016-04-14 10:08:38.771891	2016-04-14 10:08:38.771891
150	create_trends	Trend	2016-04-14 10:08:38.774324	2016-04-14 10:08:38.774324
151	edit_trends	Trend	2016-04-14 10:08:38.776698	2016-04-14 10:08:38.776698
152	destroy_trends	Trend	2016-04-14 10:08:38.779116	2016-04-14 10:08:38.779116
153	update_trends	Trend	2016-04-14 10:08:38.781478	2016-04-14 10:08:38.781478
154	view_usergroups	Usergroup	2016-04-14 10:08:38.783918	2016-04-14 10:08:38.783918
155	create_usergroups	Usergroup	2016-04-14 10:08:38.786605	2016-04-14 10:08:38.786605
156	edit_usergroups	Usergroup	2016-04-14 10:08:38.788994	2016-04-14 10:08:38.788994
157	destroy_usergroups	Usergroup	2016-04-14 10:08:38.791353	2016-04-14 10:08:38.791353
158	view_users	User	2016-04-14 10:08:38.793712	2016-04-14 10:08:38.793712
159	create_users	User	2016-04-14 10:08:38.796096	2016-04-14 10:08:38.796096
160	edit_users	User	2016-04-14 10:08:38.798445	2016-04-14 10:08:38.798445
161	destroy_users	User	2016-04-14 10:08:38.80087	2016-04-14 10:08:38.80087
\.


--
-- Name: permissions_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('permissions_id_seq', 161, true);


--
-- Data for Name: ptables; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY ptables (id, name, layout, created_at, updated_at, os_family) FROM stdin;
1	AutoYaST entire SCSI disk	<%#\nkind: ptable\nname: AutoYaST entire SCSI disk\n%>\n  <partitioning  config:type="list">\n    <drive>\n      <device>/dev/sda</device>\n      <use>all</use>\n    </drive>\n  </partitioning>\n	2016-04-14 10:08:54.83111	2016-04-14 10:08:54.83111	Suse
2	AutoYaST entire virtual disk	<%#\nkind: ptable\nname: AutoYaST entire virtual disk\n%>\n  <partitioning  config:type="list">\n    <drive>\n      <device>/dev/vda</device>\n      <use>all</use>\n    </drive>\n  </partitioning>\n	2016-04-14 10:08:54.83625	2016-04-14 10:08:54.83625	Suse
3	AutoYaST LVM	<%#\nkind: ptable\nname: AutoYaST LVM\n%>\n  <partitioning config:type="list">\n    <drive>\n      <device>/dev/sda</device>\n      <initialize config:type="boolean">true</initialize>\n      <partitions config:type="list">\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">ext3</filesystem>\n          <format config:type="boolean">true</format>\n          <mount>/boot</mount>\n          <partition_id config:type="integer">131</partition_id>\n          <partition_nr config:type="integer">1</partition_nr>\n          <size>1G</size>\n          <stripes config:type="integer">1</stripes>\n          <stripesize config:type="integer">4</stripesize>\n          <subvolumes config:type="list"/>\n        </partition>\n        <partition>\n          <create config:type="boolean">true</create>\n          <format config:type="boolean">false</format>\n          <lvm_group>vg00</lvm_group>\n          <partition_id config:type="integer">142</partition_id>\n          <partition_nr config:type="integer">2</partition_nr>\n          <size>max</size>\n        </partition>\n      </partitions>\n      <pesize></pesize>\n      <type config:type="symbol">CT_DISK</type>\n      <use>all</use>\n    </drive>\n    <drive>\n      <device>/dev/vg00</device>\n      <initialize config:type="boolean">true</initialize>\n      <partitions config:type="list">\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">ext3</filesystem>\n          <format config:type="boolean">true</format>\n          <lv_name>root</lv_name>\n          <mount>/</mount>\n          <size>4G</size>\n        </partition>\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">swap</filesystem>\n          <format config:type="boolean">true</format>\n          <lv_name>swap</lv_name>\n          <mount>swap</mount>\n          <size>8G</size>\n        </partition>\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">ext3</filesystem>\n          <format config:type="boolean">true</format>\n          <lv_name>usr</lv_name>\n          <mount>/usr</mount>\n          <size>8G</size>\n        </partition>\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">ext3</filesystem>\n          <format config:type="boolean">true</format>\n          <lv_name>tmp</lv_name>\n          <mount>/tmp</mount>\n          <size>4G</size>\n        </partition>\n        <partition>\n          <create config:type="boolean">true</create>\n          <filesystem config:type="symbol">ext3</filesystem>\n          <format config:type="boolean">true</format>\n          <lv_name>var</lv_name>\n          <mount>/var</mount>\n          <size>4G</size>\n        </partition>\n      </partitions>\n      <type config:type="symbol">CT_LVM</type>\n      <use>all</use>\n    </drive>\n  </partitioning>\n	2016-04-14 10:08:54.840893	2016-04-14 10:08:54.840893	Suse
4	CoreOS default fake	<%#\nkind: ptable\nname: CoreOS default fake\noses:\n- CoreOS\n%>\n# Not supported with coreos-install\n	2016-04-14 10:08:54.845782	2016-04-14 10:08:54.845782	Coreos
5	FreeBSD	<%#\nkind: ptable\nname: FreeBSD default fake\noses:\n- FreeBSD 10.0\n%>\n# Not supported with zfsinstall\n	2016-04-14 10:08:54.850458	2016-04-14 10:08:54.850458	Freebsd
6	Jumpstart default	<%#\nkind: ptable\nname: Jumpstart default\n%>\nfilesys c0t0d0s0 7000 /\nfilesys c0t0d0s1 1000 swap\nfilesys c0t0d0s3 15 unnamed\nfilesys c0t0d0s7 free /tmp2\n	2016-04-14 10:08:54.855139	2016-04-14 10:08:54.855139	Solaris
7	Jumpstart mirrored	<%#\nkind: ptable\nname: Jumpstart mirrored\n%>\nfilesys mirror:d10 c1t0d0s0 c1t1d0s0 16000 /\nfilesys mirror:d20 c1t0d0s1 c1t1d0s1 8000 swap\nfilesys mirror:d40 c1t0d0s4 c1t1d0s4 free /var/tmp\nmetadb c1t0d0s7 size 8192 count 3\nmetadb c1t1d0s7 size 8192 count 3\n	2016-04-14 10:08:54.85952	2016-04-14 10:08:54.85952	Solaris
8	Kickstart default	<%#\nkind: ptable\nname: Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- Fedora 16\n- Fedora 17\n- Fedora 18\n- Fedora 19\n- Fedora 20\n- RedHat 5\n- RedHat 6\n- RedHat 7\n%>\nzerombr\nclearpart --all --initlabel\nautopart\n\n	2016-04-14 10:08:54.864006	2016-04-14 10:08:54.864006	Redhat
9	Preseed default	<%#\nkind: ptable\nname: Preseed default\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n- Ubuntu 14.04\n%>\n\n<% if @host.params['install-disk'] -%>\nd-i partman-auto/disk string <%= @host.params['install-disk'] %>\n<% else -%>\nd-i partman-auto/disk string /dev/sda /dev/vda\n<% end -%>\n\n### Partitioning\n# The presently available methods are: "regular", "lvm" and "crypto"\n<% if @host.params['partitioning-method'] -%>\nd-i partman-auto/method string <%= @host.params['partitioning-method'] %>\n<% else -%>\nd-i partman-auto/method string regular\n<% end -%>\n\n# If one of the disks that are going to be automatically partitioned\n# contains an old LVM configuration, the user will normally receive a\n# warning. This can be preseeded away...\nd-i partman-lvm/device_remove_lvm boolean true\n# The same applies to pre-existing software RAID array:\nd-i partman-md/device_remove_md boolean true\n# And the same goes for the confirmation to write the lvm partitions.\nd-i partman-lvm/confirm boolean true\nd-i partman-lvm/confirm_nooverwrite boolean true\n\n<% if @host.params['partitioning-method'] && @host.params['partitioning-method'] == 'lvm' -%>\n# For LVM partitioning, you can select how much of the volume group to use\n# for logical volumes.\nd-i partman-auto-lvm/guided_size string max\n<% end -%>\n\n# You can choose one of the three predefined partitioning recipes:\n# - atomic: all files in one partition\n# - home:   separate /home partition\n# - multi:  separate /home, /usr, /var, and /tmp partitions\n<% if @host.params['partitioning-recipe'] -%>\nd-i partman-auto/choose_recipe select <%= @host.params['partitioning-recipe'] %>\n<% else -%>\nd-i partman-auto/choose_recipe select atomic\n<% end -%>\n\n# If you just want to change the default filesystem from ext3 to something\n# else, you can do that without providing a full recipe.\n<% if @host.params['partitioning-filesystem'] -%>\nd-i partman/default_filesystem string <%= @host.params['partitioning-filesystem'] %>\n<% end %>\n\n# This makes partman automatically partition without confirmation, provided\n# that you told it what to do using one of the methods above.\nd-i partman/confirm_write_new_label boolean true\nd-i partman/choose_partition select finish\nd-i partman/confirm boolean true\nd-i partman/confirm_nooverwrite boolean true\n	2016-04-14 10:08:54.868723	2016-04-14 10:08:54.868723	Debian
10	Preseed custom LVM	<%#\nkind: ptable\nname: Preseed custom LVM\noses:\n- Debian 6.0\n- Debian 7.\n- Debian 8.\n- Ubuntu 10.04\n- Ubuntu 12.04\n- Ubuntu 13.04\n- Ubuntu 14.04\n%>\n<% if @host.params['install-disk'] -%>\nd-i partman-auto/disk string <%= @host.params['install-disk'] %>\n<% else -%>\nd-i partman-auto/disk string /dev/sda /dev/vda\n<% end -%>\nd-i partman-auto/method string lvm\n\nd-i partman-lvm/device_remove_lvm boolean true\nd-i partman-md/device_remove_md boolean true\nd-i partman-lvm/confirm boolean true\nd-i partman-lvm/confirm_nooverwrite boolean true\n\nd-i partman-auto/init_automatically_partition \\\n\tselect Guided - use entire disk and set up LVM\n\nd-i partman-auto-lvm/guided_size string max\nd-i partman-auto-lvm/new_vg_name string vg00\n\nd-i partman-auto/expert_recipe string                         \\\n      boot-root ::                                            \\\n              64 128 128 ext3                                 \\\n                      $primary{ } $bootable{ }                \\\n                      method{ format } format{ }              \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ /boot }                     \\\n              .                                               \\\n              128 512 200% linux-swap                         \\\n                      method{ swap } format{ }                \\\n              .                                               \\\n              512 512 512 ext3                                \\\n                      method{ format } format{ } $lvmok{ }    \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ / }                         \\\n              .                                               \\\n              256 256 256 ext3                                \\\n                      method{ format } format{ } $lvmok{ }    \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ /home }                     \\\n              .                                               \\\n              256 512 512 ext3                                \\\n                      method{ format } format{ } $lvmok{ }    \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ /tmp }                      \\\n              .                                               \\\n              2048 4096 4096 ext3                             \\\n                      method{ format } format{ } $lvmok{ }    \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ /usr }                      \\\n              .                                               \\\n              2048 4096 -1 ext3                               \\\n                      method{ format } format{ } $lvmok{ }    \\\n                      use_filesystem{ } filesystem{ ext4 }    \\\n                      mountpoint{ /var }                      \\\n              .\n\nd-i partman/default_filesystem string ext4\n\nd-i partman/confirm_write_new_label boolean true\nd-i partman/choose_partition select finish\nd-i partman/confirm boolean true\nd-i partman/confirm_nooverwrite boolean true\n	2016-04-14 10:08:54.873315	2016-04-14 10:08:54.873315	Debian
11	Junos default fake	<%#\nkind: ptable\nname: Junos default fake\n%>\n# Not required for Junos ZTP provisioning.\n	2016-04-14 10:08:54.87811	2016-04-14 10:08:54.87811	Junos
\.


--
-- Name: ptables_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('ptables_id_seq', 11, true);


--
-- Data for Name: puppetclasses; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY puppetclasses (id, name, created_at, updated_at, total_hosts, hostgroups_count, global_class_params_count, lookup_keys_count) FROM stdin;
\.


--
-- Name: puppetclasses_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('puppetclasses_id_seq', 1, false);


--
-- Data for Name: realms; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY realms (id, name, realm_type, realm_proxy_id, hosts_count, hostgroups_count, created_at, updated_at) FROM stdin;
\.


--
-- Name: realms_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('realms_id_seq', 1, false);


--
-- Data for Name: reports; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY reports (id, host_id, reported_at, created_at, updated_at, status, metrics) FROM stdin;
\.


--
-- Name: reports_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('reports_id_seq', 1, false);


--
-- Data for Name: roles; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY roles (id, name, builtin, permissions) FROM stdin;
1	Manager	0	\N
2	Edit partition tables	0	\N
3	View hosts	0	\N
4	Edit hosts	0	\N
5	Viewer	0	\N
6	Site manager	0	\N
7	Default user	1	\N
8	Anonymous	2	\N
\.


--
-- Name: roles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('roles_id_seq', 8, true);


--
-- Data for Name: schema_migrations; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY schema_migrations (version) FROM stdin;
20090714132448
20090714132449
20090715143858
20090717025820
20090718060746
20090718064254
20090720134126
20090722140138
20090722141107
20090729132209
20090730152224
20090802062223
20090804130144
20090820130541
20090905150131
20090905155444
20090907045751
20090915030726
20090916053824
20090920043521
20090920064156
20090920065522
20091012135004
20091016031017
20091022054108
20091214045923
20091219132338
20091219132839
20100115021803
20100310080727
20100325142616
20100414125652
20100416124600
20100419151910
20100523114430
20100523141204
20100524080302
20100525094200
20100601221000
20100616114400
20100625155400
20100628123400
20100629093200
20100701081235
20100822072954
20100823181036
20100914092104
20101018120548
20101018120603
20101018120621
20101019122857
20101019183859
20101103150254
20101118130026
20101121080425
20101121135521
20101122132041
20101123152150
20101123153303
20101125153351
20101130093613
20101130100315
20101202104444
20101213085232
20110117162722
20110128130239
20110213104226
20110216101848
20110301154453
20110321070954
20110327123639
20110404150043
20110407091150
20110412103238
20110417102947
20110420150600
20110613141800
20110616080444
20110617190131
20110619130336
20110628115422
20110712064120
20110712070522
20110725142054
20110801090318
20110803114134
20111124095053
20111124095054
20111124095055
20111205231500
20111227095806
20120102071633
20120110113051
20120122131037
20120126113850
20120127141602
20120311081257
20120313081913
20120502105518
20120506143325
20120509131302
20120510113417
20120521142924
20120523065531
20120529113900
20120529115814
20120604114049
20120607074318
20120612070100
20120613082125
20120620124658
20120620124659
20120621135042
20120623002052
20120624081510
20120624093958
20120624094034
20120705130038
20120824142048
20120905095532
20120905131841
20120916080843
20120916080926
20120921000313
20120921105349
20120927020752
20121003172526
20121011115320
20121012170851
20121012170936
20121015113502
20121018152459
20121026160433
20121029164911
20121101141448
20121118120028
20121118125341
20121119102104
20121210214810
20121218084123
20121219040534
20130109155024
20130121130826
20130211160200
20130228145456
20130329195742
20130409081924
20130417110127
20130418134513
20130419145808
20130430150500
20130520152000
20130520161514
20130523131455
20130530061844
20130625113217
20130725081334
20130804131949
20130813105054
20130814132531
20130908100439
20130908170524
20130924145800
20131003143143
20131014133347
20131017142515
20131021125612
20131021152315
20131104132542
20131107094849
20131114084718
20131114094841
20131122093940
20131122150434
20131122170726
20131125230654
20131127112625
20131128150357
20131202120621
20131202131847
20131202144415
20131204174455
20131212125626
20131223120945
20131224153518
20131224153743
20131224154836
20140110164135
20140115130443
20140123185537
20140123194519
20140128123153
20140219183342
20140219183343
20140219183345
20140304184854
20140314004243
20140318153157
20140318221513
20140320000449
20140320004050
20140325093623
20140407161817
20140407162007
20140407162059
20140409031625
20140410134234
20140413123650
20140415032811
20140415052549
20140415053029
20140522122215
20140623144932
20140630114339
20140705173549
20140707113214
20140710132249
20140711142510
20140716102950
20140716140436
20140725101621
20140728190218
20140805114754
20140826104209
20140828111505
20140902102858
20140908082450
20140908192300
20140910111148
20140910153654
20140912113254
20140912114124
20140912145052
20140915141937
20140928131124
20140929073150
20140929073343
20140930201523
20141014131912
20141015164522
20141021105446
20141023114229
20141109131448
20141110084848
20141112165600
20141120140051
20141124055509
20141203082104
20141217101211
20141225073211
20150114141626
20150127085513
20150212161904
20150225131946
20150428070436
20150508124600
20150514121649
\.


--
-- Data for Name: sessions; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY sessions (id, session_id, data, created_at, updated_at) FROM stdin;
\.


--
-- Name: sessions_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('sessions_id_seq', 503, true);


--
-- Data for Name: settings; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY settings (id, name, value, description, category, settings_type, "default", created_at, updated_at) FROM stdin;
19	oauth_map_users	--- false\n...\n	Foreman will map users by username in request-header. If this is set to false, OAuth requests will have admin rights.	Setting::Auth	boolean	--- true\n...\n	2016-04-14 10:08:49.463313	2016-04-14 10:09:11.13139
5	email_subject_prefix	\N	Prefix to add to all outgoing email	Setting::General	string	--- ! '[foreman]'\n	2016-04-14 10:08:49.39516	2016-04-14 10:08:49.39516
6	send_welcome_email	\N	Send a welcome mail including username and URL to new users	Setting::General	boolean	--- false\n...\n	2016-04-14 10:08:49.399101	2016-04-14 10:08:49.399101
7	entries_per_page	\N	Number of records shown per page in Foreman	Setting::General	integer	--- 20\n...\n	2016-04-14 10:08:49.403102	2016-04-14 10:08:49.403102
8	authorize_login_delegation	\N	Authorize login delegation with REMOTE_USER environment variable	Setting::General	boolean	--- false\n...\n	2016-04-14 10:08:49.415299	2016-04-14 10:08:49.415299
9	authorize_login_delegation_api	\N	Authorize login delegation with REMOTE_USER environment variable for API calls too	Setting::General	boolean	--- false\n...\n	2016-04-14 10:08:49.418842	2016-04-14 10:08:49.418842
10	idle_timeout	\N	Log out idle users after a certain number of minutes	Setting::General	integer	--- 60\n...\n	2016-04-14 10:08:49.422679	2016-04-14 10:08:49.422679
11	max_trend	\N	Max days for Trends graphs	Setting::General	integer	--- 30\n...\n	2016-04-14 10:08:49.426644	2016-04-14 10:08:49.426644
12	use_gravatar	\N	Foreman will use gravatar to display user icons	Setting::General	boolean	--- true\n...\n	2016-04-14 10:08:49.430084	2016-04-14 10:08:49.430084
15	proxy_request_timeout	\N	Max timeout for REST client requests to smart-proxy	Setting::General	integer	--- 60\n...\n	2016-04-14 10:08:49.440678	2016-04-14 10:08:49.440678
16	oauth_active	--- true\n...\n	Foreman will use OAuth for API authorization	Setting::Auth	boolean	--- false\n...\n	2016-04-14 10:08:49.453314	2016-04-14 10:08:49.453314
20	restrict_registered_smart_proxies	\N	Only known Smart Proxies may access features that use Smart Proxy authentication	Setting::Auth	boolean	--- true\n...\n	2016-04-14 10:08:49.466579	2016-04-14 10:08:49.466579
21	require_ssl_smart_proxies	\N	Client SSL certificates are used to identify Smart Proxies (:require_ssl should also be enabled)	Setting::Auth	boolean	--- true\n...\n	2016-04-14 10:08:49.469849	2016-04-14 10:08:49.469849
22	trusted_puppetmaster_hosts	\N	Hosts that will be trusted in addition to Smart Proxies for access to fact/report importers and ENC output	Setting::Auth	array	--- []\n	2016-04-14 10:08:49.472949	2016-04-14 10:08:49.472949
23	ssl_client_dn_env	\N	Environment variable containing the subject DN from a client SSL certificate	Setting::Auth	string	--- SSL_CLIENT_S_DN\n...\n	2016-04-14 10:08:49.47613	2016-04-14 10:08:49.47613
24	ssl_client_verify_env	\N	Environment variable containing the verification status of a client SSL certificate	Setting::Auth	string	--- SSL_CLIENT_VERIFY\n...\n	2016-04-14 10:08:49.479347	2016-04-14 10:08:49.479347
25	login_delegation_logout_url	\N	Redirect your users to this url on logout (authorize_login_delegation should also be enabled)	Setting::Auth	\N	--- \n...\n	2016-04-14 10:08:49.482466	2016-04-14 10:08:49.482466
26	authorize_login_delegation_auth_source_user_autocreate	\N	Name of the external auth source where unknown externally authentication users (see authorize_login_delegation) should be created (keep unset to prevent the autocreation)	Setting::Auth	\N	--- \n...\n	2016-04-14 10:08:49.485577	2016-04-14 10:08:49.485577
27	root_pass	\N	Default encrypted root password on provisioned hosts	Setting::Provisioning	\N	--- \n...\n	2016-04-14 10:08:49.49817	2016-04-14 10:08:49.49817
29	safemode_render	\N	Enable safe mode config templates rendering (recommended)	Setting::Provisioning	boolean	--- true\n...\n	2016-04-14 10:08:49.505905	2016-04-14 10:08:49.505905
31	ssl_ca_file	\N	SSL CA file that Foreman will use to communicate with its proxies	Setting::Provisioning	string	--- /var/lib/puppet/ssl/certs/ca.pem\n...\n	2016-04-14 10:08:49.514231	2016-04-14 10:08:49.514231
33	manage_puppetca	\N	Foreman will automate certificate signing upon provision of new host	Setting::Provisioning	boolean	--- true\n...\n	2016-04-14 10:08:49.561332	2016-04-14 10:08:49.561332
34	ignore_puppet_facts_for_provisioning	\N	Stop updating IP address and MAC values from Puppet facts (affects all interfaces)	Setting::Provisioning	boolean	--- false\n...\n	2016-04-14 10:08:49.565035	2016-04-14 10:08:49.565035
35	query_local_nameservers	\N	Foreman will query the locally configured resolver instead of the SOA/NS authorities	Setting::Provisioning	boolean	--- false\n...\n	2016-04-14 10:08:49.568718	2016-04-14 10:08:49.568718
36	remote_addr	\N	If Foreman is running behind Passenger or a remote load balancer, the IP should be set here. This is a regular expression, so it can support several load balancers, i.e: (10.0.0.1|127.0.0.1)	Setting::Provisioning	string	--- 127.0.0.1\n...\n	2016-04-14 10:08:49.572929	2016-04-14 10:08:49.572929
37	token_duration	\N	Time in minutes installation tokens should be valid for, 0 to disable	Setting::Provisioning	integer	--- 360\n...\n	2016-04-14 10:08:49.576883	2016-04-14 10:08:49.576883
38	libvirt_default_console_address	\N	The IP address that should be used for the console listen address when provisioning new virtual machines via Libvirt	Setting::Provisioning	string	--- 0.0.0.0\n...\n	2016-04-14 10:08:49.581126	2016-04-14 10:08:49.581126
39	update_ip_from_built_request	\N	Foreman will update the host IP with the IP that made the built request	Setting::Provisioning	boolean	--- false\n...\n	2016-04-14 10:08:49.584727	2016-04-14 10:08:49.584727
13	db_pending_migration	--- false\n...\n	Should the `foreman-rake db:migrate` be executed on the next run of the installer modules?	Setting::General	boolean	--- true\n...\n	2016-04-14 10:08:49.433613	2016-04-14 10:08:55.200772
14	db_pending_seed	--- false\n...\n	Should the `foreman-rake db:seed` be executed on the next run of the installer modules?	Setting::General	boolean	--- true\n...\n	2016-04-14 10:08:49.437093	2016-04-14 10:08:55.2083
1	fix_db_cache	\N	Fix DB cache on next Foreman restart	Setting::General	boolean	--- false\n...\n	2016-04-14 10:08:39.018115	2016-04-14 10:09:10.909711
40	use_shortname_for_vms	\N	Foreman will use the short hostname instead of the FQDN for creating new virtual machines	Setting::Provisioning	boolean	--- false\n...\n	2016-04-14 10:08:49.588386	2016-04-14 10:08:49.588386
41	websockets_encrypt	--- true\n...\n	Should Foreman encrypt websockets (VNC console access). Choose on, off or auto.	Setting::Provisioning	string	--- auto\n...\n	2016-04-14 10:08:49.592531	2016-04-14 10:08:49.592531
44	puppet_interval	\N	Puppet interval in minutes	Setting::Puppet	integer	--- 30\n...\n	2016-04-14 10:08:49.613281	2016-04-14 10:08:49.613281
45	default_puppet_environment	\N	Foreman will default to this puppet environment if it cannot auto detect one	Setting::Puppet	string	--- production\n...\n	2016-04-14 10:08:49.617137	2016-04-14 10:08:49.617137
46	modulepath	\N	Foreman will set this as the default Puppet module path if it cannot auto detect one	Setting::Puppet	string	--- /etc/puppet/modules\n...\n	2016-04-14 10:08:49.621447	2016-04-14 10:08:49.621447
47	document_root	\N	Document root where puppetdoc files should be created	Setting::Puppet	string	--- /usr/share/foreman/public/puppet/rdoc\n...\n	2016-04-14 10:08:49.625396	2016-04-14 10:08:49.625396
48	puppetrun	\N	Enable puppetrun support	Setting::Puppet	boolean	--- false\n...\n	2016-04-14 10:08:49.62906	2016-04-14 10:08:49.62906
49	puppet_server	\N	Default Puppet server hostname	Setting::Puppet	string	--- puppet\n...\n	2016-04-14 10:08:49.632686	2016-04-14 10:08:49.632686
50	Default_variables_Lookup_Path	\N	Foreman will evaluate host smart variables in this order by default	Setting::Puppet	array	---\n- fqdn\n- hostgroup\n- os\n- domain\n	2016-04-14 10:08:49.636505	2016-04-14 10:08:49.636505
51	Enable_Smart_Variables_in_ENC	\N	Foreman smart variables will be exposed via the ENC yaml output	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.640217	2016-04-14 10:08:49.640217
52	Parametrized_Classes_in_ENC	\N	Foreman will use the new (2.6.5+) format for classes in the ENC yaml output	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.643802	2016-04-14 10:08:49.643802
53	interpolate_erb_in_parameters	\N	Foreman will parse ERB in parameters value in the ENC output	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.647442	2016-04-14 10:08:49.647442
54	enc_environment	\N	Foreman will explicitly set the puppet environment in the ENC yaml output. This will avoid conflicts between the environment in puppet.conf and the environment set in Foreman	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.651028	2016-04-14 10:08:49.651028
55	use_uuid_for_certificates	\N	Foreman will use random UUIDs for certificate signing instead of hostnames	Setting::Puppet	boolean	--- false\n...\n	2016-04-14 10:08:49.654688	2016-04-14 10:08:49.654688
56	update_environment_from_facts	\N	Foreman will update a host's environment from its facts	Setting::Puppet	boolean	--- false\n...\n	2016-04-14 10:08:49.658411	2016-04-14 10:08:49.658411
57	host_group_matchers_inheritance	\N	Foreman host group matchers will be inherited by children when evaluating smart class parameters	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.662315	2016-04-14 10:08:49.662315
58	create_new_host_when_facts_are_uploaded	\N	Foreman will create the host when new facts are received	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.665868	2016-04-14 10:08:49.665868
59	create_new_host_when_report_is_uploaded	\N	Foreman will create the host when a report is received	Setting::Puppet	boolean	--- true\n...\n	2016-04-14 10:08:49.66947	2016-04-14 10:08:49.66947
60	legacy_puppet_hostname	\N	Foreman will truncate hostname to 'puppet' if it starts with puppet	Setting::Puppet	boolean	--- false\n...\n	2016-04-14 10:08:49.673116	2016-04-14 10:08:49.673116
61	location_fact	\N	Hosts created after a puppet run will be placed in the location this fact dictates. The content of this fact should be the full label of the location.	Setting::Puppet	string	--- foreman_location\n...\n	2016-04-14 10:08:49.676648	2016-04-14 10:08:49.676648
62	organization_fact	\N	Hosts created after a puppet run will be placed in the organization this fact dictates. The content of this fact should be the full label of the organization.	Setting::Puppet	string	--- foreman_organization\n...\n	2016-04-14 10:08:49.680283	2016-04-14 10:08:49.680283
63	default_location	\N	Hosts created after a puppet run that did not send a location fact will be placed in this location	Setting::Puppet	string	--- ''\n	2016-04-14 10:08:49.683684	2016-04-14 10:08:49.683684
64	default_organization	\N	Hosts created after a puppet run that did not send a organization fact will be placed in this organization	Setting::Puppet	string	--- ''\n	2016-04-14 10:08:49.687093	2016-04-14 10:08:49.687093
2	administrator	--- root@foreman.ustack.com\n...\n	The default administrator email address	Setting::General	string	--- root@example.com\n...\n	2016-04-14 10:08:49.38084	2016-06-12 02:05:51.656042
3	foreman_url	--- http://foreman.ustack.com:3000\n...\n	URL where your Foreman instance is reachable (see also Provisioning > unattended_url)	Setting::General	string	--- http://server-101.example.com\n...\n	2016-04-14 10:08:49.386994	2016-06-12 02:05:51.66199
4	email_reply_address	--- Foreman-noreply@foreman.example.com\n...\n	Email reply address for emails that Foreman is sending	Setting::General	string	--- Foreman-noreply@example.com\n...\n	2016-04-14 10:08:49.390713	2016-06-12 02:05:51.665486
17	oauth_consumer_key	--- 2ybwSgTTvJ46WA9gyphhULFe8vQbJbsX\n...\n	OAuth consumer key	Setting::Auth	string	--- ''\n	2016-04-14 10:08:49.456782	2016-06-12 02:05:52.03184
18	oauth_consumer_secret	--- uVXXk5umQjubKfg8xngWZAZV3rnDQprn\n...\n	OAuth consumer secret	Setting::Auth	string	--- ''\n	2016-04-14 10:08:49.460028	2016-06-12 02:05:52.048676
28	unattended_url	--- http://foreman.ustack.com:3000\n...\n	URL hosts will retrieve templates from during build (normally http as many installers don't support https)	Setting::Provisioning	string	--- http://server-101.example.com\n...\n	2016-04-14 10:08:49.502157	2016-06-12 02:05:52.127246
30	ssl_certificate	\N	SSL Certificate path that Foreman would use to communicate with its proxies	Setting::Provisioning	string	--- /var/lib/puppet/ssl/certs/server-101.example.com.pem\n...\n	2016-04-14 10:08:49.509837	2016-06-12 02:05:52.140953
32	ssl_priv_key	\N	SSL Private Key file that Foreman will use to communicate with its proxies	Setting::Provisioning	string	--- /var/lib/puppet/ssl/private_keys/server-101.example.com.pem\n...\n	2016-04-14 10:08:49.557276	2016-06-12 02:05:52.154076
42	websockets_ssl_key	--- /var/lib/puppet/ssl/private_keys/server-101.example.com.pem\n...\n	Private key that Foreman will use to encrypt websockets	Setting::Provisioning	\N	--- \n...\n	2016-04-14 10:08:49.596236	2016-06-15 03:30:07.309504
43	websockets_ssl_cert	--- /var/lib/puppet/ssl/certs/server-101.example.com.pem\n...\n	Certificate that Foreman will use to encrypt websockets	Setting::Provisioning	\N	--- \n...\n	2016-04-14 10:08:49.599956	2016-06-15 03:30:07.319033
\.


--
-- Name: settings_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('settings_id_seq', 64, true);


--
-- Data for Name: smart_proxies; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY smart_proxies (id, name, url, created_at, updated_at) FROM stdin;
\.


--
-- Name: smart_proxies_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('smart_proxies_id_seq', 2, true);


--
-- Data for Name: sources; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY sources (id, value, digest) FROM stdin;
\.


--
-- Name: sources_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('sources_id_seq', 1, false);


--
-- Data for Name: subnet_domains; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY subnet_domains (id, domain_id, subnet_id, created_at, updated_at) FROM stdin;
\.


--
-- Name: subnet_domains_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('subnet_domains_id_seq', 2, true);


--
-- Data for Name: subnets; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY subnets (id, network, mask, priority, name, vlanid, created_at, updated_at, dhcp_id, tftp_id, gateway, dns_primary, dns_secondary, "from", "to", dns_id, boot_mode, ipam) FROM stdin;
\.


--
-- Name: subnets_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('subnets_id_seq', 2, true);


--
-- Data for Name: taxable_taxonomies; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY taxable_taxonomies (id, taxonomy_id, taxable_id, taxable_type, created_at, updated_at) FROM stdin;
\.


--
-- Name: taxable_taxonomies_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('taxable_taxonomies_id_seq', 1, false);


--
-- Data for Name: taxonomies; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY taxonomies (id, name, type, created_at, updated_at, ignore_types, ancestry, title, description) FROM stdin;
\.


--
-- Name: taxonomies_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('taxonomies_id_seq', 1, false);


--
-- Data for Name: template_combinations; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY template_combinations (id, config_template_id, hostgroup_id, environment_id, created_at, updated_at) FROM stdin;
\.


--
-- Name: template_combinations_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('template_combinations_id_seq', 1, false);


--
-- Data for Name: template_kinds; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY template_kinds (id, name, created_at, updated_at) FROM stdin;
1	PXELinux	2016-04-14 10:08:54.38831	2016-04-14 10:08:54.38831
2	PXEGrub	2016-04-14 10:08:54.391759	2016-04-14 10:08:54.391759
3	iPXE	2016-04-14 10:08:54.394529	2016-04-14 10:08:54.394529
4	provision	2016-04-14 10:08:54.397255	2016-04-14 10:08:54.397255
5	finish	2016-04-14 10:08:54.399973	2016-04-14 10:08:54.399973
6	script	2016-04-14 10:08:54.402805	2016-04-14 10:08:54.402805
7	user_data	2016-04-14 10:08:54.405516	2016-04-14 10:08:54.405516
8	ZTP	2016-04-14 10:08:54.408227	2016-04-14 10:08:54.408227
\.


--
-- Name: template_kinds_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('template_kinds_id_seq', 8, true);


--
-- Data for Name: tokens; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY tokens (id, value, expires, host_id) FROM stdin;
\.


--
-- Name: tokens_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('tokens_id_seq', 49, true);


--
-- Data for Name: trend_counters; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY trend_counters (id, trend_id, count, created_at, updated_at) FROM stdin;
\.


--
-- Name: trend_counters_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('trend_counters_id_seq', 1, false);


--
-- Data for Name: trends; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY trends (id, trendable_type, trendable_id, name, type, fact_value, fact_name, created_at, updated_at) FROM stdin;
\.


--
-- Name: trends_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('trends_id_seq', 1, false);


--
-- Data for Name: user_mail_notifications; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY user_mail_notifications (id, user_id, mail_notification_id, last_sent, "interval", created_at, updated_at) FROM stdin;
\.


--
-- Name: user_mail_notifications_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('user_mail_notifications_id_seq', 1, false);


--
-- Data for Name: user_roles; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY user_roles (id, owner_id, role_id, owner_type) FROM stdin;
1	1	8	User
2	2	8	User
3	3	8	User
4	4	8	User
\.


--
-- Name: user_roles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('user_roles_id_seq', 4, true);


--
-- Data for Name: usergroup_members; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY usergroup_members (id, member_id, member_type, usergroup_id) FROM stdin;
\.


--
-- Name: usergroup_members_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('usergroup_members_id_seq', 1, false);


--
-- Data for Name: usergroups; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY usergroups (id, name, created_at, updated_at, admin) FROM stdin;
\.


--
-- Name: usergroups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('usergroups_id_seq', 1, false);


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: foreman
--

COPY users (id, login, firstname, lastname, mail, admin, last_login_on, auth_source_id, created_at, updated_at, password_hash, password_salt, locale, avatar_hash, default_organization_id, default_location_id, lower_login, mail_enabled, timezone) FROM stdin;
1	foreman_admin	Anonymous	Admin	\N	t	\N	2	2016-04-14 10:08:54.228839	2016-04-14 10:08:54.228839	\N	\N	\N	\N	\N	\N	foreman_admin	t	\N
2	foreman_api_admin	API	Admin	\N	t	\N	2	2016-04-14 10:08:54.261471	2016-04-14 10:08:54.261471	\N	\N	\N	\N	\N	\N	foreman_api_admin	t	\N
4	api_post_user				t	2016-05-10 12:30:51.033746	1	2016-04-14 10:47:50.427068	2016-05-10 12:30:51.03455	4e084f457b6009c1ce5640137d689da1964c33bb	108150e9eb7478811d397b1e0b86910d5dbff51f	\N	\N	\N	\N	api_post_user	t	
3	admin	Admin	User	root@0.saic.ustack.in	t	2016-06-14 12:20:59.226644	1	2016-04-14 10:08:54.284759	2016-06-14 12:20:59.228899	1babcd1a794fbc9a8f55e640c6a068263b0e9dae	5aef78c94bd8fdfbbfe799250f3d6e754c143471	en	\N	\N	\N	admin	t	
\.


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: foreman
--

SELECT pg_catalog.setval('users_id_seq', 4, true);


--
-- Name: architectures_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY architectures
    ADD CONSTRAINT architectures_pkey PRIMARY KEY (id);


--
-- Name: audits_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY audits
    ADD CONSTRAINT audits_pkey PRIMARY KEY (id);


--
-- Name: auth_sources_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY auth_sources
    ADD CONSTRAINT auth_sources_pkey PRIMARY KEY (id);


--
-- Name: bookmarks_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY bookmarks
    ADD CONSTRAINT bookmarks_pkey PRIMARY KEY (id);


--
-- Name: cached_user_roles_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY cached_user_roles
    ADD CONSTRAINT cached_user_roles_pkey PRIMARY KEY (id);


--
-- Name: cached_usergroup_members_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY cached_usergroup_members
    ADD CONSTRAINT cached_usergroup_members_pkey PRIMARY KEY (id);


--
-- Name: compute_attributes_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY compute_attributes
    ADD CONSTRAINT compute_attributes_pkey PRIMARY KEY (id);


--
-- Name: compute_profiles_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY compute_profiles
    ADD CONSTRAINT compute_profiles_pkey PRIMARY KEY (id);


--
-- Name: compute_resources_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY compute_resources
    ADD CONSTRAINT compute_resources_pkey PRIMARY KEY (id);


--
-- Name: config_group_classes_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY config_group_classes
    ADD CONSTRAINT config_group_classes_pkey PRIMARY KEY (id);


--
-- Name: config_groups_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY config_groups
    ADD CONSTRAINT config_groups_pkey PRIMARY KEY (id);


--
-- Name: config_templates_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY config_templates
    ADD CONSTRAINT config_templates_pkey PRIMARY KEY (id);


--
-- Name: domains_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY domains
    ADD CONSTRAINT domains_pkey PRIMARY KEY (id);


--
-- Name: environment_classes_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY environment_classes
    ADD CONSTRAINT environment_classes_pkey PRIMARY KEY (id);


--
-- Name: environments_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY environments
    ADD CONSTRAINT environments_pkey PRIMARY KEY (id);


--
-- Name: external_usergroups_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY external_usergroups
    ADD CONSTRAINT external_usergroups_pkey PRIMARY KEY (id);


--
-- Name: fact_names_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY fact_names
    ADD CONSTRAINT fact_names_pkey PRIMARY KEY (id);


--
-- Name: fact_values_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY fact_values
    ADD CONSTRAINT fact_values_pkey PRIMARY KEY (id);


--
-- Name: features_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY features
    ADD CONSTRAINT features_pkey PRIMARY KEY (id);


--
-- Name: filterings_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY filterings
    ADD CONSTRAINT filterings_pkey PRIMARY KEY (id);


--
-- Name: filters_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY filters
    ADD CONSTRAINT filters_pkey PRIMARY KEY (id);


--
-- Name: host_classes_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY host_classes
    ADD CONSTRAINT host_classes_pkey PRIMARY KEY (id);


--
-- Name: host_config_groups_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY host_config_groups
    ADD CONSTRAINT host_config_groups_pkey PRIMARY KEY (id);


--
-- Name: hostgroup_classes_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY hostgroup_classes
    ADD CONSTRAINT hostgroup_classes_pkey PRIMARY KEY (id);


--
-- Name: hostgroups_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_pkey PRIMARY KEY (id);


--
-- Name: hosts_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_pkey PRIMARY KEY (id);


--
-- Name: images_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY images
    ADD CONSTRAINT images_pkey PRIMARY KEY (id);


--
-- Name: key_pairs_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY key_pairs
    ADD CONSTRAINT key_pairs_pkey PRIMARY KEY (id);


--
-- Name: logs_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY logs
    ADD CONSTRAINT logs_pkey PRIMARY KEY (id);


--
-- Name: lookup_keys_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY lookup_keys
    ADD CONSTRAINT lookup_keys_pkey PRIMARY KEY (id);


--
-- Name: lookup_values_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY lookup_values
    ADD CONSTRAINT lookup_values_pkey PRIMARY KEY (id);


--
-- Name: mail_notifications_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY mail_notifications
    ADD CONSTRAINT mail_notifications_pkey PRIMARY KEY (id);


--
-- Name: media_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY media
    ADD CONSTRAINT media_pkey PRIMARY KEY (id);


--
-- Name: messages_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY messages
    ADD CONSTRAINT messages_pkey PRIMARY KEY (id);


--
-- Name: models_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY models
    ADD CONSTRAINT models_pkey PRIMARY KEY (id);


--
-- Name: nics_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY nics
    ADD CONSTRAINT nics_pkey PRIMARY KEY (id);


--
-- Name: operatingsystems_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY operatingsystems
    ADD CONSTRAINT operatingsystems_pkey PRIMARY KEY (id);


--
-- Name: os_default_templates_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY os_default_templates
    ADD CONSTRAINT os_default_templates_pkey PRIMARY KEY (id);


--
-- Name: parameters_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY parameters
    ADD CONSTRAINT parameters_pkey PRIMARY KEY (id);


--
-- Name: permissions_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY permissions
    ADD CONSTRAINT permissions_pkey PRIMARY KEY (id);


--
-- Name: ptables_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY ptables
    ADD CONSTRAINT ptables_pkey PRIMARY KEY (id);


--
-- Name: puppetclasses_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY puppetclasses
    ADD CONSTRAINT puppetclasses_pkey PRIMARY KEY (id);


--
-- Name: realms_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY realms
    ADD CONSTRAINT realms_pkey PRIMARY KEY (id);


--
-- Name: reports_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY reports
    ADD CONSTRAINT reports_pkey PRIMARY KEY (id);


--
-- Name: roles_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);


--
-- Name: sessions_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY sessions
    ADD CONSTRAINT sessions_pkey PRIMARY KEY (id);


--
-- Name: settings_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY settings
    ADD CONSTRAINT settings_pkey PRIMARY KEY (id);


--
-- Name: smart_proxies_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY smart_proxies
    ADD CONSTRAINT smart_proxies_pkey PRIMARY KEY (id);


--
-- Name: sources_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY sources
    ADD CONSTRAINT sources_pkey PRIMARY KEY (id);


--
-- Name: subnet_domains_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY subnet_domains
    ADD CONSTRAINT subnet_domains_pkey PRIMARY KEY (id);


--
-- Name: subnets_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY subnets
    ADD CONSTRAINT subnets_pkey PRIMARY KEY (id);


--
-- Name: taxable_taxonomies_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY taxable_taxonomies
    ADD CONSTRAINT taxable_taxonomies_pkey PRIMARY KEY (id);


--
-- Name: taxonomies_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY taxonomies
    ADD CONSTRAINT taxonomies_pkey PRIMARY KEY (id);


--
-- Name: template_combinations_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY template_combinations
    ADD CONSTRAINT template_combinations_pkey PRIMARY KEY (id);


--
-- Name: template_kinds_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY template_kinds
    ADD CONSTRAINT template_kinds_pkey PRIMARY KEY (id);


--
-- Name: tokens_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY tokens
    ADD CONSTRAINT tokens_pkey PRIMARY KEY (id);


--
-- Name: trend_counters_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY trend_counters
    ADD CONSTRAINT trend_counters_pkey PRIMARY KEY (id);


--
-- Name: trends_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY trends
    ADD CONSTRAINT trends_pkey PRIMARY KEY (id);


--
-- Name: user_mail_notifications_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY user_mail_notifications
    ADD CONSTRAINT user_mail_notifications_pkey PRIMARY KEY (id);


--
-- Name: user_roles_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY user_roles
    ADD CONSTRAINT user_roles_pkey PRIMARY KEY (id);


--
-- Name: usergroup_members_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY usergroup_members
    ADD CONSTRAINT usergroup_members_pkey PRIMARY KEY (id);


--
-- Name: usergroups_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY usergroups
    ADD CONSTRAINT usergroups_pkey PRIMARY KEY (id);


--
-- Name: users_pkey; Type: CONSTRAINT; Schema: public; Owner: foreman; Tablespace: 
--

ALTER TABLE ONLY users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: associated_index; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX associated_index ON audits USING btree (associated_id, associated_type);


--
-- Name: auditable_index; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX auditable_index ON audits USING btree (auditable_id, auditable_type);


--
-- Name: auditable_parent_index; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX auditable_parent_index ON audits USING btree (associated_id, associated_type);


--
-- Name: host_arch_id_ix; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX host_arch_id_ix ON hosts USING btree (architecture_id);


--
-- Name: host_env_id_ix; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX host_env_id_ix ON hosts USING btree (environment_id);


--
-- Name: host_group_id_ix; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX host_group_id_ix ON hosts USING btree (hostgroup_id);


--
-- Name: host_medium_id_ix; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX host_medium_id_ix ON hosts USING btree (medium_id);


--
-- Name: host_os_id_ix; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX host_os_id_ix ON hosts USING btree (operatingsystem_id);


--
-- Name: index_audits_on_created_at; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_audits_on_created_at ON audits USING btree (created_at);


--
-- Name: index_audits_on_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_audits_on_id ON audits USING btree (id);


--
-- Name: index_bookmarks_on_controller; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_bookmarks_on_controller ON bookmarks USING btree (controller);


--
-- Name: index_bookmarks_on_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_bookmarks_on_name ON bookmarks USING btree (name);


--
-- Name: index_bookmarks_on_owner_id_and_owner_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_bookmarks_on_owner_id_and_owner_type ON bookmarks USING btree (owner_id, owner_type);


--
-- Name: index_by_host; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_by_host ON nics USING btree (host_id);


--
-- Name: index_by_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_by_type ON nics USING btree (type);


--
-- Name: index_by_type_and_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_by_type_and_id ON nics USING btree (type, id);


--
-- Name: index_cached_user_roles_on_role_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_cached_user_roles_on_role_id ON cached_user_roles USING btree (role_id);


--
-- Name: index_cached_user_roles_on_user_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_cached_user_roles_on_user_id ON cached_user_roles USING btree (user_id);


--
-- Name: index_cached_user_roles_on_user_role_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_cached_user_roles_on_user_role_id ON cached_user_roles USING btree (user_role_id);


--
-- Name: index_cached_usergroup_members_on_user_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_cached_usergroup_members_on_user_id ON cached_usergroup_members USING btree (user_id);


--
-- Name: index_cached_usergroup_members_on_usergroup_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_cached_usergroup_members_on_usergroup_id ON cached_usergroup_members USING btree (usergroup_id);


--
-- Name: index_compute_attributes_on_compute_profile_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_compute_attributes_on_compute_profile_id ON compute_attributes USING btree (compute_profile_id);


--
-- Name: index_compute_attributes_on_compute_resource_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_compute_attributes_on_compute_resource_id ON compute_attributes USING btree (compute_resource_id);


--
-- Name: index_environments_puppetclasses_on_environment_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_environments_puppetclasses_on_environment_id ON environment_classes USING btree (environment_id);


--
-- Name: index_environments_puppetclasses_on_puppetclass_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_environments_puppetclasses_on_puppetclass_id ON environment_classes USING btree (puppetclass_id);


--
-- Name: index_external_usergroups_on_usergroup_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_external_usergroups_on_usergroup_id ON external_usergroups USING btree (usergroup_id);


--
-- Name: index_fact_names_on_ancestry; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_fact_names_on_ancestry ON fact_names USING btree (ancestry);


--
-- Name: index_fact_names_on_name_and_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_fact_names_on_name_and_type ON fact_names USING btree (name, type);


--
-- Name: index_fact_values_on_fact_name_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_fact_values_on_fact_name_id ON fact_values USING btree (fact_name_id);


--
-- Name: index_fact_values_on_fact_name_id_and_host_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_fact_values_on_fact_name_id_and_host_id ON fact_values USING btree (fact_name_id, host_id);


--
-- Name: index_fact_values_on_host_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_fact_values_on_host_id ON fact_values USING btree (host_id);


--
-- Name: index_filterings_on_filter_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_filterings_on_filter_id ON filterings USING btree (filter_id);


--
-- Name: index_filterings_on_permission_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_filterings_on_permission_id ON filterings USING btree (permission_id);


--
-- Name: index_hostgroups_on_ancestry; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hostgroups_on_ancestry ON hostgroups USING btree (ancestry);


--
-- Name: index_hostgroups_on_compute_profile_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hostgroups_on_compute_profile_id ON hostgroups USING btree (compute_profile_id);


--
-- Name: index_hostgroups_puppetclasses_on_hostgroup_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hostgroups_puppetclasses_on_hostgroup_id ON hostgroup_classes USING btree (hostgroup_id);


--
-- Name: index_hostgroups_puppetclasses_on_puppetclass_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hostgroups_puppetclasses_on_puppetclass_id ON hostgroup_classes USING btree (puppetclass_id);


--
-- Name: index_hosts_on_certname; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_certname ON hosts USING btree (certname);


--
-- Name: index_hosts_on_compute_profile_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_compute_profile_id ON hosts USING btree (compute_profile_id);


--
-- Name: index_hosts_on_installed_at; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_installed_at ON hosts USING btree (installed_at);


--
-- Name: index_hosts_on_last_report; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_last_report ON hosts USING btree (last_report);


--
-- Name: index_hosts_on_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_name ON hosts USING btree (name);


--
-- Name: index_hosts_on_puppet_status; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_puppet_status ON hosts USING btree (puppet_status);


--
-- Name: index_hosts_on_source_file_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_source_file_id ON hosts USING btree (source_file_id);


--
-- Name: index_hosts_on_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_hosts_on_type ON hosts USING btree (type);


--
-- Name: index_logs_on_level_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_logs_on_level_id ON logs USING btree (level_id);


--
-- Name: index_logs_on_message_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_logs_on_message_id ON logs USING btree (message_id);


--
-- Name: index_logs_on_report_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_logs_on_report_id ON logs USING btree (report_id);


--
-- Name: index_logs_on_source_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_logs_on_source_id ON logs USING btree (source_id);


--
-- Name: index_lookup_keys_on_key; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_lookup_keys_on_key ON lookup_keys USING btree (key);


--
-- Name: index_lookup_keys_on_path; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_lookup_keys_on_path ON lookup_keys USING btree (path);


--
-- Name: index_lookup_keys_on_puppetclass_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_lookup_keys_on_puppetclass_id ON lookup_keys USING btree (puppetclass_id);


--
-- Name: index_lookup_values_on_match; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_lookup_values_on_match ON lookup_values USING btree (match);


--
-- Name: index_lookup_values_on_priority; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_lookup_values_on_priority ON lookup_values USING btree (match);


--
-- Name: index_messages_on_digest; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_messages_on_digest ON messages USING btree (digest);


--
-- Name: index_operatingsystems_on_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_operatingsystems_on_type ON operatingsystems USING btree (type);


--
-- Name: index_parameters_on_host_id_and_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_parameters_on_host_id_and_type ON parameters USING btree (reference_id, type);


--
-- Name: index_parameters_on_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_parameters_on_type ON parameters USING btree (type);


--
-- Name: index_parameters_on_type_and_reference_id_and_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_parameters_on_type_and_reference_id_and_name ON parameters USING btree (type, reference_id, name);


--
-- Name: index_permissions_on_name_and_resource_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_permissions_on_name_and_resource_type ON permissions USING btree (name, resource_type);


--
-- Name: index_puppetclasses_on_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_puppetclasses_on_name ON puppetclasses USING btree (name);


--
-- Name: index_realms_on_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_realms_on_name ON realms USING btree (name);


--
-- Name: index_reports_on_host_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_reports_on_host_id ON reports USING btree (host_id);


--
-- Name: index_reports_on_reported_at; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_reports_on_reported_at ON reports USING btree (reported_at);


--
-- Name: index_reports_on_reported_at_and_host_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_reports_on_reported_at_and_host_id ON reports USING btree (reported_at, host_id);


--
-- Name: index_reports_on_status; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_reports_on_status ON reports USING btree (status);


--
-- Name: index_sessions_on_session_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_sessions_on_session_id ON sessions USING btree (session_id);


--
-- Name: index_sessions_on_updated_at; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_sessions_on_updated_at ON sessions USING btree (updated_at);


--
-- Name: index_settings_on_category; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_settings_on_category ON settings USING btree (category);


--
-- Name: index_settings_on_name; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_settings_on_name ON settings USING btree (name);


--
-- Name: index_sources_on_digest; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_sources_on_digest ON sources USING btree (digest);


--
-- Name: index_taxable_taxonomies_on_taxable_id_and_taxable_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_taxable_taxonomies_on_taxable_id_and_taxable_type ON taxable_taxonomies USING btree (taxable_id, taxable_type);


--
-- Name: index_taxable_taxonomies_on_taxonomy_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_taxable_taxonomies_on_taxonomy_id ON taxable_taxonomies USING btree (taxonomy_id);


--
-- Name: index_taxonomies_on_ancestry; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_taxonomies_on_ancestry ON taxonomies USING btree (ancestry);


--
-- Name: index_tokens_on_host_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_tokens_on_host_id ON tokens USING btree (host_id);


--
-- Name: index_tokens_on_value; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_tokens_on_value ON tokens USING btree (value);


--
-- Name: index_trend_counters_on_trend_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_trend_counters_on_trend_id ON trend_counters USING btree (trend_id);


--
-- Name: index_trends_on_fact_value; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_trends_on_fact_value ON trends USING btree (fact_value);


--
-- Name: index_trends_on_trendable_type_and_trendable_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_trends_on_trendable_type_and_trendable_id ON trends USING btree (trendable_type, trendable_id);


--
-- Name: index_trends_on_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_trends_on_type ON trends USING btree (type);


--
-- Name: index_user_roles_on_owner_id; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_user_roles_on_owner_id ON user_roles USING btree (owner_id);


--
-- Name: index_user_roles_on_owner_id_and_owner_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_user_roles_on_owner_id_and_owner_type ON user_roles USING btree (owner_id, owner_type);


--
-- Name: index_user_roles_on_owner_type; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX index_user_roles_on_owner_type ON user_roles USING btree (owner_type);


--
-- Name: index_users_on_lower_login; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX index_users_on_lower_login ON users USING btree (lower_login);


--
-- Name: taxable_index; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX taxable_index ON taxable_taxonomies USING btree (taxable_id, taxable_type, taxonomy_id);


--
-- Name: unique_schema_migrations; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE UNIQUE INDEX unique_schema_migrations ON schema_migrations USING btree (version);


--
-- Name: user_index; Type: INDEX; Schema: public; Owner: foreman; Tablespace: 
--

CREATE INDEX user_index ON audits USING btree (user_id, user_type);


--
-- Name: architectures_operatingsystems_architecture_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY architectures_operatingsystems
    ADD CONSTRAINT architectures_operatingsystems_architecture_id_fk FOREIGN KEY (architecture_id) REFERENCES architectures(id);


--
-- Name: architectures_operatingsystems_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY architectures_operatingsystems
    ADD CONSTRAINT architectures_operatingsystems_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: compute_attributes_compute_profile_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY compute_attributes
    ADD CONSTRAINT compute_attributes_compute_profile_id_fk FOREIGN KEY (compute_profile_id) REFERENCES compute_profiles(id);


--
-- Name: compute_attributes_compute_resource_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY compute_attributes
    ADD CONSTRAINT compute_attributes_compute_resource_id_fk FOREIGN KEY (compute_resource_id) REFERENCES compute_resources(id);


--
-- Name: config_templates_operatingsystems_config_template_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_templates_operatingsystems
    ADD CONSTRAINT config_templates_operatingsystems_config_template_id_fk FOREIGN KEY (config_template_id) REFERENCES config_templates(id);


--
-- Name: config_templates_operatingsystems_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_templates_operatingsystems
    ADD CONSTRAINT config_templates_operatingsystems_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: config_templates_template_kind_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY config_templates
    ADD CONSTRAINT config_templates_template_kind_id_fk FOREIGN KEY (template_kind_id) REFERENCES template_kinds(id);


--
-- Name: domains_dns_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY domains
    ADD CONSTRAINT domains_dns_id_fk FOREIGN KEY (dns_id) REFERENCES smart_proxies(id);


--
-- Name: environment_classes_environment_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY environment_classes
    ADD CONSTRAINT environment_classes_environment_id_fk FOREIGN KEY (environment_id) REFERENCES environments(id);


--
-- Name: environment_classes_lookup_key_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY environment_classes
    ADD CONSTRAINT environment_classes_lookup_key_id_fk FOREIGN KEY (lookup_key_id) REFERENCES lookup_keys(id);


--
-- Name: environment_classes_puppetclass_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY environment_classes
    ADD CONSTRAINT environment_classes_puppetclass_id_fk FOREIGN KEY (puppetclass_id) REFERENCES puppetclasses(id);


--
-- Name: external_usergroups_auth_source_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY external_usergroups
    ADD CONSTRAINT external_usergroups_auth_source_id_fk FOREIGN KEY (auth_source_id) REFERENCES auth_sources(id);


--
-- Name: external_usergroups_usergroup_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY external_usergroups
    ADD CONSTRAINT external_usergroups_usergroup_id_fk FOREIGN KEY (usergroup_id) REFERENCES usergroups(id);


--
-- Name: fact_values_fact_name_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY fact_values
    ADD CONSTRAINT fact_values_fact_name_id_fk FOREIGN KEY (fact_name_id) REFERENCES fact_names(id);


--
-- Name: fact_values_host_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY fact_values
    ADD CONSTRAINT fact_values_host_id_fk FOREIGN KEY (host_id) REFERENCES hosts(id);


--
-- Name: features_smart_proxies_feature_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY features_smart_proxies
    ADD CONSTRAINT features_smart_proxies_feature_id_fk FOREIGN KEY (feature_id) REFERENCES features(id);


--
-- Name: features_smart_proxies_smart_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY features_smart_proxies
    ADD CONSTRAINT features_smart_proxies_smart_proxy_id_fk FOREIGN KEY (smart_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: filterings_filters_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY filterings
    ADD CONSTRAINT filterings_filters_id_fk FOREIGN KEY (filter_id) REFERENCES filters(id);


--
-- Name: filterings_permissions_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY filterings
    ADD CONSTRAINT filterings_permissions_id_fk FOREIGN KEY (permission_id) REFERENCES permissions(id);


--
-- Name: filters_roles_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY filters
    ADD CONSTRAINT filters_roles_id_fk FOREIGN KEY (role_id) REFERENCES roles(id);


--
-- Name: host_classes_host_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY host_classes
    ADD CONSTRAINT host_classes_host_id_fk FOREIGN KEY (host_id) REFERENCES hosts(id);


--
-- Name: host_classes_puppetclass_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY host_classes
    ADD CONSTRAINT host_classes_puppetclass_id_fk FOREIGN KEY (puppetclass_id) REFERENCES puppetclasses(id);


--
-- Name: hostgroup_classes_hostgroup_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroup_classes
    ADD CONSTRAINT hostgroup_classes_hostgroup_id_fk FOREIGN KEY (hostgroup_id) REFERENCES hostgroups(id);


--
-- Name: hostgroup_classes_puppetclass_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroup_classes
    ADD CONSTRAINT hostgroup_classes_puppetclass_id_fk FOREIGN KEY (puppetclass_id) REFERENCES puppetclasses(id);


--
-- Name: hostgroups_architecture_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_architecture_id_fk FOREIGN KEY (architecture_id) REFERENCES architectures(id);


--
-- Name: hostgroups_compute_profile_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_compute_profile_id_fk FOREIGN KEY (compute_profile_id) REFERENCES compute_profiles(id);


--
-- Name: hostgroups_domain_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_domain_id_fk FOREIGN KEY (domain_id) REFERENCES domains(id);


--
-- Name: hostgroups_environment_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_environment_id_fk FOREIGN KEY (environment_id) REFERENCES environments(id);


--
-- Name: hostgroups_medium_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_medium_id_fk FOREIGN KEY (medium_id) REFERENCES media(id);


--
-- Name: hostgroups_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: hostgroups_ptable_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_ptable_id_fk FOREIGN KEY (ptable_id) REFERENCES ptables(id);


--
-- Name: hostgroups_puppet_ca_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_puppet_ca_proxy_id_fk FOREIGN KEY (puppet_ca_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: hostgroups_puppet_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_puppet_proxy_id_fk FOREIGN KEY (puppet_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: hostgroups_realms_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_realms_id_fk FOREIGN KEY (realm_id) REFERENCES realms(id);


--
-- Name: hostgroups_subnet_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hostgroups
    ADD CONSTRAINT hostgroups_subnet_id_fk FOREIGN KEY (subnet_id) REFERENCES subnets(id);


--
-- Name: hosts_architecture_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_architecture_id_fk FOREIGN KEY (architecture_id) REFERENCES architectures(id);


--
-- Name: hosts_compute_profile_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_compute_profile_id_fk FOREIGN KEY (compute_profile_id) REFERENCES compute_profiles(id);


--
-- Name: hosts_compute_resource_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_compute_resource_id_fk FOREIGN KEY (compute_resource_id) REFERENCES compute_resources(id);


--
-- Name: hosts_environment_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_environment_id_fk FOREIGN KEY (environment_id) REFERENCES environments(id);


--
-- Name: hosts_hostgroup_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_hostgroup_id_fk FOREIGN KEY (hostgroup_id) REFERENCES hostgroups(id);


--
-- Name: hosts_image_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_image_id_fk FOREIGN KEY (image_id) REFERENCES images(id);


--
-- Name: hosts_location_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_location_id_fk FOREIGN KEY (location_id) REFERENCES taxonomies(id);


--
-- Name: hosts_medium_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_medium_id_fk FOREIGN KEY (medium_id) REFERENCES media(id);


--
-- Name: hosts_model_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_model_id_fk FOREIGN KEY (model_id) REFERENCES models(id);


--
-- Name: hosts_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: hosts_organization_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_organization_id_fk FOREIGN KEY (organization_id) REFERENCES taxonomies(id);


--
-- Name: hosts_ptable_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_ptable_id_fk FOREIGN KEY (ptable_id) REFERENCES ptables(id);


--
-- Name: hosts_puppet_ca_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_puppet_ca_proxy_id_fk FOREIGN KEY (puppet_ca_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: hosts_puppet_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_puppet_proxy_id_fk FOREIGN KEY (puppet_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: hosts_realms_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY hosts
    ADD CONSTRAINT hosts_realms_id_fk FOREIGN KEY (realm_id) REFERENCES realms(id);


--
-- Name: images_architecture_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY images
    ADD CONSTRAINT images_architecture_id_fk FOREIGN KEY (architecture_id) REFERENCES architectures(id);


--
-- Name: images_compute_resource_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY images
    ADD CONSTRAINT images_compute_resource_id_fk FOREIGN KEY (compute_resource_id) REFERENCES compute_resources(id);


--
-- Name: images_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY images
    ADD CONSTRAINT images_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: key_pairs_compute_resource_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY key_pairs
    ADD CONSTRAINT key_pairs_compute_resource_id_fk FOREIGN KEY (compute_resource_id) REFERENCES compute_resources(id);


--
-- Name: lookup_keys_puppetclass_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY lookup_keys
    ADD CONSTRAINT lookup_keys_puppetclass_id_fk FOREIGN KEY (puppetclass_id) REFERENCES puppetclasses(id);


--
-- Name: lookup_values_lookup_key_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY lookup_values
    ADD CONSTRAINT lookup_values_lookup_key_id_fk FOREIGN KEY (lookup_key_id) REFERENCES lookup_keys(id);


--
-- Name: media_operatingsystems_medium_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY media_operatingsystems
    ADD CONSTRAINT media_operatingsystems_medium_id_fk FOREIGN KEY (medium_id) REFERENCES media(id);


--
-- Name: media_operatingsystems_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY media_operatingsystems
    ADD CONSTRAINT media_operatingsystems_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: nics_domain_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY nics
    ADD CONSTRAINT nics_domain_id_fk FOREIGN KEY (domain_id) REFERENCES domains(id);


--
-- Name: nics_host_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY nics
    ADD CONSTRAINT nics_host_id_fk FOREIGN KEY (host_id) REFERENCES hosts(id);


--
-- Name: nics_subnet_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY nics
    ADD CONSTRAINT nics_subnet_id_fk FOREIGN KEY (subnet_id) REFERENCES subnets(id);


--
-- Name: operatingsystems_ptables_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY operatingsystems_ptables
    ADD CONSTRAINT operatingsystems_ptables_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: operatingsystems_ptables_ptable_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY operatingsystems_ptables
    ADD CONSTRAINT operatingsystems_ptables_ptable_id_fk FOREIGN KEY (ptable_id) REFERENCES ptables(id);


--
-- Name: operatingsystems_puppetclasses_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY operatingsystems_puppetclasses
    ADD CONSTRAINT operatingsystems_puppetclasses_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: operatingsystems_puppetclasses_puppetclass_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY operatingsystems_puppetclasses
    ADD CONSTRAINT operatingsystems_puppetclasses_puppetclass_id_fk FOREIGN KEY (puppetclass_id) REFERENCES puppetclasses(id);


--
-- Name: os_default_templates_config_template_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY os_default_templates
    ADD CONSTRAINT os_default_templates_config_template_id_fk FOREIGN KEY (config_template_id) REFERENCES config_templates(id);


--
-- Name: os_default_templates_operatingsystem_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY os_default_templates
    ADD CONSTRAINT os_default_templates_operatingsystem_id_fk FOREIGN KEY (operatingsystem_id) REFERENCES operatingsystems(id);


--
-- Name: os_default_templates_template_kind_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY os_default_templates
    ADD CONSTRAINT os_default_templates_template_kind_id_fk FOREIGN KEY (template_kind_id) REFERENCES template_kinds(id);


--
-- Name: realms_realm_proxy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY realms
    ADD CONSTRAINT realms_realm_proxy_id_fk FOREIGN KEY (realm_proxy_id) REFERENCES smart_proxies(id);


--
-- Name: reports_host_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY reports
    ADD CONSTRAINT reports_host_id_fk FOREIGN KEY (host_id) REFERENCES hosts(id);


--
-- Name: subnet_domains_domain_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnet_domains
    ADD CONSTRAINT subnet_domains_domain_id_fk FOREIGN KEY (domain_id) REFERENCES domains(id);


--
-- Name: subnet_domains_subnet_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnet_domains
    ADD CONSTRAINT subnet_domains_subnet_id_fk FOREIGN KEY (subnet_id) REFERENCES subnets(id);


--
-- Name: subnets_dhcp_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnets
    ADD CONSTRAINT subnets_dhcp_id_fk FOREIGN KEY (dhcp_id) REFERENCES smart_proxies(id);


--
-- Name: subnets_dns_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnets
    ADD CONSTRAINT subnets_dns_id_fk FOREIGN KEY (dns_id) REFERENCES smart_proxies(id);


--
-- Name: subnets_tftp_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY subnets
    ADD CONSTRAINT subnets_tftp_id_fk FOREIGN KEY (tftp_id) REFERENCES smart_proxies(id);


--
-- Name: taxable_taxonomies_taxonomy_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY taxable_taxonomies
    ADD CONSTRAINT taxable_taxonomies_taxonomy_id_fk FOREIGN KEY (taxonomy_id) REFERENCES taxonomies(id);


--
-- Name: template_combinations_config_template_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY template_combinations
    ADD CONSTRAINT template_combinations_config_template_id_fk FOREIGN KEY (config_template_id) REFERENCES config_templates(id);


--
-- Name: template_combinations_environment_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY template_combinations
    ADD CONSTRAINT template_combinations_environment_id_fk FOREIGN KEY (environment_id) REFERENCES environments(id);


--
-- Name: template_combinations_hostgroup_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY template_combinations
    ADD CONSTRAINT template_combinations_hostgroup_id_fk FOREIGN KEY (hostgroup_id) REFERENCES hostgroups(id);


--
-- Name: tokens_host_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY tokens
    ADD CONSTRAINT tokens_host_id_fk FOREIGN KEY (host_id) REFERENCES hosts(id);


--
-- Name: trend_counters_trend_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY trend_counters
    ADD CONSTRAINT trend_counters_trend_id_fk FOREIGN KEY (trend_id) REFERENCES trends(id);


--
-- Name: user_mail_notifications_mail_notification_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY user_mail_notifications
    ADD CONSTRAINT user_mail_notifications_mail_notification_id_fk FOREIGN KEY (mail_notification_id) REFERENCES mail_notifications(id);


--
-- Name: user_mail_notifications_user_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY user_mail_notifications
    ADD CONSTRAINT user_mail_notifications_user_id_fk FOREIGN KEY (user_id) REFERENCES users(id);


--
-- Name: user_roles_role_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY user_roles
    ADD CONSTRAINT user_roles_role_id_fk FOREIGN KEY (role_id) REFERENCES roles(id);


--
-- Name: usergroup_members_usergroup_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY usergroup_members
    ADD CONSTRAINT usergroup_members_usergroup_id_fk FOREIGN KEY (usergroup_id) REFERENCES usergroups(id);


--
-- Name: users_auth_source_id_fk; Type: FK CONSTRAINT; Schema: public; Owner: foreman
--

ALTER TABLE ONLY users
    ADD CONSTRAINT users_auth_source_id_fk FOREIGN KEY (auth_source_id) REFERENCES auth_sources(id);


--
-- Name: public; Type: ACL; Schema: -; Owner: postgres
--

REVOKE ALL ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON SCHEMA public FROM postgres;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO PUBLIC;


--
-- PostgreSQL database dump complete
--

